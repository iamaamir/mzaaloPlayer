(function(){var innerGlobal=typeof window!="undefined"?window:global;var exportTo={};(function(window,global,module){var m,ca="function"==typeof Object.defineProperties?Object.defineProperty:function(b,c,d){b!=Array.prototype&&b!=Object.prototype&&(b[c]=d.value)},da="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;function ea(){ea=function(){};da.Symbol||(da.Symbol=fa)}var fa=function(){var b=0;return function(c){return"jscomp_symbol_"+(c||"")+b++}}();
function ha(){ea();var b=da.Symbol.iterator;b||(b=da.Symbol.iterator=da.Symbol("iterator"));"function"!=typeof Array.prototype[b]&&ca(Array.prototype,b,{configurable:!0,writable:!0,value:function(){return ja(this)}});ha=function(){}}function ja(b){var c=0;return ka(function(){return c<b.length?{done:!1,value:b[c++]}:{done:!0}})}function ka(b){ha();b={next:b};b[da.Symbol.iterator]=function(){return this};return b}function t(b){ha();var c=b[Symbol.iterator];return c?c.call(b):ja(b)}
function la(b,c){if(c){for(var d=da,e=b.split("."),f=0;f<e.length-1;f++){var g=e[f];g in d||(d[g]={});d=d[g]}e=e[e.length-1];f=d[e];g=c(f);g!=f&&null!=g&&ca(d,e,{configurable:!0,writable:!0,value:g})}}
la("Promise",function(b){function c(b){this.b=0;this.g=void 0;this.a=[];var c=this.c();try{b(c.resolve,c.reject)}catch(l){c.reject(l)}}function d(){this.a=null}function e(b){return b instanceof c?b:new c(function(c){c(b)})}if(b)return b;d.prototype.b=function(b){null==this.a&&(this.a=[],this.f());this.a.push(b)};d.prototype.f=function(){var b=this;this.c(function(){b.h()})};var f=da.setTimeout;d.prototype.c=function(b){f(b,0)};d.prototype.h=function(){for(;this.a&&this.a.length;){var b=this.a;this.a=
[];for(var c=0;c<b.length;++c){var d=b[c];b[c]=null;try{d()}catch(n){this.g(n)}}}this.a=null};d.prototype.g=function(b){this.c(function(){throw b;})};c.prototype.c=function(){function b(b){return function(e){d||(d=!0,b.call(c,e))}}var c=this,d=!1;return{resolve:b(this.v),reject:b(this.f)}};c.prototype.v=function(b){if(b===this)this.f(new TypeError("A Promise cannot resolve to itself"));else if(b instanceof c)this.A(b);else{a:switch(typeof b){case "object":var d=null!=b;break a;case "function":d=!0;
break a;default:d=!1}d?this.s(b):this.h(b)}};c.prototype.s=function(b){var c=void 0;try{c=b.then}catch(l){this.f(l);return}"function"==typeof c?this.F(c,b):this.h(b)};c.prototype.f=function(b){this.i(2,b)};c.prototype.h=function(b){this.i(1,b)};c.prototype.i=function(b,c){if(0!=this.b)throw Error("Cannot settle("+b+", "+c+"): Promise already settled in state"+this.b);this.b=b;this.g=c;this.m()};c.prototype.m=function(){if(null!=this.a){for(var b=0;b<this.a.length;++b)g.b(this.a[b]);this.a=null}};
var g=new d;c.prototype.A=function(b){var c=this.c();b.gc(c.resolve,c.reject)};c.prototype.F=function(b,c){var d=this.c();try{b.call(c,d.resolve,d.reject)}catch(n){d.reject(n)}};c.prototype.then=function(b,d){function e(b,c){return"function"==typeof b?function(c){try{f(b(c))}catch(z){g(z)}}:c}var f,g,h=new c(function(b,c){f=b;g=c});this.gc(e(b,f),e(d,g));return h};c.prototype["catch"]=function(b){return this.then(void 0,b)};c.prototype.gc=function(b,c){function d(){switch(e.b){case 1:b(e.g);break;
case 2:c(e.g);break;default:throw Error("Unexpected state: "+e.b);}}var e=this;null==this.a?g.b(d):this.a.push(d)};c.resolve=e;c.reject=function(b){return new c(function(c,d){d(b)})};c.race=function(b){return new c(function(c,d){for(var f=t(b),g=f.next();!g.done;g=f.next())e(g.value).gc(c,d)})};c.all=function(b){var d=t(b),f=d.next();return f.done?e([]):new c(function(b,c){function g(c){return function(d){h[c]=d;k--;0==k&&b(h)}}var h=[],k=0;do h.push(void 0),k++,e(f.value).gc(g(h.length-1),c),f=d.next();
while(!f.done)})};return c});la("Promise.prototype.finally",function(b){return b?b:function(b){return this.then(function(c){return Promise.resolve(b()).then(function(){return c})},function(c){return Promise.resolve(b()).then(function(){throw c;})})}});function ma(b){function c(c){return b.next(c)}function d(c){return b["throw"](c)}return new Promise(function(e,f){function g(b){b.done?e(b.value):Promise.resolve(b.value).then(c,d).then(g,f)}g(b.next())})}function u(b){return ma(b())}
var na="function"==typeof Object.create?Object.create:function(b){function c(){}c.prototype=b;return new c},oa;if("function"==typeof Object.setPrototypeOf)oa=Object.setPrototypeOf;else{var pa;a:{var ra={ue:!0},sa={};try{sa.__proto__=ra;pa=sa.ue;break a}catch(b){}pa=!1}oa=pa?function(b,c){b.__proto__=c;if(b.__proto__!==c)throw new TypeError(b+" is not extensible");return b}:null}var ta=oa;
function ua(b,c){b.prototype=na(c.prototype);b.prototype.constructor=b;if(ta)ta(b,c);else for(var d in c)if("prototype"!=d)if(Object.defineProperties){var e=Object.getOwnPropertyDescriptor(c,d);e&&Object.defineProperty(b,d,e)}else b[d]=c[d];b.Zf=c.prototype}function va(){this.g=!1;this.c=null;this.o=void 0;this.j=1;this.b=this.f=0;this.i=this.a=null}function za(b){if(b.g)throw new TypeError("Generator is already running");b.g=!0}va.prototype.h=function(b){this.o=b};
function Ca(b,c){b.a={Md:c,Zd:!0};b.j=b.f||b.b}va.prototype["return"]=function(b){this.a={"return":b};this.j=this.b};function v(b,c,d){b.j=d;return{value:c}}va.prototype.B=function(b){this.j=b};function w(b){b.j=0}function Da(b,c,d){b.f=c;void 0!=d&&(b.b=d)}function Ea(b,c){b.f=0;b.b=c||0}function Fa(b,c){b.j=c;b.f=0}function Ga(b){b.f=0;var c=b.a.Md;b.a=null;return c}function Ha(b){b.i=[b.a];b.f=0;b.b=0}
function Ia(b,c){var d=b.i.splice(0)[0];(d=b.a=b.a||d)?d.Zd?b.j=b.f||b.b:void 0!=d.B&&b.b<d.B?(b.j=d.B,b.a=null):b.j=b.b:b.j=c}function La(b){this.a=new va;this.b=b}function Ma(b,c){za(b.a);var d=b.a.c;if(d)return Na(b,"return"in d?d["return"]:function(b){return{value:b,done:!0}},c,b.a["return"]);b.a["return"](c);return Oa(b)}
function Na(b,c,d,e){try{var f=c.call(b.a.c,d);if(!(f instanceof Object))throw new TypeError("Iterator result "+f+" is not an object");if(!f.done)return b.a.g=!1,f;var g=f.value}catch(h){return b.a.c=null,Ca(b.a,h),Oa(b)}b.a.c=null;e.call(b.a,g);return Oa(b)}
function Oa(b){for(;b.a.j;)try{var c=b.b(b.a);if(c)return b.a.g=!1,{value:c.value,done:!1}}catch(d){b.a.o=void 0,Ca(b.a,d)}b.a.g=!1;if(b.a.a){c=b.a.a;b.a.a=null;if(c.Zd)throw c.Md;return{value:c["return"],done:!0}}return{value:void 0,done:!0}}
function Pa(b){this.next=function(c){za(b.a);b.a.c?c=Na(b,b.a.c.next,c,b.a.h):(b.a.h(c),c=Oa(b));return c};this["throw"]=function(c){za(b.a);b.a.c?c=Na(b,b.a.c["throw"],c,b.a.h):(Ca(b.a,c),c=Oa(b));return c};this["return"]=function(c){return Ma(b,c)};ha();this[Symbol.iterator]=function(){return this}}function y(b,c){Pa.prototype=b.prototype;return new Pa(new La(c))}function Qa(b){for(var c,d=[];!(c=b.next()).done;)d.push(c.value);return d}
function Ra(b,c){return Object.prototype.hasOwnProperty.call(b,c)}
la("WeakMap",function(b){function c(b){this.a=(g+=Math.random()+1).toString();if(b){ea();ha();b=t(b);for(var c;!(c=b.next()).done;)c=c.value,this.set(c[0],c[1])}}function d(b){Ra(b,f)||ca(b,f,{value:{}})}function e(b){var c=Object[b];c&&(Object[b]=function(b){d(b);return c(b)})}if(function(){if(!b||!Object.seal)return!1;try{var c=Object.seal({}),d=Object.seal({}),e=new b([[c,2],[d,3]]);if(2!=e.get(c)||3!=e.get(d))return!1;e["delete"](c);e.set(d,4);return!e.has(c)&&4==e.get(d)}catch(n){return!1}}())return b;
var f="$jscomp_hidden_"+Math.random();e("freeze");e("preventExtensions");e("seal");var g=0;c.prototype.set=function(b,c){d(b);if(!Ra(b,f))throw Error("WeakMap key fail: "+b);b[f][this.a]=c;return this};c.prototype.get=function(b){return Ra(b,f)?b[f][this.a]:void 0};c.prototype.has=function(b){return Ra(b,f)&&Ra(b[f],this.a)};c.prototype["delete"]=function(b){return Ra(b,f)&&Ra(b[f],this.a)?delete b[f][this.a]:!1};return c});
la("Map",function(b){function c(){var b={};return b.Ha=b.next=b.head=b}function d(b,c){var d=b.a;return ka(function(){if(d){for(;d.head!=b.a;)d=d.Ha;for(;d.next!=d.head;)return d=d.next,{done:!1,value:c(d)};d=null}return{done:!0,value:void 0}})}function e(b,c){var d=c&&typeof c;"object"==d||"function"==d?g.has(c)?d=g.get(c):(d=""+ ++h,g.set(c,d)):d="p_"+c;var e=b.b[d];if(e&&Ra(b.b,d))for(var f=0;f<e.length;f++){var k=e[f];if(c!==c&&k.key!==k.key||c===k.key)return{id:d,list:e,index:f,$:k}}return{id:d,
list:e,index:-1,$:void 0}}function f(b){this.b={};this.a=c();this.size=0;if(b){b=t(b);for(var d;!(d=b.next()).done;)d=d.value,this.set(d[0],d[1])}}if(function(){if(!b||"function"!=typeof b||!b.prototype.entries||"function"!=typeof Object.seal)return!1;try{var c=Object.seal({x:4}),d=new b(t([[c,"s"]]));if("s"!=d.get(c)||1!=d.size||d.get({x:4})||d.set({x:4},"t")!=d||2!=d.size)return!1;var e=d.entries(),f=e.next();if(f.done||f.value[0]!=c||"s"!=f.value[1])return!1;f=e.next();return f.done||4!=f.value[0].x||
"t"!=f.value[1]||!e.next().done?!1:!0}catch(q){return!1}}())return b;ea();ha();var g=new WeakMap;f.prototype.set=function(b,c){var d=e(this,b);d.list||(d.list=this.b[d.id]=[]);d.$?d.$.value=c:(d.$={next:this.a,Ha:this.a.Ha,head:this.a,key:b,value:c},d.list.push(d.$),this.a.Ha.next=d.$,this.a.Ha=d.$,this.size++);return this};f.prototype["delete"]=function(b){b=e(this,b);return b.$&&b.list?(b.list.splice(b.index,1),b.list.length||delete this.b[b.id],b.$.Ha.next=b.$.next,b.$.next.Ha=b.$.Ha,b.$.head=
null,this.size--,!0):!1};f.prototype.clear=function(){this.b={};this.a=this.a.Ha=c();this.size=0};f.prototype.has=function(b){return!!e(this,b).$};f.prototype.get=function(b){return(b=e(this,b).$)&&b.value};f.prototype.entries=function(){return d(this,function(b){return[b.key,b.value]})};f.prototype.keys=function(){return d(this,function(b){return b.key})};f.prototype.values=function(){return d(this,function(b){return b.value})};f.prototype.forEach=function(b,c){for(var d=this.entries(),e;!(e=d.next()).done;)e=
e.value,b.call(c,e[1],e[0],this)};f.prototype[Symbol.iterator]=f.prototype.entries;var h=0;return f});
la("Set",function(b){function c(b){this.a=new Map;if(b){b=t(b);for(var c;!(c=b.next()).done;)this.add(c.value)}this.size=this.a.size}if(function(){if(!b||"function"!=typeof b||!b.prototype.entries||"function"!=typeof Object.seal)return!1;try{var c=Object.seal({x:4}),e=new b(t([c]));if(!e.has(c)||1!=e.size||e.add(c)!=e||1!=e.size||e.add({x:4})!=e||2!=e.size)return!1;var f=e.entries(),g=f.next();if(g.done||g.value[0]!=c||g.value[1]!=c)return!1;g=f.next();return g.done||g.value[0]==c||4!=g.value[0].x||
g.value[1]!=g.value[0]?!1:f.next().done}catch(h){return!1}}())return b;ea();ha();c.prototype.add=function(b){this.a.set(b,b);this.size=this.a.size;return this};c.prototype["delete"]=function(b){b=this.a["delete"](b);this.size=this.a.size;return b};c.prototype.clear=function(){this.a.clear();this.size=0};c.prototype.has=function(b){return this.a.has(b)};c.prototype.entries=function(){return this.a.entries()};c.prototype.values=function(){return this.a.values()};c.prototype.keys=c.prototype.values;
c.prototype[Symbol.iterator]=c.prototype.values;c.prototype.forEach=function(b,c){var d=this;this.a.forEach(function(e){return b.call(c,e,e,d)})};return c});function Sa(b,c,d){b instanceof String&&(b=String(b));for(var e=b.length,f=0;f<e;f++){var g=b[f];if(c.call(d,g,f,b))return{Vd:f,se:g}}return{Vd:-1,se:void 0}}la("Array.prototype.findIndex",function(b){return b?b:function(b,d){return Sa(this,b,d).Vd}});
function Wa(b,c){ha();b instanceof String&&(b+="");var d=0,e={next:function(){if(d<b.length){var f=d++;return{value:c(f,b[f]),done:!1}}e.next=function(){return{done:!0,value:void 0}};return e.next()}};e[Symbol.iterator]=function(){return e};return e}la("Array.prototype.keys",function(b){return b?b:function(){return Wa(this,function(b){return b})}});la("Object.is",function(b){return b?b:function(b,d){return b===d?0!==b||1/b===1/d:b!==b&&d!==d}});
la("Array.prototype.includes",function(b){return b?b:function(b,d){var c=this;c instanceof String&&(c=String(c));var f=c.length,g=d||0;for(0>g&&(g=Math.max(g+f,0));g<f;g++){var h=c[g];if(h===b||Object.is(h,b))return!0}return!1}});function Xa(b,c,d){if(null==b)throw new TypeError("The 'this' value for String.prototype."+d+" must not be null or undefined");if(c instanceof RegExp)throw new TypeError("First argument to String.prototype."+d+" must not be a regular expression");return b+""}
la("String.prototype.includes",function(b){return b?b:function(b,d){return-1!==Xa(this,b,"includes").indexOf(b,d||0)}});la("Array.from",function(b){return b?b:function(b,d,e){ha();d=null!=d?d:function(b){return b};var c=[],g=b[Symbol.iterator];if("function"==typeof g)for(b=g.call(b);!(g=b.next()).done;)c.push(d.call(e,g.value));else{g=b.length;for(var h=0;h<g;h++)c.push(d.call(e,b[h]))}return c}});
la("String.prototype.startsWith",function(b){return b?b:function(b,d){for(var c=Xa(this,b,"startsWith"),f=c.length,g=b.length,h=Math.max(0,Math.min(d|0,c.length)),k=0;k<g&&h<f;)if(c[h++]!=b[k++])return!1;return k>=g}});la("Array.prototype.find",function(b){return b?b:function(b,d){return Sa(this,b,d).se}});var Ya="function"==typeof Object.assign?Object.assign:function(b,c){for(var d=1;d<arguments.length;d++){var e=arguments[d];if(e)for(var f in e)Ra(e,f)&&(b[f]=e[f])}return b};
la("Object.assign",function(b){return b||Ya});var Za=this;Za.a=!0;function A(b,c){var d=b.split("."),e=Za;d[0]in e||!e.execScript||e.execScript("var "+d[0]);for(var f;d.length&&(f=d.shift());)d.length||void 0===c?e[f]?e=e[f]:e=e[f]={}:e[f]=c}function $a(b,c){function d(){}d.prototype=c.prototype;b.Zf=c.prototype;b.prototype=new d;b.prototype.constructor=b;b.lg=function(b,d,g){return c.prototype[d].apply(b,Array.prototype.slice.call(arguments,2))}};/*

 Copyright 2016 Google Inc.

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
*/
function ab(b){this.c=Math.exp(Math.log(.5)/b);this.b=this.a=0}function bb(b,c,d){var e=Math.pow(b.c,c);d=d*(1-e)+e*b.a;isNaN(d)||(b.a=d,b.b+=c)}function cb(b){return b.a/(1-Math.pow(b.c,b.b))};function db(){this.b=new ab(2);this.c=new ab(5);this.a=0}db.prototype.getBandwidthEstimate=function(b){return 128E3>this.a?b:Math.min(cb(this.b),cb(this.c))};var B={jb:0,fc:function(){},da:function(){},error:function(){},l:function(){},info:function(){},debug:function(){},C:function(){},I:function(){}};window.console&&window.console.log.bind&&(B.da=console.warn.bind(console),B.fc=console.error.bind(console),1<=B.jb&&(B.error=console.error.bind(console)),2<=B.jb&&(B.l=console.warn.bind(console)),3<=B.jb&&(B.info=console.info.bind(console)),4<=B.jb&&(B.debug=console.log.bind(console)),5<=B.jb&&(B.C=console.debug.bind(console)),6<=B.jb&&(B.I=console.debug.bind(console)));var jb=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;function kb(b){var c;b instanceof kb?(lb(this,b.wa),this.gb=b.gb,this.va=b.va,mb(this,b.Gb),this.ka=b.ka,nb(this,b.a.clone()),this.Wa=b.Wa):b&&(c=String(b).match(jb))?(lb(this,c[1]||"",!0),this.gb=ob(c[2]||""),this.va=ob(c[3]||"",!0),mb(this,c[4]),this.ka=ob(c[5]||"",!0),nb(this,c[6]||"",!0),this.Wa=ob(c[7]||"")):this.a=new pb(null)}m=kb.prototype;m.wa="";m.gb="";m.va="";m.Gb=null;m.ka="";m.Wa="";
m.toString=function(){var b=[],c=this.wa;c&&b.push(qb(c,rb,!0),":");if(c=this.va){b.push("//");var d=this.gb;d&&b.push(qb(d,rb,!0),"@");b.push(encodeURIComponent(c).replace(/%25([0-9a-fA-F]{2})/g,"%$1"));c=this.Gb;null!=c&&b.push(":",String(c))}if(c=this.ka)this.va&&"/"!=c.charAt(0)&&b.push("/"),b.push(qb(c,"/"==c.charAt(0)?sb:ub,!0));(c=this.a.toString())&&b.push("?",c);(c=this.Wa)&&b.push("#",qb(c,vb));return b.join("")};
m.resolve=function(b){var c=this.clone();"data"===c.wa&&(c=new kb);var d=!!b.wa;d?lb(c,b.wa):d=!!b.gb;d?c.gb=b.gb:d=!!b.va;d?c.va=b.va:d=null!=b.Gb;var e=b.ka;if(d)mb(c,b.Gb);else if(d=!!b.ka){if("/"!=e.charAt(0))if(this.va&&!this.ka)e="/"+e;else{var f=c.ka.lastIndexOf("/");-1!=f&&(e=c.ka.substr(0,f+1)+e)}if(".."==e||"."==e)e="";else if(-1!=e.indexOf("./")||-1!=e.indexOf("/.")){f=0==e.lastIndexOf("/",0);e=e.split("/");for(var g=[],h=0;h<e.length;){var k=e[h++];"."==k?f&&h==e.length&&g.push(""):".."==
k?((1<g.length||1==g.length&&""!=g[0])&&g.pop(),f&&h==e.length&&g.push("")):(g.push(k),f=!0)}e=g.join("/")}}d?c.ka=e:d=""!==b.a.toString();d?nb(c,b.a.clone()):d=!!b.Wa;d&&(c.Wa=b.Wa);return c};m.clone=function(){return new kb(this)};function lb(b,c,d){b.wa=d?ob(c,!0):c;b.wa&&(b.wa=b.wa.replace(/:$/,""))}function mb(b,c){if(c){c=Number(c);if(isNaN(c)||0>c)throw Error("Bad port number "+c);b.Gb=c}else b.Gb=null}function nb(b,c,d){c instanceof pb?b.a=c:(d||(c=qb(c,wb)),b.a=new pb(c))}
function ob(b,c){return b?c?decodeURI(b):decodeURIComponent(b):""}function qb(b,c,d){return"string"==typeof b?(b=encodeURI(b).replace(c,xb),d&&(b=b.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),b):null}function xb(b){b=b.charCodeAt(0);return"%"+(b>>4&15).toString(16)+(b&15).toString(16)}var rb=/[#\/\?@]/g,ub=/[#\?:]/g,sb=/[#\?]/g,wb=/[#\?@]/g,vb=/#/g;function pb(b){this.a=b||null}m=pb.prototype;m.ia=null;m.jc=null;
m.add=function(b,c){if(!this.ia&&(this.ia={},this.jc=0,this.a))for(var d=this.a.split("&"),e=0;e<d.length;e++){var f=d[e].indexOf("="),g=null;if(0<=f){var h=d[e].substring(0,f);g=d[e].substring(f+1)}else h=d[e];h=decodeURIComponent(h.replace(/\+/g," "));g=g||"";this.add(h,decodeURIComponent(g.replace(/\+/g," ")))}this.a=null;(d=this.ia.hasOwnProperty(b)&&this.ia[b])||(this.ia[b]=d=[]);d.push(c);this.jc++;return this};
m.toString=function(){if(this.a)return this.a;if(!this.ia)return"";var b=[],c;for(c in this.ia)for(var d=encodeURIComponent(c),e=this.ia[c],f=0;f<e.length;f++){var g=d;""!==e[f]&&(g+="="+encodeURIComponent(e[f]));b.push(g)}return this.a=b.join("&")};m.clone=function(){var b=new pb;b.a=this.a;if(this.ia){var c={},d;for(d in this.ia)c[d]=this.ia[d].concat();b.ia=c;b.jc=this.jc}return b};function yb(b){this.b=b;this.a=null}yb.prototype.V=function(b){var c=this;this.stop();var d=!0,e=null;this.a=function(){window.clearTimeout(e);d=!1};e=window.setTimeout(function(){d&&c.b()},1E3*b);return this};yb.prototype.stop=function(){this.a&&(this.a(),this.a=null)};function D(b){this.b=b;this.a=null}A("shaka.util.Timer",D);D.prototype.$f=function(){this.stop();this.b();return this};D.prototype.tickNow=D.prototype.$f;D.prototype.V=function(b){var c=this;this.stop();this.a=(new yb(function(){c.b()})).V(b);return this};D.prototype.tickAfter=D.prototype.V;D.prototype.Qa=function(b){var c=this;this.stop();this.a=(new yb(function(){c.a.V(b);c.b()})).V(b);return this};D.prototype.tickEvery=D.prototype.Qa;D.prototype.stop=function(){this.a&&(this.a.stop(),this.a=null)};
D.prototype.stop=D.prototype.stop;function zb(b,c){var d=Ab();this.i=null==b.maxAttempts?d.maxAttempts:b.maxAttempts;this.f=null==b.baseDelay?d.baseDelay:b.baseDelay;this.h=null==b.fuzzFactor?d.fuzzFactor:b.fuzzFactor;this.g=null==b.backoffFactor?d.backoffFactor:b.backoffFactor;this.a=0;this.b=this.f;if(this.c=void 0===c?!1:c)this.a=1}
function Bb(b){return u(function d(){var e,f;return y(d,function(d){switch(d.j){case 1:if(b.a>=b.i)if(b.c)b.a=1,b.b=b.f;else return d["return"](Promise.reject());e=b.a;b.a++;if(0==e)return d["return"]();f=b.b*(1+(2*Math.random()-1)*b.h);return v(d,new Promise(function(b){(new D(b)).V(f/1E3)}),2);case 2:b.b*=b.g,w(d)}})})}function Ab(){return{maxAttempts:2,baseDelay:1E3,backoffFactor:2,fuzzFactor:.5,timeout:0}};function E(b,c,d,e){for(var f=[],g=3;g<arguments.length;++g)f[g-3]=arguments[g];this.severity=b;this.category=c;this.code=d;this.data=f;this.handled=!1}A("shaka.util.Error",E);E.prototype.toString=function(){return"shaka.util.Error "+JSON.stringify(this,null,"  ")};E.Severity={RECOVERABLE:1,CRITICAL:2};E.Category={NETWORK:1,TEXT:2,MEDIA:3,MANIFEST:4,STREAMING:5,DRM:6,PLAYER:7,CAST:8,STORAGE:9};
E.Code={UNSUPPORTED_SCHEME:1E3,BAD_HTTP_STATUS:1001,HTTP_ERROR:1002,TIMEOUT:1003,MALFORMED_DATA_URI:1004,UNKNOWN_DATA_URI_ENCODING:1005,REQUEST_FILTER_ERROR:1006,RESPONSE_FILTER_ERROR:1007,MALFORMED_TEST_URI:1008,UNEXPECTED_TEST_REQUEST:1009,INVALID_TEXT_HEADER:2E3,INVALID_TEXT_CUE:2001,UNABLE_TO_DETECT_ENCODING:2003,BAD_ENCODING:2004,INVALID_XML:2005,INVALID_MP4_TTML:2007,INVALID_MP4_VTT:2008,UNABLE_TO_EXTRACT_CUE_START_TIME:2009,BUFFER_READ_OUT_OF_BOUNDS:3E3,JS_INTEGER_OVERFLOW:3001,EBML_OVERFLOW:3002,
EBML_BAD_FLOATING_POINT_SIZE:3003,MP4_SIDX_WRONG_BOX_TYPE:3004,MP4_SIDX_INVALID_TIMESCALE:3005,MP4_SIDX_TYPE_NOT_SUPPORTED:3006,WEBM_CUES_ELEMENT_MISSING:3007,WEBM_EBML_HEADER_ELEMENT_MISSING:3008,WEBM_SEGMENT_ELEMENT_MISSING:3009,WEBM_INFO_ELEMENT_MISSING:3010,WEBM_DURATION_ELEMENT_MISSING:3011,WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING:3012,WEBM_CUE_TIME_ELEMENT_MISSING:3013,MEDIA_SOURCE_OPERATION_FAILED:3014,MEDIA_SOURCE_OPERATION_THREW:3015,VIDEO_ERROR:3016,QUOTA_EXCEEDED_ERROR:3017,TRANSMUXING_FAILED:3018,
UNABLE_TO_GUESS_MANIFEST_TYPE:4E3,DASH_INVALID_XML:4001,DASH_NO_SEGMENT_INFO:4002,DASH_EMPTY_ADAPTATION_SET:4003,DASH_EMPTY_PERIOD:4004,DASH_WEBM_MISSING_INIT:4005,DASH_UNSUPPORTED_CONTAINER:4006,DASH_PSSH_BAD_ENCODING:4007,DASH_NO_COMMON_KEY_SYSTEM:4008,DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED:4009,DASH_CONFLICTING_KEY_IDS:4010,UNPLAYABLE_PERIOD:4011,RESTRICTIONS_CANNOT_BE_MET:4012,NO_PERIODS:4014,HLS_PLAYLIST_HEADER_MISSING:4015,INVALID_HLS_TAG:4016,HLS_INVALID_PLAYLIST_HIERARCHY:4017,DASH_DUPLICATE_REPRESENTATION_ID:4018,
HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND:4020,HLS_COULD_NOT_GUESS_MIME_TYPE:4021,HLS_MASTER_PLAYLIST_NOT_PROVIDED:4022,HLS_REQUIRED_ATTRIBUTE_MISSING:4023,HLS_REQUIRED_TAG_MISSING:4024,HLS_COULD_NOT_GUESS_CODECS:4025,HLS_KEYFORMATS_NOT_SUPPORTED:4026,DASH_UNSUPPORTED_XLINK_ACTUATE:4027,DASH_XLINK_DEPTH_LIMIT:4028,HLS_COULD_NOT_PARSE_SEGMENT_START_TIME:4030,CONTENT_UNSUPPORTED_BY_BROWSER:4032,CANNOT_ADD_EXTERNAL_TEXT_TO_LIVE_STREAM:4033,HLS_AES_128_ENCRYPTION_NOT_SUPPORTED:4034,HLS_INTERNAL_SKIP_STREAM:4035,
INVALID_STREAMS_CHOSEN:5005,NO_RECOGNIZED_KEY_SYSTEMS:6E3,REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE:6001,FAILED_TO_CREATE_CDM:6002,FAILED_TO_ATTACH_TO_VIDEO:6003,INVALID_SERVER_CERTIFICATE:6004,FAILED_TO_CREATE_SESSION:6005,FAILED_TO_GENERATE_LICENSE_REQUEST:6006,LICENSE_REQUEST_FAILED:6007,LICENSE_RESPONSE_REJECTED:6008,ENCRYPTED_CONTENT_WITHOUT_DRM_INFO:6010,NO_LICENSE_SERVER_GIVEN:6012,OFFLINE_SESSION_REMOVED:6013,EXPIRED:6014,SERVER_CERTIFICATE_REQUIRED:6015,INIT_DATA_TRANSFORM_ERROR:6016,LOAD_INTERRUPTED:7E3,
OPERATION_ABORTED:7001,NO_VIDEO_ELEMENT:7002,CAST_API_UNAVAILABLE:8E3,NO_CAST_RECEIVERS:8001,ALREADY_CASTING:8002,UNEXPECTED_CAST_ERROR:8003,CAST_CANCELED_BY_USER:8004,CAST_CONNECTION_TIMED_OUT:8005,CAST_RECEIVER_APP_UNAVAILABLE:8006,STORAGE_NOT_SUPPORTED:9E3,INDEXED_DB_ERROR:9001,DEPRECATED_OPERATION_ABORTED:9002,REQUESTED_ITEM_NOT_FOUND:9003,MALFORMED_OFFLINE_URI:9004,CANNOT_STORE_LIVE_OFFLINE:9005,STORE_ALREADY_IN_PROGRESS:9006,NO_INIT_DATA_FOR_OFFLINE:9007,LOCAL_PLAYER_INSTANCE_REQUIRED:9008,
NEW_KEY_OPERATION_NOT_SUPPORTED:9011,KEY_NOT_FOUND:9012,MISSING_STORAGE_CELL:9013};function G(){var b,c,d=new Promise(function(d,f){b=d;c=f});d.resolve=b;d.reject=c;return d}G.prototype.resolve=function(){};G.prototype.reject=function(){};function I(b,c){this.promise=b;this.ce=c;this.a=!1}A("shaka.util.AbortableOperation",I);function Cb(b){return new I(Promise.reject(b),function(){return Promise.resolve()})}I.failed=Cb;function Db(){var b=Promise.reject(new E(2,7,7001));b["catch"](function(){});return new I(b,function(){return Promise.resolve()})}I.aborted=Db;function Eb(b){return new I(Promise.resolve(b),function(){return Promise.resolve()})}I.completed=Eb;
function Fb(b){return new I(b,function(){return b["catch"](function(){})})}I.notAbortable=Fb;I.prototype.abort=function(){this.a=!0;return this.ce()};I.prototype.abort=I.prototype.abort;function Gb(b){return new I(Promise.all(b.map(function(b){return b.promise})),function(){return Promise.all(b.map(function(b){return b.abort()}))})}I.all=Gb;I.prototype["finally"]=function(b){this.promise.then(function(){return b(!0)},function(){return b(!1)});return this};I.prototype["finally"]=I.prototype["finally"];
I.prototype.X=function(b,c){function d(){f.reject(new E(2,7,7001));return e.abort()}var e=this,f=new G;this.promise.then(function(c){e.a?f.reject(new E(2,7,7001)):b?d=Hb(b,c,f):f.resolve(c)},function(b){c?d=Hb(c,b,f):f.reject(b)});return new I(f,function(){return d()})};I.prototype.chain=I.prototype.X;
function Hb(b,c,d){try{var e=b(c);if(e&&e.promise&&e.abort)return d.resolve(e.promise),function(){return e.abort()};d.resolve(e);return function(){return Promise.resolve(e).then(function(){})["catch"](function(){})}}catch(f){return d.reject(f),function(){return Promise.resolve()}}};function J(b,c){c=void 0===c?{}:c;for(var d in c)this[d]=c[d];this.defaultPrevented=this.cancelable=this.bubbles=!1;this.timeStamp=window.performance&&window.performance.now?window.performance.now():Date.now();this.type=b;this.isTrusted=!1;this.target=this.currentTarget=null;this.a=!1}J.prototype.preventDefault=function(){this.cancelable&&(this.defaultPrevented=!0)};J.prototype.stopImmediatePropagation=function(){this.a=!0};J.prototype.stopPropagation=function(){};function Ib(){this.a={}}m=Ib.prototype;m.push=function(b,c){this.a.hasOwnProperty(b)?this.a[b].push(c):this.a[b]=[c]};m.get=function(b){return(b=this.a[b])?b.slice():null};m.getAll=function(){var b=[],c;for(c in this.a)b.push.apply(b,this.a[c]);return b};m.remove=function(b,c){var d=this.a[b];if(d)for(var e=0;e<d.length;++e)d[e]==c&&(d.splice(e,1),--e)};m.forEach=function(b){for(var c in this.a)b(c,this.a[c])};function Jb(){this.Nc=new Ib;this.$d=this}Jb.prototype.addEventListener=function(b,c){this.Nc.push(b,c)};Jb.prototype.removeEventListener=function(b,c){this.Nc.remove(b,c)};Jb.prototype.dispatchEvent=function(b){for(var c=this.Nc.get(b.type)||[],d=0;d<c.length;++d){b.target=this.$d;b.currentTarget=this.$d;var e=c[d];try{e.handleEvent?e.handleEvent(b):e.call(this,b)}catch(f){B.error("Uncaught exception in event handler",f,f?f.message:null,f?f.stack:null)}if(b.a)break}return b.defaultPrevented};function Kb(b){function c(b){switch(typeof b){case "undefined":case "boolean":case "number":case "string":case "symbol":case "function":return b;default:if(!b||b.buffer&&b.buffer.constructor==ArrayBuffer)return b;if(d.has(b))return null;var e=b.constructor==Array;if(b.constructor!=Object&&!e)return null;d.add(b);var g=e?[]:{},h;for(h in b)g[h]=c(b[h]);e&&(g.length=b.length);return g}}var d=new Set;return c(b)};function Lb(b,c){return"number"===typeof b&&"number"===typeof c&&isNaN(b)&&isNaN(c)?!0:b===c}function Mb(b,c){var d=b.indexOf(c);-1<d&&b.splice(d,1)}function Nb(b,c){var d=0;b.forEach(function(b){d+=c(b)?1:0});return d}
function Ob(b,c,d){d||(d=Lb);if(b.length!=c.length)return!1;c=c.slice();var e={};b=t(b);for(var f=b.next();!f.done;e={item:e.item},f=b.next()){e.item=f.value;f=c.findIndex(function(b){return function(c){return d(b.item,c)}}(e));if(-1==f)return!1;c[f]=c[c.length-1];c.pop()}return 0==c.length};function Pb(){this.a=[]}function Qb(b,c){b.a.push(c["finally"](function(){Mb(b.a,c)}))}Pb.prototype.destroy=function(){var b=[];this.a.forEach(function(c){c.promise["catch"](function(){});b.push(c.abort())});this.a=[];return Promise.all(b)};function K(b){Jb.call(this);this.f=!1;this.g=new Pb;this.a=new Set;this.b=new Set;this.c=b||null}$a(K,Jb);A("shaka.net.NetworkingEngine",K);K.RequestType={MANIFEST:0,SEGMENT:1,LICENSE:2,APP:3,TIMING:4};K.PluginPriority={FALLBACK:1,PREFERRED:2,APPLICATION:3};var Rb={};function Ub(b,c,d){d=d||3;var e=Rb[b];if(!e||d>=e.priority)Rb[b]={priority:d,Ff:c}}K.registerScheme=Ub;K.unregisterScheme=function(b){delete Rb[b]};K.prototype.Hf=function(b){this.a.add(b)};K.prototype.registerRequestFilter=K.prototype.Hf;
K.prototype.cg=function(b){this.a["delete"](b)};K.prototype.unregisterRequestFilter=K.prototype.cg;K.prototype.Ae=function(){this.a.clear()};K.prototype.clearAllRequestFilters=K.prototype.Ae;K.prototype.If=function(b){this.b.add(b)};K.prototype.registerResponseFilter=K.prototype.If;K.prototype.dg=function(b){this.b["delete"](b)};K.prototype.unregisterResponseFilter=K.prototype.dg;K.prototype.Be=function(){this.b.clear()};K.prototype.clearAllResponseFilters=K.prototype.Be;
K.defaultRetryParameters=function(){return Ab()};function Vb(b,c){return{uris:b,method:"GET",body:null,headers:{},allowCrossSiteCredentials:!1,retryParameters:c,licenseRequestType:null,sessionId:null}}K.makeRequest=Vb;K.prototype.destroy=function(){this.f=!0;this.a.clear();this.b.clear();return this.g.destroy()};K.prototype.destroy=K.prototype.destroy;
K.prototype.request=function(b,c){var d=this,e=new Wb;if(this.f){var f=Promise.reject(new E(2,7,7001));f["catch"](function(){});return new Xb(f,function(){return Promise.resolve()},e)}c.method=c.method||"GET";c.headers=c.headers||{};c.retryParameters=c.retryParameters?Kb(c.retryParameters):Ab();c.uris=Kb(c.uris);f=Yb(this,b,c);var g=f.X(function(){return Zb(d,b,c,new zb(c.retryParameters,!1),0,null,e)}),h=g.X(function(c){return $b(d,b,c)}),k=Date.now(),l=0;f.promise.then(function(){l=Date.now()-k},
function(){});var n=0;g.promise.then(function(){n=Date.now()},function(){});f=h.X(function(c){var e=Date.now()-n,f=c.response;f.timeMs+=l;f.timeMs+=e;c.ef||!d.c||f.fromCache||1!=b||d.c(f.timeMs,f.data.byteLength);return f},function(b){b&&(b.severity=2);throw b;});f=new Xb(f.promise,f.ce,e);Qb(this.g,f);return f};K.prototype.request=K.prototype.request;
function Yb(b,c,d){var e=Eb(void 0),f={};b=t(b.a);for(var g=b.next();!g.done;f={rd:f.rd},g=b.next())f.rd=g.value,e=e.X(function(b){return function(){return b.rd(c,d)}}(f));return e.X(void 0,function(b){if(b&&7001==b.code)throw b;throw new E(2,1,1006,b);})}
function Zb(b,c,d,e,f,g,h){var k=new kb(d.uris[f]),l=k.wa,n=!1;l||(l=location.protocol,l=l.slice(0,-1),lb(k,l),d.uris[f]=k.toString());l=l.toLowerCase();var p=(l=Rb[l])?l.Ff:null;if(!p)return Cb(new E(2,1,1E3,k));var q;return Fb(Bb(e)).X(function(){if(b.f)return Db();q=Date.now();return p(d.uris[f],d,c,function(d,e,f){b.c&&1==c&&(b.c(d,e),n=!0,h.a=f)})}).X(function(b){void 0==b.timeMs&&(b.timeMs=Date.now()-q);return{response:b,ef:n}},function(k){if(k&&7001==k.code)throw k;if(b.f)return Db();if(k&&
1==k.severity)return b.dispatchEvent(new J("retry",{error:k instanceof E?k:null})),f=(f+1)%d.uris.length,Zb(b,c,d,e,f,k,h);throw k||g;})}function $b(b,c,d){var e=Eb(void 0);b=t(b.b);for(var f=b.next();!f.done;f=b.next())e=e.X(f.value.bind(null,c,d.response));return e.X(function(){return d},function(b){if(b&&7001==b.code)throw b;var c=2;b instanceof E&&(c=b.severity);throw new E(c,1,1007,b);})}function Wb(){this.a=0}K.NumBytesRemainingClass=Wb;function Xb(b,c,d){I.call(this,b,c);this.b=d}ua(Xb,I);
K.PendingRequest=Xb;Xb.all=Gb;Xb.notAbortable=Fb;Xb.completed=Eb;Xb.aborted=Db;Xb.failed=Cb;function ac(){}A("shaka.util.IReleasable",ac);ac.prototype.release=function(){};function L(){this.a=new Ib}A("shaka.util.EventManager",L);L.prototype.release=function(){this.Xb();this.a=null};L.prototype.release=L.prototype.release;L.prototype.D=function(b,c,d,e){this.a&&(b=new bc(b,c,d,e),this.a.push(c,b))};L.prototype.listen=L.prototype.D;L.prototype.ta=function(b,c,d,e){function f(e){g.oa(b,c,f);d(e)}var g=this;this.D(b,c,f,e)};L.prototype.listenOnce=L.prototype.ta;
L.prototype.oa=function(b,c,d){if(this.a){var e=this.a.get(c)||[];e=t(e);for(var f=e.next();!f.done;f=e.next())f=f.value,f.target!=b||d!=f.listener&&d||(f.oa(),this.a.remove(c,f))}};L.prototype.unlisten=L.prototype.oa;L.prototype.Xb=function(){if(this.a){var b=this.a.getAll();b=t(b);for(var c=b.next();!c.done;c=b.next())c.value.oa();this.a.a={}}};L.prototype.removeAll=L.prototype.Xb;
function bc(b,c,d,e){this.target=b;this.type=c;this.listener=d;this.a=cc(b,e);this.target.addEventListener(c,d,this.a)}bc.prototype.oa=function(){this.target.removeEventListener(this.type,this.listener,this.a);this.listener=this.target=null;this.a=!1};bc.prototype.unlisten=bc.prototype.oa;function cc(b,c){if(void 0==c)return!1;if("boolean"==typeof c)return c;var d=new Set(["passive","capture"]);Object.keys(c).filter(function(b){return!d.has(b)});return dc(b)?c:c.capture||!1}
function dc(b){var c=ec;if(void 0==c){c=!1;try{var d={},e={get:function(){c=!0;return!1}};Object.defineProperty(d,"passive",e);Object.defineProperty(d,"capture",e);e=function(){};b.addEventListener("test",e,d);b.removeEventListener("test",e,d)}catch(f){c=!1}ec=c}return c||!1}var ec=void 0;function fc(b){b=gc(b);return(new kb(b)).va}A("shaka.util.FairPlayUtils.defaultGetContentId",fc);function hc(b,c,d){function e(b){(new DataView(f.buffer)).setUint32(g,b.byteLength,!0);g+=4;f.set(b,g);g+=b.byteLength}if(!d||!d.byteLength)throw new E(2,6,6015);c="string"==typeof c?new Uint8Array(ic(c,!0)):new Uint8Array(c);b=gc(b);b=ic(b,!0);var f=new Uint8Array(12+b.byteLength+c.byteLength+d.byteLength),g=0;e(new Uint8Array(b));e(c);e(new Uint8Array(d));return f}
A("shaka.util.FairPlayUtils.initDataTransform",hc);function jc(b,c){for(var d=[],e=t(b),f=e.next();!f.done;f=e.next())d.push(c(f.value));return d}function kc(b,c){for(var d=t(b),e=d.next();!e.done;e=d.next())if(!c(e.value))return!1;return!0};function lc(b){var c=new Map;Object.keys(b).forEach(function(d){c.set(d,b[d])});return c}function mc(b){var c={};b.forEach(function(b,e){c[e]=b});return c};function nc(b,c){var d=b;c&&(d+='; codecs="'+c+'"');return d}function oc(b){var c=[b.mimeType];pc.forEach(function(d,e){var f=b[e];f&&c.push(d+'="'+f+'"')});return c.join(";")}function qc(b){b=b.split(".");var c=b[0];b.pop();return[c,b.join(".")]}var pc=(new Map).set("codecs","codecs").set("frameRate","framerate").set("bandwidth","bitrate").set("width","width").set("height","height").set("channelsCount","channels");function rc(){return window.MediaSource&&MediaSource.isTypeSupported?!0:!1}function sc(b){return""!=vc().canPlayType(b)}function wc(){return!!navigator.vendor&&navigator.vendor.includes("Apple")&&!xc("Tizen")}function yc(){if(!wc())return null;var b=navigator.userAgent.match(/Version\/(\d+)/);return b?parseInt(b[1],10):(b=navigator.userAgent.match(/OS (\d+)(?:_\d+)?/))?parseInt(b[1],10):null}function xc(b){return(navigator.userAgent||"").includes(b)}
function vc(){if(zc)return zc;Ac||(Ac=new D(function(){zc=null}));(zc=document.getElementsByTagName("video")[0]||document.getElementsByTagName("audio")[0])||(zc=document.createElement("video"));Ac.V(1);return zc}var Ac=null,zc=null;function Bc(b){if(!b)return"";b=new Uint8Array(b);239==b[0]&&187==b[1]&&191==b[2]&&(b=b.subarray(3));b=Cc(b);b=escape(b);try{return decodeURIComponent(b)}catch(c){throw new E(2,2,2004);}}A("shaka.util.StringUtils.fromUTF8",Bc);
function Dc(b,c,d){if(!b)return"";if(!d&&0!=b.byteLength%2)throw B.error("Data has an incorrect length, must be even."),new E(2,2,2004);if(b instanceof ArrayBuffer)var e=b;else d=new Uint8Array(b.byteLength),d.set(new Uint8Array(b)),e=d.buffer;b=Math.floor(b.byteLength/2);d=new Uint16Array(b);e=new DataView(e);for(var f=0;f<b;f++)d[f]=e.getUint16(2*f,c);return Cc(d)}A("shaka.util.StringUtils.fromUTF16",Dc);
function gc(b){var c=new Uint8Array(b);if(239==c[0]&&187==c[1]&&191==c[2])return Bc(c);if(254==c[0]&&255==c[1])return Dc(c.subarray(2),!1);if(255==c[0]&&254==c[1])return Dc(c.subarray(2),!0);var d=function(b,c){return b.byteLength<=c||32<=b[c]&&126>=b[c]}.bind(null,c);B.debug("Unable to find byte-order-mark, making an educated guess.");if(0==c[0]&&0==c[2])return Dc(b,!1);if(0==c[1]&&0==c[3])return Dc(b,!0);if(d(0)&&d(1)&&d(2)&&d(3))return Bc(b);throw new E(2,2,2003);}
A("shaka.util.StringUtils.fromBytesAutoDetect",gc);function Ec(b){b=encodeURIComponent(b);b=unescape(b);for(var c=new Uint8Array(b.length),d=0;d<b.length;++d)c[d]=b.charCodeAt(d);return c.buffer}A("shaka.util.StringUtils.toUTF8",Ec);function ic(b,c){for(var d=new Uint8Array(2*b.length),e=new DataView(d.buffer),f=0;f<b.length;++f)e.setUint16(2*f,b.charCodeAt(f),c);return d.buffer}A("shaka.util.StringUtils.toUTF16",ic);
function Cc(b){if(!Fc)for(var c=function(b){try{var c=new Uint8Array(b);return 0<String.fromCharCode.apply(null,c).length}catch(g){return!1}},d={size:65536};0<d.size;d={size:d.size},d.size/=2)if(c(d.size)){Fc=function(b){return function(c){for(var d="",e=0;e<c.length;e+=b.size)d+=String.fromCharCode.apply(null,c.subarray(e,e+b.size));return d}}(d);break}return Fc(b)}var Fc=null;A("shaka.util.StringUtils.resetFromCharCode",function(){Fc=null});var M={Cc:function(b,c){var d=Cc(b);c=void 0==c?!0:c;d=window.btoa(d).replace(/\+/g,"-").replace(/\//g,"_");return c?d:d.replace(/=*$/,"")}};A("shaka.util.Uint8ArrayUtils.toBase64",M.Cc);M.Da=function(b){b=window.atob(b.replace(/-/g,"+").replace(/_/g,"/"));for(var c=new Uint8Array(b.length),d=0;d<b.length;++d)c[d]=b.charCodeAt(d);return c};A("shaka.util.Uint8ArrayUtils.fromBase64",M.Da);
M.Uc=function(b){for(var c=new Uint8Array(b.length/2),d=0;d<b.length;d+=2)c[d/2]=window.parseInt(b.substr(d,2),16);return c};A("shaka.util.Uint8ArrayUtils.fromHex",M.Uc);M.Dc=function(b){for(var c="",d=0;d<b.length;++d){var e=b[d].toString(16);1==e.length&&(e="0"+e);c+=e}return c};A("shaka.util.Uint8ArrayUtils.toHex",M.Dc);M.Ka=function(b,c){if(!b&&!c)return!0;if(!b||!c||b.length!=c.length)return!1;for(var d=0;d<b.length;++d)if(b[d]!=c[d])return!1;return!0};A("shaka.util.Uint8ArrayUtils.equal",M.Ka);
M.concat=function(b){for(var c=[],d=0;d<arguments.length;++d)c[d]=arguments[d];for(var e=d=0;e<c.length;++e)d+=c[e].length;d=new Uint8Array(d);for(var f=e=0;f<c.length;++f)d.set(c[f],e),e+=c[f].length;return d};A("shaka.util.Uint8ArrayUtils.concat",M.concat);function Gc(b,c){var d=this;c=void 0===c?1:c;this.F=b;this.A=new Set;this.h=this.m=null;this.W=!1;this.O=0;this.a=null;this.i=new L;this.b=new Map;this.v=[];this.s=new G;this.f=null;this.g=function(c){d.s.reject(c);b.onError(c)};this.ra=new Map;this.Y=new Map;this.U=new D(function(){return Hc(d)});this.c=!1;this.pa=new G;this.H=!1;this.K=[];this.qa=!1;this.ca=(new D(function(){Ic(d)})).Qa(c);this.s["catch"](function(){})}m=Gc.prototype;
m.destroy=function(){var b=this;return u(function d(){return y(d,function(d){switch(d.j){case 1:if(b.c)return v(d,b.pa,0);b.c=!0;return v(d,Jc(b),4);case 4:b.pa.resolve(),d.B(0)}})})};
function Jc(b){return u(function d(){return y(d,function(d){switch(d.j){case 1:return b.i.release(),b.i=null,b.s.reject(),b.ca.stop(),b.ca=null,b.U.stop(),b.U=null,v(d,Kc(b),2);case 2:if(!b.h){d.B(3);break}Da(d,4);return v(d,b.h.setMediaKeys(null),6);case 6:Fa(d,5);break;case 4:Ga(d);case 5:b.h=null;case 3:b.a=null,b.A.clear(),b.m=null,b.v=[],b.f=null,b.g=null,b.F=null,w(d)}})})}m.configure=function(b){this.f=b};function Lc(b,c,d){b.v=[];b.H=d;return Mc(b,c)}
function Nc(b,c,d){b.v=d;b.H=0<d.length;return Mc(b,c)}function Oc(b,c,d,e,f,g){var h=new Map;h.set(c,{audioCapabilities:f,videoCapabilities:g,distinctiveIdentifier:"optional",persistentState:"required",sessionTypes:["persistent-license"],label:c,drmInfos:[{keySystem:c,licenseServerUri:d,distinctiveIdentifierRequired:!1,persistentStateRequired:!0,audioRobustness:"",videoRobustness:"",serverCertificate:e,initData:null,keyIds:null}]});return Pc(b,h)}
function Mc(b,c){var d=Qc(b);if(d)for(var e=t(c),f=e.next();!f.done;f=e.next())f.value.drmInfos=[d];d=c.some(function(b){return 0<b.drmInfos.length});d||(f=lc(b.f.servers),Rc(c,f));e=t(c);for(f=e.next();!f.done;f=e.next()){f=t(f.value.drmInfos);for(var g=f.next();!g.done;g=f.next())Sc(g.value,lc(b.f.servers),lc(b.f.advanced||{}))}f=Tc(b,c);if(!f.size)return b.W=!0,Promise.resolve();f=Pc(b,f);return d?f:f["catch"](function(){})}
m.Mb=function(b){var c=this;if(!this.m)return this.i.ta(b,"encrypted",function(){c.g(new E(2,6,6010))}),Promise.resolve();this.h=b;this.i.ta(this.h,"play",function(){for(var b=0;b<c.K.length;b++)Uc(c,c.K[b]);c.qa=!0;c.K=[]});"webkitCurrentPlaybackTargetIsWireless"in this.h&&this.i.D(this.h,"webkitcurrentplaybacktargetiswirelesschanged",function(){return Kc(c)});b=this.h.setMediaKeys(this.m);b=b["catch"](function(b){return Promise.reject(new E(2,6,6003,b.message))});var d=Vc(this);return Promise.all([b,
d]).then(function(){if(c.c)return Promise.reject();Wc(c);c.a.initData.length||c.v.length||c.i.D(c.h,"encrypted",function(b){return Xc(c,b.initDataType,new Uint8Array(b.initData))})})["catch"](function(b){if(!c.c)return Promise.reject(b)})};
function Vc(b){return u(function d(){var e,f;return y(d,function(d){switch(d.j){case 1:if(!(b.m&&b.a&&b.a.serverCertificate&&b.a.serverCertificate.length)){d.B(0);break}Da(d,3);return v(d,b.m.setServerCertificate(b.a.serverCertificate),5);case 5:(e=d.o)||B.l("Server certificates are not supported by the key system.  The server certificate has been ignored.");Fa(d,0);break;case 3:return f=Ga(d),d["return"](Promise.reject(new E(2,6,6004,f.message)))}})})}
function Yc(b,c){return u(function e(){var f,g,h;return y(e,function(e){switch(e.j){case 1:return v(e,Zc(b,c),2);case 2:f=e.o;if(!f)return B.I("Ignoring attempt to remove missing session",c),e["return"]();g=[];if(h=b.b.get(f))h.Ba=new G,g.push(h.Ba);B.I("Attempting to remove session",c);g.push(f.remove());return v(e,Promise.all(g),0)}})})}
function Wc(b){var c=b.a?b.a.initData:[];c.forEach(function(c){return $c(b,c.initDataType,c.initData)});b.v.forEach(function(c){return Zc(b,c)});c.length||b.v.length||b.s.resolve();return b.s}function Xc(b,c,d){var e=b.b.values();e=t(e);for(var f=e.next();!f.done;f=e.next())if(M.Ka(d,f.value.initData)&&!xc("Tizen 2")){B.debug("Ignoring duplicate init data.");return}$c(b,c,d)}function ad(b){return b?b.keySystem:""}function bd(b,c){return xc("Edge/")?!0:b.A.has(c)}
function cd(b){b=b.b.keys();b=jc(b,function(b){return b.sessionId});return Array.from(b)}m.Pb=function(){var b=Infinity,c=this.b.keys();c=t(c);for(var d=c.next();!d.done;d=c.next())d=d.value,isNaN(d.expiration)||(b=Math.min(b,d.expiration));return b};
function Tc(b,c){for(var d=new Set,e=t(c),f=e.next();!f.done;f=e.next()){var g=t(f.value.drmInfos);for(f=g.next();!f.done;f=g.next())d.add(f.value)}e=t(d);for(f=e.next();!f.done;f=e.next())Sc(f.value,lc(b.f.servers),lc(b.f.advanced||{}));g=b.H?"required":"optional";var h=b.H?["persistent-license"]:["temporary"];e=new Map;d=t(d);for(f=d.next();!f.done;f=d.next())f=f.value,e.set(f.keySystem,{audioCapabilities:[],videoCapabilities:[],distinctiveIdentifier:"optional",persistentState:g,sessionTypes:h,
label:f.keySystem,drmInfos:[]});d=t(c);for(f=d.next();!f.done;f=d.next()){f=f.value;g=f.audio;h=f.video;var k=g?nc(g.mimeType,g.codecs):"",l=h?nc(h.mimeType,h.codecs):"",n=t(f.drmInfos);for(f=n.next();!f.done;f=n.next()){f=f.value;var p=e.get(f.keySystem);p.drmInfos.push(f);f.distinctiveIdentifierRequired&&(p.distinctiveIdentifier="required");f.persistentStateRequired&&(p.persistentState="required");g&&p.audioCapabilities.push({robustness:f.audioRobustness||"",contentType:k});h&&p.videoCapabilities.push({robustness:f.videoRobustness||
"",contentType:l})}}return e}
function Pc(b,c){if(1==c.size&&c.has(""))return Promise.reject(new E(2,6,6E3));for(var d=t(c.values()),e=d.next();!e.done;e=d.next())e=e.value,0==e.audioCapabilities.length&&delete e.audioCapabilities,0==e.videoCapabilities.length&&delete e.videoCapabilities;var f=d=new G;[!0,!1].forEach(function(b){var d=this;c.forEach(function(c,e){c.drmInfos.some(function(b){return!!b.licenseServerUri})==b&&(f=f["catch"](function(){if(!this.c)return navigator.requestMediaKeySystemAccess(e,[c])}.bind(d)))})}.bind(b));
f=f["catch"](function(){return Promise.reject(new E(2,6,6001))});f=f.then(function(b){if(this.c)return Promise.reject();this.A.clear();var d=b.getConfiguration(),e=d.videoCapabilities||[],f=t(d.audioCapabilities||[]);for(d=f.next();!d.done;d=f.next())this.A.add(d.value.contentType);e=t(e);for(d=e.next();!d.done;d=e.next())this.A.add(d.value.contentType);e=b.keySystem;d=c.get(b.keySystem);f=[];var g=[],p=[],q=[];dd(d.drmInfos,f,g,p,q);1<g.length&&B.l("Multiple unique server certificates found! Only the first will be used.");
1<f.length&&B.l("Multiple unique license server URIs found! Only the first will be used.");this.a={keySystem:e,licenseServerUri:f[0],distinctiveIdentifierRequired:"required"==d.distinctiveIdentifier,persistentStateRequired:"required"==d.persistentState,audioRobustness:(d.audioCapabilities?d.audioCapabilities[0].robustness:"")||"",videoRobustness:(d.videoCapabilities?d.videoCapabilities[0].robustness:"")||"",serverCertificate:g[0],initData:p,keyIds:q};return this.a.licenseServerUri?b.createMediaKeys():
Promise.reject(new E(2,6,6012,this.a.keySystem))}.bind(b)).then(function(b){if(this.c)return Promise.reject();B.info("Created MediaKeys object for key system",this.a.keySystem);this.m=b;this.W=!0}.bind(b))["catch"](function(b){if(!this.c)return this.a=null,this.A.clear(),b instanceof E?Promise.reject(b):Promise.reject(new E(2,6,6002,b.message))}.bind(b));d.reject();return f}
function Qc(b){b=lc(b.f.clearKeys);if(0==b.size)return null;var c=[],d=[];b.forEach(function(b,e){var f=M.Uc(e),g=M.Uc(b);f={kty:"oct",kid:M.Cc(f,!1),k:M.Cc(g,!1)};c.push(f);d.push(f.kid)});b=JSON.stringify({keys:c});var e=JSON.stringify({kids:d});e=[{initData:new Uint8Array(Ec(e)),initDataType:"keyids"}];return{keySystem:"org.w3.clearkey",licenseServerUri:"data:application/json;base64,"+window.btoa(b),distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",
serverCertificate:null,initData:e,keyIds:[]}}
function Zc(b,c){try{B.C("Attempting to load an offline session",c);var d=b.m.createSession("persistent-license")}catch(g){var e=new E(2,6,6005,g.message);b.g(e);return Promise.reject(e)}b.i.D(d,"message",b.ge.bind(b));b.i.D(d,"keystatuseschange",b.fe.bind(b));var f={initData:null,loaded:!1,ld:Infinity,Ba:null};b.b.set(d,f);return d.load(c).then(function(b){if(this.c)return Promise.reject();B.I("Loaded offline session",c,b);if(b)return f.loaded=!0,ed(this)&&this.s.resolve(),d;this.b["delete"](d);
this.g(new E(2,6,6013))}.bind(b),function(b){this.c||(this.b["delete"](d),this.g(new E(2,6,6005,b.message)))}.bind(b))}
function $c(b,c,d){try{if(b.H){B.C("Creating new persistent session");var e=b.m.createSession("persistent-license")}else B.C("Creating new temporary session"),e=b.m.createSession()}catch(f){b.g(new E(2,6,6005,f.message));return}b.i.D(e,"message",b.ge.bind(b));b.i.D(e,"keystatuseschange",b.fe.bind(b));b.b.set(e,{initData:d,loaded:!1,ld:Infinity,Ba:null});try{d=b.f.initDataTransform(d,b.a)}catch(f){c=f;f instanceof E||(c=new E(2,6,6016,f));b.g(c);return}e.generateRequest(c,d.buffer)["catch"](function(c){if(!b.c){b.b["delete"](e);
if(c.errorCode&&c.errorCode.systemCode){var d=c.errorCode.systemCode;0>d&&(d+=Math.pow(2,32));d="0x"+d.toString(16)}b.g(new E(2,6,6006,c.message,c,d))}})}function fd(b,c){if(ad(c).startsWith("com.apple.fps")){var d=c.serverCertificate,e=fc(b);b=hc(b,e,d)}return b}m.ge=function(b){this.h&&this.f.delayLicenseRequestUntilPlayed&&this.h.paused&&!this.qa?this.K.push(b):Uc(this,b)};
function Uc(b,c){var d=c.target;B.C("Sending license request for session",d.sessionId,"of type",c.messageType);var e=b.b.get(d),f=b.a.licenseServerUri,g=b.f.advanced[b.a.keySystem];"individualization-request"==c.messageType&&g&&g.individualizationServer&&(f=g.individualizationServer);f=Vb([f],b.f.retryParameters);f.body=c.message;f.method="POST";f.licenseRequestType=c.messageType;f.sessionId=d.sessionId;"com.microsoft.playready"!=b.a.keySystem&&"com.chromecast.playready"!=b.a.keySystem||gd(f);b.a.keySystem.startsWith("com.apple.fps")&&
b.f.fairPlayTransform&&hd(f);var h=Date.now();b.F.Ab.request(2,f).promise.then(function(b){if(this.c)return Promise.reject();this.a.keySystem.startsWith("com.apple.fps")&&this.f.fairPlayTransform&&id(b);this.O+=(Date.now()-h)/1E3;B.C("Updating session",d.sessionId);return d.update(b.data).then(function(){var b=this;this.F.onEvent(new J("drmsessionupdate"));e&&(e.Ba&&e.Ba.resolve(),(new D(function(){e.loaded=!0;ed(b)&&b.s.resolve()})).V(jd))}.bind(this))}.bind(b),function(b){this.c||(b=new E(2,6,6007,
b),this.g(b),e&&e.Ba&&e.Ba.reject(b))}.bind(b))["catch"](function(b){this.c||(b=new E(2,6,6008,b.message),this.g(b),e&&e.Ba&&e.Ba.reject(b))}.bind(b))}
function gd(b){var c=Dc(b.body,!0,!0);if(c.includes("PlayReadyKeyMessage")){B.debug("Unwrapping PlayReady request.");c=(new DOMParser).parseFromString(c,"application/xml");for(var d=c.getElementsByTagName("HttpHeader"),e=0;e<d.length;++e)b.headers[d[e].getElementsByTagName("name")[0].textContent]=d[e].getElementsByTagName("value")[0].textContent;b.body=M.Da(c.getElementsByTagName("Challenge")[0].textContent).buffer}else B.debug("PlayReady request is already unwrapped."),b.headers["Content-Type"]=
"text/xml; charset=utf-8"}function hd(b){var c=new Uint8Array(b.body);c="spc="+M.Cc(c);b.headers["Content-Type"]="application/x-www-form-urlencoded";b.body=Ec(c)}function id(b){try{var c=Bc(b.data)}catch(d){return}c=c.trim();"<ckc>"===c.substr(0,5)&&"</ckc>"===c.substr(-6)&&(c=c.slice(5,-6));try{c=JSON.parse(c).ckc}catch(d){}b.data=M.Da(c).buffer}
m.fe=function(b){b=b.target;B.I("Key status changed for session",b.sessionId);var c=this.b.get(b),d=!1;b.keyStatuses.forEach(function(b,e){if("string"==typeof e){var f=e;e=b;b=f}if(!("com.microsoft.playready"!=this.a.keySystem||16!=e.byteLength||xc("Tizen")||xc("VITIS")||xc("Web0S")||xc("TiVo"))){f=new DataView(e);var g=f.getUint32(0,!0),l=f.getUint16(4,!0),n=f.getUint16(6,!0);f.setUint32(0,g,!1);f.setUint16(4,l,!1);f.setUint16(6,n,!1)}"com.microsoft.playready"==this.a.keySystem&&"status-pending"==
b&&(b="usable");"status-pending"!=b&&(c.loaded=!0);"expired"==b&&(d=!0);f=M.Dc(new Uint8Array(e));this.ra.set(f,b)}.bind(this));var e=b.expiration-Date.now();(0>e||d&&1E3>e)&&c&&!c.Ba&&(B.debug("Session has expired",b.sessionId),this.b["delete"](b),b.close()["catch"](function(){}));ed(this)&&(this.s.resolve(),this.U.V(kd))};
function Hc(b){var c=b.ra,d=b.Y;d.clear();c.forEach(function(b,c){return d.set(c,b)});c=Array.from(d.values());c.length&&c.every(function(b){return"expired"==b})&&b.g(new E(2,6,6014));b.F.uc(mc(d))}
function ld(){function b(b){return u(function h(){var c,f,n;return y(h,function(h){switch(h.j){case 1:return Da(h,2),v(h,navigator.requestMediaKeySystemAccess(b,d),4);case 4:return c=h.o,n=(f=c.getConfiguration().sessionTypes)?f.includes("persistent-license"):!1,xc("Tizen 3")&&(n=!1),e.set(b,{persistentState:n}),v(h,c.createMediaKeys(),5);case 5:Fa(h,0);break;case 2:Ga(h),e.set(b,null),w(h)}})})}var c=[{contentType:'video/mp4; codecs="avc1.42E01E"'},{contentType:'video/webm; codecs="vp8"'}],d=[{videoCapabilities:c,
persistentState:"required",sessionTypes:["persistent-license"]},{videoCapabilities:c}],e=new Map;c="org.w3.clearkey com.widevine.alpha com.microsoft.playready com.apple.fps.3_0 com.apple.fps.2_0 com.apple.fps.1_0 com.apple.fps com.adobe.primetime".split(" ").map(function(c){return b(c)});return Promise.all(c).then(function(){return mc(e)})}
function md(b,c){var d=c.audio,e=c.video;if(d&&d.encrypted&&!bd(b,nc(d.mimeType,d.codecs))||e&&e.encrypted&&!bd(b,nc(e.mimeType,e.codecs)))return!1;var f=ad(b.a);return 0==c.drmInfos.length||c.drmInfos.some(function(b){return b.keySystem==f})}
function nd(b,c){if(!b.length)return c;if(!c.length)return b;for(var d=[],e=0;e<b.length;e++)for(var f=0;f<c.length;f++)if(b[e].keySystem==c[f].keySystem){var g=b[e];f=c[f];var h=[];h=h.concat(g.initData||[]);h=h.concat(f.initData||[]);var k=[];k=k.concat(g.keyIds);k=k.concat(f.keyIds);d.push({keySystem:g.keySystem,licenseServerUri:g.licenseServerUri||f.licenseServerUri,distinctiveIdentifierRequired:g.distinctiveIdentifierRequired||f.distinctiveIdentifierRequired,persistentStateRequired:g.persistentStateRequired||
f.persistentStateRequired,videoRobustness:g.videoRobustness||f.videoRobustness,audioRobustness:g.audioRobustness||f.audioRobustness,serverCertificate:g.serverCertificate||f.serverCertificate,initData:h,keyIds:k});break}return d}
function Kc(b){return u(function d(){var e;return y(d,function(d){switch(d.j){case 1:return e=Array.from(b.b.keys()),b.b.clear(),v(d,Promise.all(e.map(function(b){return u(function k(){return y(k,function(d){switch(d.j){case 1:return B.C("Closing session",b.sessionId),Da(d,2),v(d,Promise.all([b.close(),b.closed]),4);case 4:Fa(d,0);break;case 2:Ga(d),w(d)}})})})),0)}})})}
function Ic(b){b.b.forEach(function(c,d){var e=c.ld,f=d.expiration;isNaN(f)&&(f=Infinity);f!=e&&(b.F.onExpirationUpdated(d.sessionId,f),c.ld=f)})}function ed(b){b=b.b.values();return kc(b,function(b){return b.loaded})}
function Rc(b,c){var d=[];c.forEach(function(b,c){d.push({keySystem:c,licenseServerUri:b,distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:[],keyIds:[]})});for(var e=t(b),f=e.next();!f.done;f=e.next())f.value.drmInfos=d}
function dd(b,c,d,e,f){b.forEach(function(b){c.includes(b.licenseServerUri)||c.push(b.licenseServerUri);b.serverCertificate&&(d.some(function(c){return M.Ka(c,b.serverCertificate)})||d.push(b.serverCertificate));b.initData&&b.initData.forEach(function(b){e.some(function(c){return c.keyId&&c.keyId==b.keyId?!0:c.initDataType==b.initDataType&&M.Ka(c.initData,b.initData)})||e.push(b)});if(b.keyIds)for(var g=0;g<b.keyIds.length;++g)f.includes(b.keyIds[g])||f.push(b.keyIds[g])})}
function Sc(b,c,d){if(b.keySystem&&("org.w3.clearkey"!=b.keySystem||!b.licenseServerUri)){c.size&&(c=c.get(b.keySystem)||"",b.licenseServerUri=c);b.keyIds||(b.keyIds=[]);if(d=d.get(b.keySystem))b.distinctiveIdentifierRequired||(b.distinctiveIdentifierRequired=d.distinctiveIdentifierRequired),b.persistentStateRequired||(b.persistentStateRequired=d.persistentStateRequired),b.videoRobustness||(b.videoRobustness=d.videoRobustness),b.audioRobustness||(b.audioRobustness=d.audioRobustness),b.serverCertificate||
(b.serverCertificate=d.serverCertificate);window.cast&&window.cast.__platform__&&"com.microsoft.playready"==b.keySystem&&(b.keySystem="com.chromecast.playready")}}var jd=5,kd=.5;function od(){this.a=new muxjs.mp4.CaptionParser;this.g=[];this.f={}}od.prototype.init=function(b){var c=muxjs.mp4.probe;b=new Uint8Array(b);this.g=c.videoTrackIds(b);this.f=c.timescale(b);this.a.init()};od.prototype.b=function(b,c){var d=new Uint8Array(b);(d=this.a.parse(d,this.g,this.f))&&d.captions&&c(d.captions);this.a.clearParsedCaptions()};od.prototype.c=function(){this.a.resetCaptionStream()};function pd(){}pd.prototype.init=function(){};pd.prototype.b=function(){};pd.prototype.c=function(){};function qd(b){return!b||1==b.length&&1E-6>b.end(0)-b.start(0)?null:b.length?b.end(b.length-1):null}function rd(b,c,d){d=void 0===d?0:d;return!b||!b.length||1==b.length&&1E-6>b.end(0)-b.start(0)||c>b.end(b.length-1)?!1:c+d>=b.start(0)}function sd(b,c){if(!b||!b.length||1==b.length&&1E-6>b.end(0)-b.start(0))return 0;for(var d=0,e=b.length-1;0<=e&&b.end(e)>c;--e)d+=b.end(e)-Math.max(b.start(e),c);return d}
function td(b){if(!b)return[];for(var c=[],d=0;d<b.length;d++)c.push({start:b.start(d),end:b.end(d)});return c};var vd={Ce:function(b,c){return b.reduce(function(b,c,f){return c["catch"](b.bind(null,f))}.bind(null,c),Promise.reject())},Kc:function(b,c){return b.concat(c)},sc:function(){},La:function(b){return null!=b}};function wd(b,c){if(0==c.length)return b;var d=c.map(function(b){return new kb(b)});return b.map(function(b){return new kb(b)}).map(function(b){return d.map(b.resolve.bind(b))}).reduce(vd.Kc,[]).map(function(b){return b.toString()})}function xd(b,c){return{keySystem:b,licenseServerUri:"",distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:c||[],keyIds:[]}}
var yd={Ta:"video",Kb:"audio",ua:"text",jg:"image",hg:"application"},zd=1/15;function Ad(){this.a=new muxjs.mp4.Transmuxer({keepOriginalTimestamps:!0});this.b=null;this.g=[];this.c=[];this.f=!1;this.a.on("data",this.i.bind(this));this.a.on("done",this.h.bind(this))}Ad.prototype.destroy=function(){this.a.dispose();this.a=null;return Promise.resolve()};function Bd(b,c){return window.muxjs&&"mp2t"==b.toLowerCase().split(";")[0].split("/")[1]?c?MediaSource.isTypeSupported(Cd(c,b)):MediaSource.isTypeSupported(Cd("audio",b))||MediaSource.isTypeSupported(Cd("video",b)):!1}
function Cd(b,c){var d=c.replace(/mp2t/i,"mp4");"audio"==b&&(d=d.replace("video","audio"));var e=/avc1\.(66|77|100)\.(\d+)/.exec(d);if(e){var f="avc1.",g=e[1],h=Number(e[2]);f=("66"==g?f+"4200":"77"==g?f+"4d00":f+"6400")+(h>>4).toString(16);f+=(h&15).toString(16);d=d.replace(e[0],f)}return d}function Dd(b,c){b.f=!0;b.b=new G;b.g=[];b.c=[];var d=new Uint8Array(c);b.a.push(d);b.a.flush();b.f&&b.b.reject(new E(2,3,3018));return b.b}
Ad.prototype.i=function(b){this.c=b.captions;var c=new Uint8Array(b.data.byteLength+b.initSegment.byteLength);c.set(b.initSegment,0);c.set(b.data,b.initSegment.byteLength);this.g.push(c)};Ad.prototype.h=function(){var b={data:M.concat.apply(null,this.g),captions:this.c};this.b.resolve(b);this.f=!1};function Ed(b,c,d){this.startTime=b;this.direction=Fd;this.endTime=c;this.payload=d;this.region=new Gd;this.position=null;this.positionAlign=Hd;this.size=0;this.textAlign=Id;this.writingMode=Jd;this.lineInterpretation=Kd;this.line=null;this.lineHeight="";this.lineAlign=Ld;this.displayAlign=Md;this.fontSize=this.backgroundImage=this.backgroundColor=this.color="";this.fontWeight=Nd;this.fontStyle=Od;this.fontFamily="";this.textDecoration=[];this.wrapLine=!0;this.id="";this.nestedCues=[];this.spacer=
!1}A("shaka.text.Cue",Ed);var Hd="auto";Ed.positionAlign={LEFT:"line-left",RIGHT:"line-right",CENTER:"center",AUTO:Hd};var Id="center",Pd={LEFT:"left",RIGHT:"right",CENTER:Id,START:"start",END:"end"};Ed.textAlign=Pd;var Md="after",Qd={BEFORE:"before",CENTER:"center",AFTER:Md};Ed.displayAlign=Qd;var Fd="ltr";Ed.direction={HORIZONTAL_LEFT_TO_RIGHT:Fd,HORIZONTAL_RIGHT_TO_LEFT:"rtl"};var Jd="horizontal-tb";Ed.writingMode={HORIZONTAL_TOP_TO_BOTTOM:Jd,VERTICAL_LEFT_TO_RIGHT:"vertical-lr",VERTICAL_RIGHT_TO_LEFT:"vertical-rl"};
var Kd=0;Ed.lineInterpretation={LINE_NUMBER:Kd,PERCENTAGE:1};var Ld="start",Rd={CENTER:"center",START:Ld,END:"end"};Ed.lineAlign=Rd;var Nd=400;Ed.fontWeight={NORMAL:Nd,BOLD:700};var Od="normal",Sd={NORMAL:Od,ITALIC:"italic",OBLIQUE:"oblique"};Ed.fontStyle=Sd;Ed.textDecoration={UNDERLINE:"underline",LINE_THROUGH:"lineThrough",OVERLINE:"overline"};
function Gd(){this.id="";this.regionAnchorY=this.regionAnchorX=this.viewportAnchorY=this.viewportAnchorX=0;this.height=this.width=100;this.viewportAnchorUnits=this.widthUnits=this.heightUnits=Td;this.scroll=Ud}A("shaka.text.CueRegion",Gd);var Td=1;Gd.units={PX:0,PERCENTAGE:Td,LINES:2};var Ud="";Gd.scrollMode={NONE:Ud,UP:"up"};function Vd(b){this.g=null;this.c=b;this.f=this.s=0;this.h=Infinity;this.b=this.a=null;this.m="";this.i=new Map}var Wd={};A("shaka.text.TextEngine.registerParser",function(b,c){Wd[b]=c});A("shaka.text.TextEngine.unregisterParser",function(b){delete Wd[b]});function Xd(b){return Wd[b]||window.muxjs&&"application/cea-608"==b?!0:!1}Vd.prototype.destroy=function(){this.c=this.g=null;this.i.clear();return Promise.resolve()};function Yd(b,c){"application/cea-608"!=c&&(b.g=new Wd[c])}
Vd.prototype.oc=function(b){var c={periodStart:0,segmentStart:null,segmentEnd:0};try{return this.g.parseMedia(new Uint8Array(b),c)[0].startTime}catch(d){throw new E(2,2,2009,d);}};
function Zd(b,c,d,e){return Promise.resolve().then(function(){if(this.g&&this.c)if(null==d||null==e)this.g.parseInit(new Uint8Array(c));else{var b={periodStart:this.s,segmentStart:d,segmentEnd:e};b=this.g.parseMedia(new Uint8Array(c),b).filter(function(b){return b.startTime>=this.f&&b.startTime<this.h}.bind(this));this.c.append(b);null==this.a&&(this.a=Math.max(d,this.f));this.b=Math.min(e,this.h)}}.bind(b))}
Vd.prototype.remove=function(b,c){return Promise.resolve().then(function(){!this.c||!this.c.remove(b,c)||null==this.a||c<=this.a||b>=this.b||(b<=this.a&&c>=this.b?this.a=this.b=null:b<=this.a&&c<this.b?this.a=c:b>this.a&&c>=this.b&&(this.b=b))}.bind(this))};function $d(b,c,d){b.m=c;if(c=b.i.get(c))for(var e=t(c.keys()),f=e.next();!f.done;f=e.next())(f=c.get(f.value).filter(function(b){return b.endTime<=d}))&&b.c.append(f)}
function ae(b,c,d,e,f){var g=d+" "+e,h=new Map;c=t(c);for(var k=c.next();!k.done;k=c.next()){var l=k.value;k=l.stream;h.has(k)||h.set(k,new Map);h.get(k).has(g)||h.get(k).set(g,[]);l.startTime+=f;l.endTime+=f;l.startTime>=b.f&&l.startTime<b.h&&(l=new Ed(l.startTime,l.endTime,l.text),h.get(k).get(g).push(l),k==b.m&&b.c.append([l]))}f=t(h.keys());for(g=f.next();!g.done;g=f.next())for(g=g.value,b.i.has(g)||b.i.set(g,new Map),c=t(h.get(g).keys()),k=c.next();!k.done;k=c.next())k=k.value,l=h.get(g).get(k),
b.i.get(g).set(k,l);b.a=null==b.a?Math.max(d,b.f):Math.min(b.a,Math.max(d,b.f));b.b=Math.max(b.b,Math.min(e,b.h))};function be(b,c,d){this.f=b;this.g=d;this.b={};this.a=null;this.c={};this.i=new L;this.A=!1;this.m={};this.s=c;b=this.v=new G;c=new MediaSource;this.i.ta(c,"sourceopen",b.resolve);this.f.src=ce(c);this.h=c}var ce=window.URL.createObjectURL;function de(b){var c=nc(b.mimeType,b.codecs),d=oc(b);return Xd(c)||MediaSource.isTypeSupported(d)||Bd(c,b.type)}m=be.prototype;
m.destroy=function(){var b=this;this.A=!0;var c=[],d;for(d in this.c){var e=this.c[d],f=e[0];this.c[d]=e.slice(0,1);f&&c.push(f.p["catch"](vd.sc));for(f=1;f<e.length;++f)e[f].p.reject()}this.a&&c.push(this.a.destroy());this.g&&c.push(this.g.destroy());for(var g in this.m)c.push(this.m[g].destroy());return Promise.all(c).then(function(){b.i&&(b.i.release(),b.i=null);b.f&&(b.f.removeAttribute("src"),b.f.load(),b.f=null);b.h=null;b.a=null;b.g=null;b.b={};b.m={};b.s=null;b.c={}})};
m.init=function(b,c){var d=this;return u(function f(){var g;return y(f,function(f){switch(f.j){case 1:return g=yd,v(f,d.v,2);case 2:b.forEach(function(b,f){var h=nc(b.mimeType,b.codecs);f==g.ua?ee(d,h):(!c&&MediaSource.isTypeSupported(h)||!Bd(h,f)||(d.m[f]=new Ad,h=Cd(f,h)),h=d.h.addSourceBuffer(h),d.i.D(h,"error",d.Yf.bind(d,f)),d.i.D(h,"updateend",d.Db.bind(d,f)),d.b[f]=h,d.c[f]=[])}),w(f)}})})};function ee(b,c){b.a||(b.a=new Vd(b.g));Yd(b.a,c)}
function fe(b){return b.h?"ended"==b.h.readyState:!0}function ge(b,c){if("text"==c)var d=b.a.a;else d=he(b,c),d=!d||1==d.length&&1E-6>d.end(0)-d.start(0)?null:1==d.length&&0>d.start(0)?0:d.length?d.start(0):null;return d}function ie(b,c){return"text"==c?b.a.b:qd(he(b,c))}function je(b,c,d){if("text"==c)return b=b.a,null==b.b||b.b<d?0:b.b-Math.max(d,b.a);b=he(b,c);return sd(b,d)}
m.Wc=function(b){b.total=td(this.f.buffered);b.audio=td(he(this,"audio"));b.video=td(he(this,"video"));b.text=[];if(this.a){var c=this.a.a,d=this.a.b;null!=c&&null!=d&&b.text.push({start:c,end:d})}};function he(b,c){try{return b.b[c].buffered}catch(d){return c in b.b&&B.error("failed to get buffered range for "+c,d),null}}
function ke(b,c,d,e,f,g){if("text"==c)return Zd(b.a,d,e,f);if(b.m[c])return Dd(b.m[c],d).then(function(b){this.a||ee(this,"text/vtt");b.captions&&b.captions.length&&ae(this.a,b.captions,e,f,this.b.video.timestampOffset);return le(this,c,this.oe.bind(this,c,b.data.buffer))}.bind(b));g&&window.muxjs&&(b.a||ee(b,"text/vtt"),null==e&&null==f?b.s.init(d):b.s.b(d,function(c){c.length&&ae(b.a,c,e,f,b.b.video.timestampOffset)}));return le(b,c,b.oe.bind(b,c,d))}
function me(b,c){var d=ie(b,"video")||0;$d(b.a,c,d)}m.remove=function(b,c,d){return"text"==b?this.a.remove(c,d):le(this,b,this.pe.bind(this,b,c,d))};function ne(b,c){if("text"==c){if(!b.a)return Promise.resolve();b.s.c();return b.a.remove(0,Infinity)}return le(b,c,b.pe.bind(b,c,0,b.h.duration))}m.flush=function(b){return"text"==b?Promise.resolve():le(this,b,this.Ge.bind(this,b))};
function oe(b,c,d,e,f){return"text"==c?(b.a.s=d,b=b.a,b.f=e,b.h=f,Promise.resolve()):Promise.all([le(b,c,b.ve.bind(b,c)),le(b,c,b.Xf.bind(b,c,d)),le(b,c,b.Tf.bind(b,c,e,f))])}m.endOfStream=function(b){return pe(this,function(){fe(this)||(b?this.h.endOfStream(b):this.h.endOfStream())}.bind(this))};m.Aa=function(b){return pe(this,function(){this.h.duration=b}.bind(this))};m.aa=function(){return this.h.duration};m.oe=function(b,c){this.b[b].appendBuffer(c)};
m.pe=function(b,c,d){d<=c?this.Db(b):this.b[b].remove(c,d)};m.ve=function(b){var c=this.b[b].appendWindowStart,d=this.b[b].appendWindowEnd;this.b[b].abort();this.b[b].appendWindowStart=c;this.b[b].appendWindowEnd=d;this.Db(b)};m.Ge=function(b){this.f.currentTime-=.001;this.Db(b)};m.Xf=function(b,c){0>c&&(c+=.001);this.b[b].timestampOffset=c;this.Db(b)};m.Tf=function(b,c,d){this.b[b].appendWindowStart=0;this.b[b].appendWindowEnd=d;this.b[b].appendWindowStart=c;this.Db(b)};
m.Yf=function(b){this.c[b][0].p.reject(new E(2,3,3014,this.f.error?this.f.error.code:0))};m.Db=function(b){var c=this.c[b][0];c&&(c.p.resolve(),qe(this,b))};function le(b,c,d){if(b.A)return Promise.reject();d={start:d,p:new G};b.c[c].push(d);if(1==b.c[c].length)try{d.start()}catch(e){"QuotaExceededError"==e.name?d.p.reject(new E(2,3,3017,c)):d.p.reject(new E(2,3,3015,e)),qe(b,c)}return d.p}
function pe(b,c){if(b.A)return Promise.reject();var d=[],e;for(e in b.b){var f=new G,g={start:function(b){b.resolve()}.bind(null,f),p:f};b.c[e].push(g);d.push(f);1==b.c[e].length&&g.start()}return Promise.all(d).then(function(){try{c()}catch(l){var b=Promise.reject(new E(2,3,3015,l))}for(var d in this.b)qe(this,d);return b}.bind(b),function(b){throw b;}.bind(b))}function qe(b,c){b.c[c].shift();var d=b.c[c][0];if(d)try{d.start()}catch(e){d.p.reject(new E(2,3,3015,e)),qe(b,c)}};function re(b,c){b=N(b);c=N(c);return b.split("-")[0]==c.split("-")[0]}function se(b,c){b=N(b);c=N(c);var d=b.split("-"),e=c.split("-");return d[0]==e[0]&&1==d.length&&2==e.length}function N(b){var c=b.split("-");b=c[0]||"";c=c[1]||"";b=b.toLowerCase();b=te.get(b)||b;return(c=c.toUpperCase())?b+"-"+c:b}function ue(b){return b.language?N(b.language):b.audio&&b.audio.language?N(b.audio.language):b.video&&b.video.language?N(b.video.language):"und"}
function ve(b,c){for(var d=N(b),e=new Set,f=t(c),g=f.next();!g.done;g=f.next())e.add(N(g.value));f=t(e);for(g=f.next();!g.done;g=f.next())if(g=g.value,g==d)return g;f=t(e);for(g=f.next();!g.done;g=f.next())if(g=g.value,se(g,d))return g;f=t(e);for(g=f.next();!g.done;g=f.next()){var h=g=g.value,k=d;h=N(h);k=N(k);h=h.split("-");k=k.split("-");if(2==h.length&&2==k.length&&h[0]==k[0])return g}e=t(e);for(g=e.next();!g.done;g=e.next())if(f=g.value,se(d,f))return f;return null}
var te=new Map([["aar","aa"],["abk","ab"],["afr","af"],["aka","ak"],["alb","sq"],["amh","am"],["ara","ar"],["arg","an"],["arm","hy"],["asm","as"],["ava","av"],["ave","ae"],["aym","ay"],["aze","az"],["bak","ba"],["bam","bm"],["baq","eu"],["bel","be"],["ben","bn"],["bih","bh"],["bis","bi"],["bod","bo"],["bos","bs"],["bre","br"],["bul","bg"],["bur","my"],["cat","ca"],["ces","cs"],["cha","ch"],["che","ce"],["chi","zh"],["chu","cu"],["chv","cv"],["cor","kw"],["cos","co"],["cre","cr"],["cym","cy"],["cze",
"cs"],["dan","da"],["deu","de"],["div","dv"],["dut","nl"],["dzo","dz"],["ell","el"],["eng","en"],["epo","eo"],["est","et"],["eus","eu"],["ewe","ee"],["fao","fo"],["fas","fa"],["fij","fj"],["fin","fi"],["fra","fr"],["fre","fr"],["fry","fy"],["ful","ff"],["geo","ka"],["ger","de"],["gla","gd"],["gle","ga"],["glg","gl"],["glv","gv"],["gre","el"],["grn","gn"],["guj","gu"],["hat","ht"],["hau","ha"],["heb","he"],["her","hz"],["hin","hi"],["hmo","ho"],["hrv","hr"],["hun","hu"],["hye","hy"],["ibo","ig"],["ice",
"is"],["ido","io"],["iii","ii"],["iku","iu"],["ile","ie"],["ina","ia"],["ind","id"],["ipk","ik"],["isl","is"],["ita","it"],["jav","jv"],["jpn","ja"],["kal","kl"],["kan","kn"],["kas","ks"],["kat","ka"],["kau","kr"],["kaz","kk"],["khm","km"],["kik","ki"],["kin","rw"],["kir","ky"],["kom","kv"],["kon","kg"],["kor","ko"],["kua","kj"],["kur","ku"],["lao","lo"],["lat","la"],["lav","lv"],["lim","li"],["lin","ln"],["lit","lt"],["ltz","lb"],["lub","lu"],["lug","lg"],["mac","mk"],["mah","mh"],["mal","ml"],["mao",
"mi"],["mar","mr"],["may","ms"],["mkd","mk"],["mlg","mg"],["mlt","mt"],["mon","mn"],["mri","mi"],["msa","ms"],["mya","my"],["nau","na"],["nav","nv"],["nbl","nr"],["nde","nd"],["ndo","ng"],["nep","ne"],["nld","nl"],["nno","nn"],["nob","nb"],["nor","no"],["nya","ny"],["oci","oc"],["oji","oj"],["ori","or"],["orm","om"],["oss","os"],["pan","pa"],["per","fa"],["pli","pi"],["pol","pl"],["por","pt"],["pus","ps"],["que","qu"],["roh","rm"],["ron","ro"],["rum","ro"],["run","rn"],["rus","ru"],["sag","sg"],["san",
"sa"],["sin","si"],["slk","sk"],["slo","sk"],["slv","sl"],["sme","se"],["smo","sm"],["sna","sn"],["snd","sd"],["som","so"],["sot","st"],["spa","es"],["sqi","sq"],["srd","sc"],["srp","sr"],["ssw","ss"],["sun","su"],["swa","sw"],["swe","sv"],["tah","ty"],["tam","ta"],["tat","tt"],["tel","te"],["tgk","tg"],["tgl","tl"],["tha","th"],["tib","bo"],["tir","ti"],["ton","to"],["tsn","tn"],["tso","ts"],["tuk","tk"],["tur","tr"],["twi","tw"],["uig","ug"],["ukr","uk"],["urd","ur"],["uzb","uz"],["ven","ve"],["vie",
"vi"],["vol","vo"],["wel","cy"],["wln","wa"],["wol","wo"],["xho","xh"],["yid","yi"],["yor","yo"],["zha","za"],["zho","zh"],["zul","zu"]]);var O={Jd:function(b,c){function d(b){var c="";b.video&&(c=qc(b.video.codecs)[0]);var d="";b.audio&&(d=qc(b.audio.codecs)[0]);return c+"-"+d}var e=b.periods.reduce(function(b,c){return b.concat(c.variants)},[]);e=O.Od(e,c);var f=new Ib;e=t(e);for(var g=e.next();!g.done;g=e.next()){g=g.value;var h=d(g);f.push(h,g)}var k=null,l=Infinity;f.forEach(function(b,c){for(var d=0,e=0,f=t(c),g=f.next();!g.done;g=f.next())d+=g.value.bandwidth||0,++e;d/=e;B.debug("codecs",b,"avg bandwidth",d);d<l&&(k=b,l=d)});
f=t(b.periods);for(e=f.next();!e.done;e=f.next())e=e.value,e.variants=e.variants.filter(function(b){if(d(b)==k)return!0;B.debug("Dropping Variant (better codec available)",b);return!1})},ed:function(b,c,d){function e(b,c,d){return b>=c&&b<=d}var f=b.video;return f&&f.width&&f.height&&(!e(f.width,c.minWidth,Math.min(c.maxWidth,d.width))||!e(f.height,c.minHeight,Math.min(c.maxHeight,d.height))||!e(f.width*f.height,c.minPixels,c.maxPixels))||b&&b.video&&b.video.frameRate&&!e(b.video.frameRate,c.minFrameRate,
c.maxFrameRate)||!e(b.bandwidth,c.minBandwidth,c.maxBandwidth)?!1:!0},Gd:function(b,c,d){var e=!1;b.forEach(function(b){var f=b.allowedByApplication;b.allowedByApplication=O.ed(b,c,d);f!=b.allowedByApplication&&(e=!0)});return e},filterNewPeriod:function(b,c,d,e){e.variants=e.variants.filter(function(e){if(b&&b.W&&!md(b,e))return B.debug("Dropping variant - not compatible with key system",e),!1;var f=e.audio;e=e.video;return f&&!de(f)?(B.debug("Dropping variant - audio not compatible with platform",
O.vb(f)),!1):e&&!de(e)?(B.debug("Dropping variant - video not compatible with platform",O.vb(e)),!1):f&&c&&!O.Hd(f,c)?(B.debug("Droping variant - not compatible with active audio","active audio",O.vb(c),"variant.audio",O.vb(f)),!1):e&&d&&!O.Hd(e,d)?(B.debug("Droping variant - not compatible with active video","active video",O.vb(d),"variant.video",O.vb(e)),!1):!0});e.textStreams=e.textStreams.filter(function(b){var c=Xd(nc(b.mimeType,b.codecs));c||B.debug("Dropping text stream. Is not supported by the platform.",
b);return c})},Hd:function(b,c){return b.mimeType!=c.mimeType||b.codecs.split(".")[0]!=c.codecs.split(".")[0]?!1:!0},Ed:function(b){var c=b.audio,d=b.video,e=c?c.codecs:null,f=d?d.codecs:null,g=[];f&&g.push(f);e&&g.push(e);var h=[];d&&h.push(d.mimeType);c&&h.push(c.mimeType);h=h[0]||null;var k=[];c&&k.push(c.kind);d&&k.push(d.kind);k=k[0]||null;var l=new Set;c&&c.roles.forEach(function(b){return l.add(b)});d&&d.roles.forEach(function(b){return l.add(b)});b={id:b.id,active:!1,type:"variant",bandwidth:b.bandwidth,
language:b.language,label:null,kind:k,width:null,height:null,frameRate:null,pixelAspectRatio:null,mimeType:h,codecs:g.join(", "),audioCodec:e,videoCodec:f,primary:b.primary,roles:Array.from(l),audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null};d&&(b.videoId=d.id,b.originalVideoId=d.originalId,b.width=d.width||null,b.height=d.height||null,b.frameRate=d.frameRate||
null,b.pixelAspectRatio=d.pixelAspectRatio||null,b.videoBandwidth=d.bandwidth||null);c&&(b.audioId=c.id,b.originalAudioId=c.originalId,b.channelsCount=c.channelsCount,b.audioSamplingRate=c.audioSamplingRate,b.audioBandwidth=c.bandwidth||null,b.label=c.label,b.audioRoles=c.roles);return b},Bc:function(b){return{id:b.id,active:!1,type:"text",bandwidth:0,language:b.language,label:b.label,kind:b.kind||null,width:null,height:null,frameRate:null,pixelAspectRatio:null,mimeType:b.mimeType,codecs:b.codecs||
null,audioCodec:null,videoCodec:null,primary:b.primary,roles:b.roles,audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:b.originalId}},$c:function(b){b.__shaka_id||(b.__shaka_id=O.lf++);return b.__shaka_id},lf:0,ff:function(b){var c=O.Ud(b);c.active="disabled"!=b.mode;c.type="text";c.originalTextId=b.id;"captions"==b.kind&&(c.mimeType="application/cea-608");b.kind&&(c.roles=
[b.kind]);return c},Td:function(b){var c=O.Ud(b);c.active=b.enabled;c.type="variant";c.originalAudioId=b.id;"main"==b.kind&&(c.primary=!0);b.kind&&(c.roles=[b.kind],c.audioRoles=[b.kind]);return c},Ud:function(b){return{id:O.$c(b),active:!1,type:"",bandwidth:0,language:N(b.language),label:b.label,kind:b.kind,width:null,height:null,frameRate:null,pixelAspectRatio:null,mimeType:null,codecs:null,audioCodec:null,videoCodec:null,primary:!1,roles:[],audioRoles:null,videoId:null,audioId:null,channelsCount:null,
audioSamplingRate:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null}},yb:function(b){return b.allowedByApplication&&b.allowedByKeySystem},We:function(b){return b.filter(function(b){return O.yb(b)})},Od:function(b,c){var d=b.filter(function(b){return b.audio&&b.audio.channelsCount}),e=new Map;d=t(d);for(var f=d.next();!f.done;f=d.next()){f=f.value;var g=f.audio.channelsCount;e.has(g)||e.set(g,[]);e.get(g).push(f)}d=Array.from(e.keys());if(0==
d.length)return b;f=d.filter(function(b){return b<=c});return f.length?e.get(Math.max.apply(null,f)):e.get(Math.min.apply(null,d))},Ob:function(b,c,d){var e=b,f=b.filter(function(b){return b.primary});f.length&&(e=f);var g=e.length?e[0].language:"";e=e.filter(function(b){return b.language==g});if(c){var h=ve(N(c),b.map(function(b){return b.language}));h&&(e=b.filter(function(b){return N(b.language)==h}))}if(d){b=O.Nd(e,d);if(b.length)return b;B.l("No exact match for the text role could be found.")}else if(b=
e.filter(function(b){return 0==b.roles.length}),b.length)return b;b=e.map(function(b){return b.roles}).reduce(vd.Kc,[]);return b.length?O.Nd(e,b[0]):e},Nd:function(b,c){return b.filter(function(b){return b.roles.includes(c)})},Rd:function(b,c,d){for(var e=0;e<d.length;e++)if(d[e].audio==b&&d[e].video==c)return d[e];return null},gf:function(b){return"audio"==b.type},jf:function(b){return"video"==b.type},df:function(b){var c=[];b.audio&&c.push(b.audio);b.video&&c.push(b.video);return c},vb:function(b){return O.gf(b)?
"type=audio codecs="+b.codecs+" bandwidth="+b.bandwidth+" channelsCount="+b.channelsCount+" audioSamplingRate="+b.audioSamplingRate:O.jf(b)?"type=video codecs="+b.codecs+" bandwidth="+b.bandwidth+" frameRate="+b.frameRate+" width="+b.width+" height="+b.height:"unexpected stream type"}};function Q(){this.h=null;this.c=!1;this.b=new db;this.g=[];this.i=!1;this.a=this.f=null}A("shaka.abr.SimpleAbrManager",Q);Q.prototype.stop=function(){this.h=null;this.c=!1;this.g=[];this.f=null};Q.prototype.stop=Q.prototype.stop;Q.prototype.init=function(b){this.h=b};Q.prototype.init=Q.prototype.init;
Q.prototype.chooseVariant=function(){var b=we(this.a.restrictions,this.g),c=this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate);this.g.length&&!b.length&&(B.l("No variants met the ABR restrictions. Choosing a variant by lowest bandwidth."),b=we(null,this.g),b=[b[0]]);for(var d=b[0]||null,e=0;e<b.length;++e){var f=b[e],g=f.bandwidth/this.a.bandwidthDowngradeTarget,h=(b[e+1]||{bandwidth:Infinity}).bandwidth/this.a.bandwidthUpgradeTarget;B.I("Bandwidth ranges:",(f.bandwidth/1E6).toFixed(3),
(g/1E6).toFixed(3),(h/1E6).toFixed(3));c>=g&&c<=h&&(d=f)}this.f=Date.now();return d};Q.prototype.chooseVariant=Q.prototype.chooseVariant;Q.prototype.enable=function(){this.c=!0};Q.prototype.enable=Q.prototype.enable;Q.prototype.disable=function(){this.c=!1};Q.prototype.disable=Q.prototype.disable;
Q.prototype.segmentDownloaded=function(b,c){B.I("Segment downloaded:","deltaTimeMs="+b,"numBytes="+c,"lastTimeChosenMs="+this.f,"enabled="+this.c);var d=this.b;if(!(16E3>c)){var e=8E3*c/b,f=b/1E3;d.a+=c;bb(d.b,f,e);bb(d.c,f,e)}if(null!=this.f&&this.c)a:{B.I("Suggesting Streams...");if(!this.i){if(!(128E3<=this.b.a)){B.I("Still waiting for a good estimate...");break a}this.i=!0}else if(Date.now()-this.f<1E3*this.a.switchInterval){B.I("Still within switch interval...");break a}d=this.chooseVariant();
e=this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate);B.debug("Calling switch_(), bandwidth="+Math.round(e/1E3)+" kbps");this.h(d)}};Q.prototype.segmentDownloaded=Q.prototype.segmentDownloaded;Q.prototype.getBandwidthEstimate=function(){return this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate)};Q.prototype.getBandwidthEstimate=Q.prototype.getBandwidthEstimate;Q.prototype.setVariants=function(b){this.g=b};Q.prototype.setVariants=Q.prototype.setVariants;
Q.prototype.configure=function(b){this.a=b};Q.prototype.configure=Q.prototype.configure;function we(b,c){b&&(c=c.filter(function(c){return O.ed(c,b,{width:Infinity,height:Infinity})}));return c.sort(function(b,c){return b.bandwidth-c.bandwidth})};function R(b,c){this.M=b;this.b=c==xe;this.a=0}A("shaka.util.DataViewReader",R);var xe=1;R.Endianness={ig:0,kg:xe};R.prototype.xa=function(){return this.a<this.M.byteLength};R.prototype.hasMoreData=R.prototype.xa;R.prototype.fa=function(){return this.a};R.prototype.getPosition=R.prototype.fa;R.prototype.Ne=function(){return this.M.byteLength};R.prototype.getLength=R.prototype.Ne;R.prototype.ma=function(){try{var b=this.M.getUint8(this.a);this.a+=1;return b}catch(c){ye()}};R.prototype.readUint8=R.prototype.ma;
R.prototype.Wb=function(){try{var b=this.M.getUint16(this.a,this.b);this.a+=2;return b}catch(c){ye()}};R.prototype.readUint16=R.prototype.Wb;R.prototype.G=function(){try{var b=this.M.getUint32(this.a,this.b);this.a+=4;return b}catch(c){ye()}};R.prototype.readUint32=R.prototype.G;R.prototype.je=function(){try{var b=this.M.getInt32(this.a,this.b);this.a+=4;return b}catch(c){ye()}};R.prototype.readInt32=R.prototype.je;
R.prototype.Hb=function(){try{if(this.b){var b=this.M.getUint32(this.a,!0);var c=this.M.getUint32(this.a+4,!0)}else c=this.M.getUint32(this.a,!1),b=this.M.getUint32(this.a+4,!1)}catch(d){ye()}if(2097151<c)throw new E(2,3,3001);this.a+=8;return c*Math.pow(2,32)+b};R.prototype.readUint64=R.prototype.Hb;R.prototype.eb=function(b){this.a+b>this.M.byteLength&&ye();var c=new Uint8Array(this.M.buffer,this.M.byteOffset+this.a,b);this.a+=b;return c};R.prototype.readBytes=R.prototype.eb;
R.prototype.P=function(b){this.a+b>this.M.byteLength&&ye();this.a+=b};R.prototype.skip=R.prototype.P;R.prototype.ke=function(b){this.a<b&&ye();this.a-=b};R.prototype.rewind=R.prototype.ke;R.prototype.seek=function(b){(0>b||b>this.M.byteLength)&&ye();this.a=b};R.prototype.seek=R.prototype.seek;R.prototype.od=function(){for(var b=this.a;this.xa()&&0!=this.M.getUint8(this.a);)this.a+=1;b=new Uint8Array(this.M.buffer,this.M.byteOffset+b,this.a-b);this.a+=1;return Bc(b)};
R.prototype.readTerminatedString=R.prototype.od;function ye(){throw new E(2,3,3E3);};function S(){this.c=[];this.b=[];this.a=!1}A("shaka.util.Mp4Parser",S);S.prototype.J=function(b,c){var d=ze(b);this.c[d]=0;this.b[d]=c;return this};S.prototype.box=S.prototype.J;S.prototype.ha=function(b,c){var d=ze(b);this.c[d]=1;this.b[d]=c;return this};S.prototype.fullBox=S.prototype.ha;S.prototype.stop=function(){this.a=!0};S.prototype.stop=S.prototype.stop;
S.prototype.parse=function(b,c){var d=new Uint8Array(b);d=new R(new DataView(d.buffer,d.byteOffset,d.byteLength),0);for(this.a=!1;d.xa()&&!this.a;)this.wc(0,d,c)};S.prototype.parse=S.prototype.parse;
S.prototype.wc=function(b,c,d){var e=c.fa(),f=c.G(),g=c.G();B.I("Parsing MP4 box",Ae(g));switch(f){case 0:f=c.M.byteLength-e;break;case 1:f=c.Hb()}var h=this.b[g];if(h){var k=null,l=null;1==this.c[g]&&(l=c.G(),k=l>>>24,l&=16777215);g=e+f;d&&g>c.M.byteLength&&(g=c.M.byteLength);g-=c.fa();c=0<g?c.eb(g):new Uint8Array(0);c=new R(new DataView(c.buffer,c.byteOffset,c.byteLength),0);h({parser:this,partialOkay:d||!1,version:k,flags:l,reader:c,size:f,start:e+b})}else c.P(Math.min(e+f-c.fa(),c.M.byteLength-
c.fa()))};S.prototype.parseNext=S.prototype.wc;function Be(b){for(var c=null!=b.flags?12:8;b.reader.xa()&&!b.parser.a;)b.parser.wc(b.start+c,b.reader,b.partialOkay)}S.children=Be;function Ce(b){for(var c=null!=b.flags?12:8,d=b.reader.G();0<d&&!b.parser.a;--d)b.parser.wc(b.start+c,b.reader,b.partialOkay)}S.sampleDescription=Ce;function De(b){return function(c){b(c.reader.eb(c.reader.M.byteLength-c.reader.fa()))}}S.allData=De;
function ze(b){for(var c=0,d=0;d<b.length;d++)c=c<<8|b.charCodeAt(d);return c}function Ae(b){return String.fromCharCode(b>>24&255,b>>16&255,b>>8&255,b&255)}S.typeToString=Ae;function Ee(b){var c=this;this.a=[];this.b=[];this.data=[];(new S).J("moov",Be).ha("pssh",function(b){if(1<b.version)B.l("Unrecognized PSSH version found!");else{var d=b.reader.M;d=new Uint8Array(d.buffer,d.byteOffset-12,b.size);c.data.push(d);c.a.push(M.Dc(b.reader.eb(16)));if(0<b.version){d=b.reader.G();for(var f=0;f<d;++f){var g=M.Dc(b.reader.eb(16));c.b.push(g)}}}}).parse(b);0==this.data.length&&B.l("No pssh box found!")}
function Fe(b){if(!b)return b;var c=new Ee(b);if(1>=c.data.length)return b;b=[];var d={};c=t(c.data);for(var e=c.next();!e.done;d={pc:d.pc},e=c.next())d.pc=e.value,b.some(function(b){return function(c){return M.Ka(c,b.pc)}}(d))||b.push(d.pc);return M.concat.apply(M,b instanceof Array?b:Qa(t(b)))};var T={kc:function(b,c){var d=T.S(b,c);return 1!=d.length?null:d[0]},Sc:function(b,c,d){b=T.Pd(b,c,d);return 1!=b.length?null:b[0]},S:function(b,c){return Array.prototype.filter.call(b.childNodes,function(b){return b instanceof Element&&b.tagName==c})},Pd:function(b,c,d){return Array.prototype.filter.call(b.childNodes,function(b){return b instanceof Element&&b.localName==d&&b.namespaceURI==c})},getAttributeNS:function(b,c,d){return b.hasAttributeNS(c,d)?b.getAttributeNS(c,d):null},lc:function(b){return Array.prototype.every.call(b.childNodes,
function(b){return b.nodeType==Node.TEXT_NODE||b.nodeType==Node.CDATA_SECTION_NODE})?b.textContent.trim():null},L:function(b,c,d,e){e=void 0===e?null:e;var f=null;b=b.getAttribute(c);null!=b&&(f=d(b));return null==f?e:f},Cf:function(b){if(!b)return null;/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(b)&&(b+="Z");b=Date.parse(b);return isNaN(b)?null:Math.floor(b/1E3)},Ga:function(b){if(!b)return null;var c=/^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$/.exec(b);
if(!c)return B.l("Invalid duration string:",b),null;b=31536E3*Number(c[1]||null)+2592E3*Number(c[2]||null)+86400*Number(c[3]||null)+3600*Number(c[4]||null)+60*Number(c[5]||null)+Number(c[6]||null);return isFinite(b)?b:null},yc:function(b){var c=/([0-9]+)-([0-9]+)/.exec(b);if(!c)return null;b=Number(c[1]);if(!isFinite(b))return null;c=Number(c[2]);return isFinite(c)?{start:b,end:c}:null},parseInt:function(b){b=Number(b);return 0===b%1?b:null},xc:function(b){b=Number(b);return 0===b%1&&0<b?b:null},
Eb:function(b){b=Number(b);return 0===b%1&&0<=b?b:null},parseFloat:function(b){b=Number(b);return isNaN(b)?null:b},Ee:function(b){var c;b=(c=b.match(/^(\d+)\/(\d+)$/))?Number(c[1])/Number(c[2]):Number(b);return isNaN(b)?null:b},ie:function(b,c){var d=new DOMParser;try{var e=d.parseFromString(b,"text/xml")}catch(g){}if(e&&e.documentElement.tagName==c)var f=e.documentElement;return f&&0<f.getElementsByTagName("parsererror").length?null:f},he:function(b,c){try{var d=Bc(b);return T.ie(d,c)}catch(e){}}};var Ge=(new Map).set("urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b","org.w3.clearkey").set("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed","com.widevine.alpha").set("urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95","com.microsoft.playready").set("urn:uuid:79f0049a-4098-8642-ab92-e65be0885f95","com.microsoft.playready").set("urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb","com.adobe.primetime");
function He(b,c,d){var e=Ie(b),f=null;b=[];var g=[],h=new Set(e.map(function(b){return b.keyId}));h["delete"](null);if(1<h.size)throw new E(2,4,4010);d||(g=e.filter(function(b){return"urn:mpeg:dash:mp4protection:2011"==b.le?(f=b.init||f,!1):!0}),g.length&&(b=Je(f,c,g),0==b.length&&(b=[xd("",f)])));if(e.length&&(d||!g.length))for(b=[],c=t(Ge.values()),d=c.next();!d.done;d=c.next())d=d.value,"org.w3.clearkey"!=d&&b.push(xd(d,f));if(h=Array.from(h)[0]||null)for(c=t(b),d=c.next();!d.done;d=c.next())for(d=
t(d.value.initData),e=d.next();!e.done;e=d.next())e.value.keyId=h;return{Ld:h,mg:f,drmInfos:b,Qd:!0}}function Ke(b,c,d,e){var f=He(b,c,e);if(d.Qd){b=1==d.drmInfos.length&&!d.drmInfos[0].keySystem;c=0==f.drmInfos.length;if(0==d.drmInfos.length||b&&!c)d.drmInfos=f.drmInfos;d.Qd=!1}else if(0<f.drmInfos.length&&(d.drmInfos=d.drmInfos.filter(function(b){return f.drmInfos.some(function(c){return c.keySystem==b.keySystem})}),0==d.drmInfos.length))throw new E(2,4,4008);return f.Ld||d.Ld}
function Le(b){var c=0,d=(new DataView(b)).getUint32(c,!0);c+=4;if(d!==b.byteLength)return B.l("PlayReady Object with invalid length encountered."),[];c+=2;d=[];for(var e=new DataView(b);c<b.byteLength-1;){var f=e.getUint16(c,!0);c+=2;var g=e.getUint16(c,!0);c+=2;var h=new Uint8Array(b,c,g);d.push({type:f,value:h});c+=g}return d}
function Me(b){b=t(b.getElementsByTagName("DATA"));for(var c=b.next();!c.done;c=b.next()){c=t(c.value.childNodes);for(var d=c.next();!d.done;d=c.next())if(d=d.value,d instanceof Element&&"LA_URL"==d.tagName)return d.textContent}return""}
function Je(b,c,d){var e=[];d=t(d);for(var f=d.next();!f.done;f=d.next()){f=f.value;var g=Ge.get(f.le);if(g){var h;if(h=T.Sc(f.node,"urn:microsoft:playready","pro")){h=M.Da(h.textContent);var k=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),l=h.length,n=k.length+16+l,p=new ArrayBuffer(n),q=new Uint8Array(p);p=new DataView(p);var r=0;p.setUint32(r,n);r+=4;p.setUint32(r,1886614376);r+=4;p.setUint32(r,0);r+=4;q.set(k,r);r+=k.length;p.setUint32(r,l);r+=4;q.set(h,r);h=[{initData:q,
initDataType:"cenc",keyId:f.keyId}]}else h=null;h=xd(g,f.init||b||h);if(g=Ne.get(g))h.licenseServerUri=g(f);e.push(h)}else for(f=c(f.node)||[],f=t(f),g=f.next();!g.done;g=f.next())e.push(g.value)}return e}
var Ne=(new Map).set("com.widevine.alpha",function(b){return(b=T.Sc(b.node,"urn:microsoft","laurl"))?b.getAttribute("licenseUrl")||"":""}).set("com.microsoft.playready",function(b){b=T.Sc(b.node,"urn:microsoft:playready","pro");if(!b)return"";b=M.Da(b.textContent);b=Le(b.buffer).filter(function(b){return 1===b.type})[0];if(!b)return"";b=Dc(b.value,!0);return(b=T.ie(b,"WRMHEADER"))?Me(b):""});function Ie(b){var c=[];b=t(b);for(var d=b.next();!d.done;d=b.next())(d=Oe(d.value))&&c.push(d);return c}
function Oe(b){var c=b.getAttribute("schemeIdUri"),d=T.getAttributeNS(b,"urn:mpeg:cenc:2013","default_KID"),e=T.Pd(b,"urn:mpeg:cenc:2013","pssh").map(T.lc);if(!c)return B.error("Missing required schemeIdUri attribute on","ContentProtection element",b),null;c=c.toLowerCase();if(d&&(d=d.replace(/-/g,"").toLowerCase(),d.includes(" ")))throw new E(2,4,4009);var f=[];try{f=e.map(function(b){return{initDataType:"cenc",initData:M.Da(b),keyId:null}})}catch(g){throw new E(2,4,4007);}return{node:b,le:c,keyId:d,
init:0<f.length?f:null}};function Pe(b,c,d,e,f){var g={RepresentationID:c,Number:d,Bandwidth:e,Time:f};return b.replace(/\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)([diouxX]))?\$/g,function(c,d,e,f){if("$$"==c)return"$";var h=g[d];if(null==h)return B.l("URL template does not have an available substitution for identifier",'"'+d+'":',b),c;"RepresentationID"==d&&e&&(B.l("URL template should not contain a width specifier for identifier",'"RepresentationID":',b),e=void 0);"Time"==d&&(h=Math.round(h));switch(f){case void 0:case "d":case "i":case "u":c=
h.toString();break;case "o":c=h.toString(8);break;case "x":c=h.toString(16);break;case "X":c=h.toString(16).toUpperCase();break;default:c=h.toString()}e=window.parseInt(e,10)||1;return Array(Math.max(0,e-c.length)+1).join("0")+c})}
function Qe(b,c){var d=Re(b,c,"timescale"),e=1;d&&(e=T.xc(d)||1);d=Re(b,c,"duration");(d=T.xc(d||""))&&(d/=e);var f=Re(b,c,"startNumber"),g=Number(Re(b,c,"presentationTimeOffset"))||0,h=T.Eb(f||"");if(null==f||null==h)h=1;var k=Se(b,c,"SegmentTimeline");f=null;if(k){f=e;var l=b.T.duration||Infinity;k=T.S(k,"S");for(var n=[],p=-g,q=0;q<k.length;++q){var r=k[q],x=T.L(r,"t",T.Eb),C=T.L(r,"d",T.Eb),z=T.L(r,"r",T.parseInt);null!=x&&(x-=g);if(!C){B.l('"S" element must have a duration:','ignoring the remaining "S" elements.',
r);break}x=null!=x?x:p;z=z||0;if(0>z)if(q+1<k.length){z=T.L(k[q+1],"t",T.Eb);if(null==z){B.l('An "S" element cannot have a negative repeat','if the next "S" element does not have a valid start time:','ignoring the remaining "S" elements.',r);break}else if(x>=z){B.l('An "S" element cannot have a negative repeat','if its start time exceeds the next "S" element\'s start time:','ignoring the remaining "S" elements.',r);break}z=Math.ceil((z-x)/C)-1}else{if(Infinity==l){B.l('The last "S" element cannot have a negative repeat',
"if the Period has an infinite duration:",'ignoring the last "S" element.',r);break}else if(x/f>=l){B.l('The last "S" element cannot have a negative repeat',"if its start time exceeds the Period's duration:",'igoring the last "S" element.',r);break}z=Math.ceil((l*f-x)/C)-1}0<n.length&&x!=p&&(Math.abs((x-p)/f)>=zd&&B.l("SegmentTimeline contains a large gap/overlap:","the content may have errors in it.",r),n[n.length-1].end=x/f);for(r=0;r<=z;++r)p=x+C,n.push({start:x/f,end:p/f,eg:x}),x=p}f=n}return{timescale:e,
ba:d,fb:h,na:g/e||0,Dd:g,R:f}}function Re(b,c,d){return[c(b.w),c(b.Z),c(b.la)].filter(vd.La).map(function(b){return b.getAttribute(d)}).reduce(function(b,c){return b||c})}function Se(b,c,d){return[c(b.w),c(b.Z),c(b.la)].filter(vd.La).map(function(b){return T.kc(b,d)}).reduce(function(b,c){return b||c})}
function Te(b,c,d,e,f,g){for(var h=T.getAttributeNS(b,"http://www.w3.org/1999/xlink","href"),k=T.getAttributeNS(b,"http://www.w3.org/1999/xlink","actuate")||"onRequest",l=0;l<b.attributes.length;l++){var n=b.attributes[l];"http://www.w3.org/1999/xlink"==n.namespaceURI&&(b.removeAttributeNS(n.namespaceURI,n.localName),--l)}if(5<=g)return Cb(new E(2,4,4028));if("onLoad"!=k)return Cb(new E(2,4,4027));var p=wd([e],[h]);return f.request(0,Vb(p,c)).X(function(e){e=T.he(e.data,b.tagName);if(!e)return Cb(new E(2,
4,4001,h));for(;b.childNodes.length;)b.removeChild(b.childNodes[0]);for(;e.childNodes.length;){var k=e.childNodes[0];e.removeChild(k);b.appendChild(k)}for(k=0;k<e.attributes.length;k++){var l=e.attributes[k].nodeName,n=e.getAttribute(l);b.setAttribute(l,n)}return Ue(b,c,d,p[0],f,g+1)})}
function Ue(b,c,d,e,f,g){g=void 0===g?0:g;if(T.getAttributeNS(b,"http://www.w3.org/1999/xlink","href")){var h=Te(b,c,d,e,f,g);d&&(h=h.X(void 0,function(){return Ue(b,c,d,e,f,g)}));return h}h=[];for(var k=0;k<b.childNodes.length;k++){var l=b.childNodes[k];l instanceof Element&&("urn:mpeg:dash:resolve-to-zero:2013"==T.getAttributeNS(l,"http://www.w3.org/1999/xlink","href")?(b.removeChild(l),--k):"SegmentTimeline"!=l.tagName&&h.push(Ue(l,c,d,e,f,g)))}return Gb(h).X(function(){return b})};function Ve(b,c,d){this.c=b;this.b=c;this.a=d}A("shaka.media.InitSegmentReference",Ve);Ve.prototype.Mc=function(){return this.c()};Ve.prototype.createUris=Ve.prototype.Mc;Ve.prototype.Yc=function(){return this.b};Ve.prototype.getStartByte=Ve.prototype.Yc;Ve.prototype.Xc=function(){return this.a};Ve.prototype.getEndByte=Ve.prototype.Xc;function U(b,c,d,e,f,g){this.position=b;this.startTime=c;this.endTime=d;this.c=e;this.b=f;this.a=g}A("shaka.media.SegmentReference",U);U.prototype.fa=function(){return this.position};
U.prototype.getPosition=U.prototype.fa;U.prototype.oc=function(){return this.startTime};U.prototype.getStartTime=U.prototype.oc;U.prototype.Le=function(){return this.endTime};U.prototype.getEndTime=U.prototype.Le;U.prototype.Mc=function(){return this.c()};U.prototype.createUris=U.prototype.Mc;U.prototype.Yc=function(){return this.b};U.prototype.getStartByte=U.prototype.Yc;U.prototype.Xc=function(){return this.a};U.prototype.getEndByte=U.prototype.Xc;function We(b,c,d,e){var f,g=(new S).ha("sidx",function(b){f=Xe(c,e,d,b)});b&&g.parse(b);if(f)return f;B.error('Invalid box type, expected "sidx".');throw new E(2,3,3004);}
function Xe(b,c,d,e){var f=[];e.reader.P(4);var g=e.reader.G();if(0==g)throw B.error("Invalid timescale."),new E(2,3,3005);if(0==e.version){var h=e.reader.G();var k=e.reader.G()}else h=e.reader.Hb(),k=e.reader.Hb();e.reader.P(2);var l=e.reader.Wb();b=b+e.size+k;for(k=0;k<l;k++){var n=e.reader.G(),p=(n&2147483648)>>>31;n&=2147483647;var q=e.reader.G();e.reader.P(4);if(1==p)throw B.error("Heirarchical SIDXs are not supported."),new E(2,3,3006);f.push(new U(f.length,h/g-c,(h+q)/g-c,function(){return d},
b,b+n-1));h+=q;b+=n}e.parser.stop();return f};function V(b){this.a=b}A("shaka.media.SegmentIndex",V);V.prototype.destroy=function(){this.a=null;return Promise.resolve()};V.prototype.destroy=V.prototype.destroy;V.prototype.find=function(b){for(var c=this.a.length-1;0<=c;--c){var d=this.a[c];if(b>=d.startTime&&b<d.endTime)return d.position}return this.a.length&&b<this.a[0].startTime?this.a[0].position:null};V.prototype.find=V.prototype.find;
V.prototype.get=function(b){if(0==this.a.length)return null;b-=this.a[0].position;return 0>b||b>=this.a.length?null:this.a[b]};V.prototype.get=V.prototype.get;V.prototype.offset=function(b){for(var c=0;c<this.a.length;++c)this.a[c].startTime+=b,this.a[c].endTime+=b};V.prototype.offset=V.prototype.offset;
V.prototype.fd=function(b){for(var c=[],d=0,e=0;d<this.a.length&&e<b.length;){var f=this.a[d],g=b[e];f.startTime<g.startTime?(c.push(f),d++):(f.startTime>g.startTime?0==d?c.push(g):B.l("Refusing to rewrite original references on update!"):(.1<Math.abs(f.endTime-g.endTime)?c.push(new U(f.position,g.startTime,g.endTime,g.c,g.b,g.a)):c.push(f),d++),e++)}for(;d<this.a.length;)c.push(this.a[d++]);if(c.length)for(d=c[c.length-1].position+1;e<b.length;)f=b[e++],f=new U(d++,f.startTime,f.endTime,f.c,f.b,
f.a),c.push(f);else c=b;this.a=c};V.prototype.merge=V.prototype.fd;V.prototype.Pc=function(b){for(var c=0;c<this.a.length;++c)if(this.a[c].endTime>b){this.a.splice(0,c);return}this.a=[]};V.prototype.evict=V.prototype.Pc;function Ye(b,c){for(;b.a.length;)if(b.a[b.a.length-1].startTime>=c)b.a.pop();else break;for(;b.a.length;)if(0>=b.a[0].endTime)b.a.shift();else break;if(0!=b.a.length){var d=b.a[b.a.length-1];b.a[b.a.length-1]=new U(d.position,d.startTime,c,d.c,d.b,d.a)}};function Ze(b){this.b=b;this.a=new R(b,0);$e||($e=[new Uint8Array([255]),new Uint8Array([127,255]),new Uint8Array([63,255,255]),new Uint8Array([31,255,255,255]),new Uint8Array([15,255,255,255,255]),new Uint8Array([7,255,255,255,255,255]),new Uint8Array([3,255,255,255,255,255,255]),new Uint8Array([1,255,255,255,255,255,255,255])])}var $e;Ze.prototype.xa=function(){return this.a.xa()};
function af(b){var c=bf(b);if(7<c.length)throw new E(2,3,3002);for(var d=0,e=0;e<c.length;e++)d=256*d+c[e];c=d;d=bf(b);a:{e=M.Ka;for(var f=0;f<$e.length;f++)if(e(d,$e[f])){e=!0;break a}e=!1}if(e)d=b.b.byteLength-b.a.fa();else{if(8==d.length&&d[1]&224)throw new E(2,3,3001);e=d[0]&(1<<8-d.length)-1;for(f=1;f<d.length;f++)e=256*e+d[f];d=e}d=b.a.fa()+d<=b.b.byteLength?d:b.b.byteLength-b.a.fa();e=new DataView(b.b.buffer,b.b.byteOffset+b.a.fa(),d);b.a.P(d);return new cf(c,e)}
function bf(b){var c=b.a.ma(),d;for(d=1;8>=d&&!(c&1<<8-d);d++);if(8<d)throw new E(2,3,3002);var e=new Uint8Array(d);e[0]=c;for(c=1;c<d;c++)e[c]=b.a.ma();return e}function cf(b,c){this.id=b;this.a=c}function df(b){if(8<b.a.byteLength)throw new E(2,3,3002);if(8==b.a.byteLength&&b.a.getUint8(0)&224)throw new E(2,3,3001);for(var c=0,d=0;d<b.a.byteLength;d++){var e=b.a.getUint8(d);c=256*c+e}return c};function ef(){}
ef.prototype.parse=function(b,c,d,e){var f;c=new Ze(new DataView(c));if(440786851!=af(c).id)throw B.error("Not an EBML element."),new E(2,3,3008);var g=af(c);if(408125543!=g.id)throw B.error("Not a Segment element."),new E(2,3,3009);c=g.a.byteOffset;g=new Ze(g.a);for(f=null;g.xa();){var h=af(g);if(357149030==h.id){f=h;break}}if(!f)throw B.error("Not an Info element."),new E(2,3,3010);g=new Ze(f.a);f=1E6;for(h=null;g.xa();){var k=af(g);if(2807729==k.id)f=df(k);else if(17545==k.id)if(h=k,4==h.a.byteLength)h=
h.a.getFloat32(0);else if(8==h.a.byteLength)h=h.a.getFloat64(0);else throw new E(2,3,3003);}if(null==h)throw new E(2,3,3011);g=f/1E9;f=h*g;b=af(new Ze(new DataView(b)));if(475249515!=b.id)throw B.error("Not a Cues element."),new E(2,3,3007);return ff(b,c,g,f,d,e)};
function ff(b,c,d,e,f,g){function h(){return f}var k=[];b=new Ze(b.a);for(var l=null,n=null;b.xa();){var p=af(b);if(187==p.id){var q=gf(p);q&&(p=d*q.fg,q=c+q.Jf,null!=l&&k.push(new U(k.length,l-g,p-g,h,n,q-1)),l=p,n=q)}}null!=l&&k.push(new U(k.length,l-g,e-g,h,n,null));return k}
function gf(b){var c=new Ze(b.a);b=af(c);if(179!=b.id)throw B.l("Not a CueTime element."),new E(2,3,3013);b=df(b);c=af(c);if(183!=c.id)throw B.l("Not a CueTrackPositions element."),new E(2,3,3012);c=new Ze(c.a);for(var d=0;c.xa();){var e=af(c);if(241==e.id){d=df(e);break}}return{fg:b,Jf:d}};function hf(b,c){var d=Se(b,c,"Initialization");if(!d)return null;var e=b.w.sa,f=d.getAttribute("sourceURL");f&&(e=wd(b.w.sa,[f]));f=0;var g=null;if(d=T.L(d,"range",T.yc))f=d.start,g=d.end;return new Ve(function(){return e},f,g)}
function jf(b,c){var d=Number(Re(b,kf,"presentationTimeOffset"))||0,e=Re(b,kf,"timescale"),f=1;e&&(f=T.xc(e)||1);d=d/f||0;e=hf(b,kf);var g=b.w.contentType;f=b.w.mimeType.split("/")[1];if("text"!=g&&"mp4"!=f&&"webm"!=f)throw B.error("SegmentBase specifies an unsupported container type.",b.w),new E(2,4,4006);if("webm"==f&&!e)throw B.error("SegmentBase does not contain sufficient segment information:","the SegmentBase uses a WebM container,","but does not contain an Initialization element.",b.w),new E(2,
4,4005);g=Se(b,kf,"RepresentationIndex");var h=Re(b,kf,"indexRange"),k=b.w.sa;h=T.yc(h||"");if(g){var l=g.getAttribute("sourceURL");l&&(k=wd(b.w.sa,[l]));h=T.L(g,"range",T.yc,h)}if(!h)throw B.error("SegmentBase does not contain sufficient segment information:","the SegmentBase does not contain @indexRange","or a RepresentationIndex element.",b.w),new E(2,4,4002);f=lf(b,c,e,k,h.start,h.end,f,d);return{createSegmentIndex:f.createSegmentIndex,findSegmentPosition:f.findSegmentPosition,getSegmentReference:f.getSegmentReference,
initSegmentReference:e,na:d}}function lf(b,c,d,e,f,g,h,k){var l=b.presentationTimeline,n=!b.rb||!b.T.bd,p=b.T.start,q=b.T.duration,r=c,x=null;return{createSegmentIndex:function(){var b=[r(e,f,g),"webm"==h?r(d.c(),d.b,d.a):null];r=null;return Promise.all(b).then(function(b){var c=b[0];b=b[1]||null;c="mp4"==h?We(c,f,e,k):(new ef).parse(c,b,e,k);l.Bb(c,p);x=new V(c);n&&Ye(x,q)})},findSegmentPosition:function(b){return x.find(b)},getSegmentReference:function(b){return x.get(b)}}}
function kf(b){return b.Yb};function mf(b,c){var d=hf(b,nf);var e=of(b);var f=Qe(b,nf),g=f.fb;0==g&&(B.l("SegmentList@startNumber must be > 0"),g=1);var h=0;f.ba?h=f.ba*(g-1):f.R&&0<f.R.length&&(h=f.R[0].start);e={ba:f.ba,startTime:h,fb:g,na:f.na,R:f.R,bb:e};if(!e.ba&&!e.R&&1<e.bb.length)throw B.l("SegmentList does not contain sufficient segment information:","the SegmentList specifies multiple segments,","but does not specify a segment duration or timeline.",b.w),new E(2,4,4002);if(!e.ba&&!b.T.duration&&!e.R&&1==e.bb.length)throw B.l("SegmentList does not contain sufficient segment information:",
"the SegmentList specifies one segment,","but does not specify a segment duration, period duration,","or timeline.",b.w),new E(2,4,4002);if(e.R&&0==e.R.length)throw B.l("SegmentList does not contain sufficient segment information:","the SegmentList has an empty timeline.",b.w),new E(2,4,4002);g=f=null;b.la.id&&b.w.id&&(g=b.la.id+","+b.w.id,f=c[g]);h=pf(b.T.duration,e.fb,b.w.sa,e);f?(f.fd(h),f.Pc(b.presentationTimeline.Rb()-b.T.start)):(b.presentationTimeline.Bb(h,b.T.start),f=new V(h),g&&b.rb&&(c[g]=
f));b.rb&&b.T.bd||Ye(f,b.T.duration);return{createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:f.find.bind(f),getSegmentReference:f.get.bind(f),initSegmentReference:d,na:e.na}}function nf(b){return b.Oa}
function pf(b,c,d,e){var f=e.bb.length;e.R&&e.R.length!=e.bb.length&&(f=Math.min(e.R.length,e.bb.length),B.l("The number of items in the segment timeline and the number of segment","URLs do not match, truncating",e.bb.length,"to",f));for(var g=[],h=e.startTime,k=0;k<f;k++){var l=e.bb[k],n=wd(d,[l.kf]),p=void 0;p=null!=e.ba?h+e.ba:e.R?e.R[k].end:h+b;g.push(new U(k+c,h,p,function(b){return b}.bind(null,n),l.start,l.end));h=p}return g}
function of(b){return[b.w.Oa,b.Z.Oa,b.la.Oa].filter(vd.La).map(function(b){return T.S(b,"SegmentURL")}).reduce(function(b,d){return 0<b.length?b:d}).map(function(c){c.getAttribute("indexRange")&&!b.Xd&&(b.Xd=!0,B.l("We do not support the SegmentURL@indexRange attribute on SegmentList.  We only use the SegmentList@duration attribute or SegmentTimeline, which must be accurate."));var d=c.getAttribute("media");c=T.L(c,"mediaRange",T.yc,{start:0,end:null});return{kf:d,start:c.start,end:c.end}})};function qf(b,c,d,e){var f=rf(b);var g=Qe(b,sf);var h=Re(b,sf,"media"),k=Re(b,sf,"index");g={ba:g.ba,timescale:g.timescale,fb:g.fb,na:g.na,Dd:g.Dd,R:g.R,dd:h,Tb:k};h=g.Tb?1:0;h+=g.R?1:0;h+=g.ba?1:0;if(0==h)throw B.error("SegmentTemplate does not contain any segment information:","the SegmentTemplate must contain either an index URL template","a SegmentTimeline, or a segment duration.",b.w),new E(2,4,4002);1!=h&&(B.l("SegmentTemplate containes multiple segment information sources:","the SegmentTemplate should only contain an index URL template,",
"a SegmentTimeline or a segment duration.",b.w),g.Tb?(B.info("Using the index URL template by default."),g.R=null):B.info("Using the SegmentTimeline by default."),g.ba=null);if(!g.Tb&&!g.dd)throw B.error("SegmentTemplate does not contain sufficient segment information:","the SegmentTemplate's media URL template is missing.",b.w),new E(2,4,4002);if(g.Tb){d=b.w.mimeType.split("/")[1];if("mp4"!=d&&"webm"!=d)throw B.error("SegmentTemplate specifies an unsupported container type.",b.w),new E(2,4,4006);
if("webm"==d&&!f)throw B.error("SegmentTemplate does not contain sufficient segment information:","the SegmentTemplate uses a WebM container,","but does not contain an initialization URL template.",b.w),new E(2,4,4005);e=Pe(g.Tb,b.w.id,null,b.bandwidth||null,null);e=wd(b.w.sa,[e]);b=lf(b,c,f,e,0,null,d,g.na)}else g.ba?(e||(b.presentationTimeline.hd(g.ba),b.presentationTimeline.jd(b.T.start)),b=tf(b,g)):(e=c=null,b.la.id&&b.w.id&&(e=b.la.id+","+b.w.id,c=d[e]),h=uf(b,g),k=!b.rb||!b.T.bd,c?(k&&Ye(new V(h),
b.T.duration),c.fd(h),c.Pc(b.presentationTimeline.Rb()-b.T.start)):(b.presentationTimeline.Bb(h,b.T.start),c=new V(h),e&&b.rb&&(d[e]=c)),k&&Ye(c,b.T.duration),b={createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:c.find.bind(c),getSegmentReference:c.get.bind(c)});return{createSegmentIndex:b.createSegmentIndex,findSegmentPosition:b.findSegmentPosition,getSegmentReference:b.getSegmentReference,initSegmentReference:f,na:g.na}}function sf(b){return b.$b}
function tf(b,c){var d=b.T.duration,e=c.ba,f=c.fb,g=c.timescale,h=c.dd,k=b.bandwidth||null,l=b.w.id,n=b.w.sa;return{createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(b){return 0>b||d&&b>=d?null:Math.floor(b/e)},getSegmentReference:function(b){var c=b*e,p=c+e;d&&(p=Math.min(p,d));return 0>p||d&&c>=d?null:new U(b,c,p,function(){var d=Pe(h,l,b+f,k,c*g);return wd(n,[d])},0,null)}}}
function uf(b,c){for(var d=[],e=0;e<c.R.length;e++){var f=e+c.fb;d.push(new U(f,c.R[e].start,c.R[e].end,function(b,c,d,e,f,p){b=Pe(b,c,f,d,p);return wd(e,[b]).map(function(b){return b.toString()})}.bind(null,c.dd,b.w.id,b.bandwidth||null,b.w.sa,f,c.R[e].eg+c.Dd),0,null))}return d}function rf(b){var c=Re(b,sf,"initialization");if(!c)return null;var d=b.w.id,e=b.bandwidth||null,f=b.w.sa;return new Ve(function(){var b=Pe(c,d,null,e,null);return wd(f,[b])},0,null)};var W={Fb:{},Vb:{},qd:function(b,c){W.Vb[b]=c}};A("shaka.media.ManifestParser.registerParserByExtension",W.qd);W.Ib=function(b,c){W.Fb[b]=c};A("shaka.media.ManifestParser.registerParserByMime",W.Ib);
W.Gf=function(){var b={};if(rc()){for(var c in W.Fb)b[c]=!0;for(var d in W.Vb)b[d]=!0}c={mpd:"application/dash+xml",m3u8:"application/x-mpegurl",ism:"application/vnd.ms-sstr+xml"};d=t(["application/dash+xml","application/x-mpegurl","application/vnd.apple.mpegurl","application/vnd.ms-sstr+xml"]);for(var e=d.next();!e.done;e=d.next())e=e.value,b[e]=rc()?!!W.Fb[e]:sc(e);for(var f in c)b[f]=rc()?!!W.Vb[f]:sc(c[f]);return b};
W.create=function(b,c,d,e){return u(function g(){var h,k;return y(g,function(g){switch(g.j){case 1:return Da(g,2),v(g,W.Me(b,c,d,e),4);case 4:return h=g.o,g["return"](new h);case 2:throw k=Ga(g),k.severity=2,k;}})})};
W.Me=function(b,c,d,e){return u(function g(){var h,k,l,n,p;return y(g,function(g){switch(g.j){case 1:h=W;if(e){if(k=h.Fb[e.toLowerCase()])return g["return"](k);B.l("Could not determine manifest type using MIME type ",e)}if(l=h.getExtension(b)){if(n=h.Vb[l])return g["return"](n);B.l("Could not determine manifest type for extension ",l)}else B.l("Could not find extension for ",b);if(e){g.B(2);break}return v(g,h.Ue(b,c,d),3);case 3:if(e=g.o){if(p=W.Fb[e])return g["return"](p);B.l("Could not determine manifest type using MIME type",
e)}case 2:throw new E(2,4,4E3,b);}})})};W.Ue=function(b,c,d){return u(function f(){var g,h,k;return y(f,function(f){switch(f.j){case 1:return g=Vb([b],d),g.method="HEAD",v(f,c.request(0,g).promise,2);case 2:return h=f.o,k=h.headers["content-type"],f["return"](k?k.toLowerCase().split(";").shift():"")}})})};W.getExtension=function(b){b=(new kb(b)).ka.split("/").pop().split(".");return 1==b.length?"":b.pop().toLowerCase()};
W.isSupported=function(b,c){return rc()?c in W.Fb||W.getExtension(b)in W.Vb?!0:!1:!1};function X(b,c,d){this.f=b;this.zc=c;this.h=this.g=Infinity;this.a=1;this.b=this.c=null;this.m=0;this.s=!0;this.i=0;this.v=void 0===d?!0:d}A("shaka.media.PresentationTimeline",X);X.prototype.aa=function(){return this.g};X.prototype.getDuration=X.prototype.aa;X.prototype.Se=function(){return this.a};X.prototype.getMaxSegmentDuration=X.prototype.Se;X.prototype.Aa=function(b){this.g=b};X.prototype.setDuration=X.prototype.Aa;X.prototype.Ze=function(){return this.f};
X.prototype.getPresentationStartTime=X.prototype.Ze;X.prototype.me=function(b){this.m=b};X.prototype.setClockOffset=X.prototype.me;X.prototype.ac=function(b){this.s=b};X.prototype.setStatic=X.prototype.ac;X.prototype.yd=function(b){this.h=b};X.prototype.setSegmentAvailabilityDuration=X.prototype.yd;X.prototype.Uf=function(b){this.zc=b};X.prototype.setDelay=X.prototype.Uf;X.prototype.Ke=function(){return this.zc};X.prototype.getDelay=X.prototype.Ke;
X.prototype.Bb=function(b,c){if(0!=b.length){var d=b[b.length-1].endTime+c;this.jd(b[0].startTime+c);this.a=b.reduce(function(b,c){return Math.max(b,c.endTime-c.startTime)},this.a);this.b=Math.max(this.b,d);null!=this.f&&this.v&&(this.f=(Date.now()+this.m)/1E3-this.b-this.a);B.C("notifySegments:","maxSegmentDuration="+this.a)}};X.prototype.notifySegments=X.prototype.Bb;X.prototype.jd=function(b){this.c=null==this.c?b:Math.min(this.c,b)};X.prototype.notifyMinSegmentStartTime=X.prototype.jd;
X.prototype.hd=function(b){this.a=Math.max(this.a,b);B.C("notifyNewSegmentDuration:","maxSegmentDuration="+this.a)};X.prototype.notifyMaxSegmentDuration=X.prototype.hd;X.prototype.offset=function(b){null!=this.c&&(this.c+=b);null!=this.b&&(this.b+=b)};X.prototype.offset=X.prototype.offset;X.prototype.ga=function(){return Infinity==this.g&&!this.s};X.prototype.isLive=X.prototype.ga;X.prototype.ab=function(){return Infinity!=this.g&&!this.s};X.prototype.isInProgress=X.prototype.ab;
X.prototype.Rb=function(){return Infinity==this.h?this.i:Math.max(this.i,this.ub()-this.h)};X.prototype.getSegmentAvailabilityStart=X.prototype.Rb;X.prototype.ne=function(b){this.i=b};X.prototype.setUserSeekStart=X.prototype.ne;X.prototype.ub=function(){return this.ga()||this.ab()?Math.min(Math.max(0,(Date.now()+this.m)/1E3-this.a-this.f),this.g):this.g};X.prototype.getSegmentAvailabilityEnd=X.prototype.ub;
X.prototype.Qb=function(b){var c=Math.max(this.c,this.i);return Infinity==this.h?c:Math.max(c,Math.min(this.ub()-this.h+b,this.Ea()))};X.prototype.getSafeSeekRangeStart=X.prototype.Qb;X.prototype.tb=function(){return this.Qb(0)};X.prototype.getSeekRangeStart=X.prototype.tb;X.prototype.Ea=function(){return Math.max(0,this.ub()-(this.ga()||this.ab()?this.zc:0))};X.prototype.getSeekRangeEnd=X.prototype.Ea;X.prototype.re=function(){return null==this.f||null!=this.b&&this.v?!1:!0};
X.prototype.usingPresentationStartTime=X.prototype.re;function vf(b,c,d,e){b=Vb(b,e);if(0!=c||null!=d)b.headers.Range=d?"bytes="+c+"-"+d:"bytes="+c+"-";return b};function wf(){var b=this;this.b=this.a=null;this.f=[];this.c=null;this.m=[];this.h=1;this.s={};this.v=0;this.A=new ab(5);this.i=new D(function(){xf(b)});this.g=new Pb}A("shaka.dash.DashParser",wf);m=wf.prototype;m.configure=function(b){this.a=b};m.start=function(b,c){var d=this;return u(function f(){var g;return y(f,function(f){switch(f.j){case 1:return d.f=[b],d.b=c,v(f,yf(d),2);case 2:g=f.o;d.b&&zf(d,g);if(!d.b)throw new E(2,7,7001);return f["return"](d.c)}})})};
m.stop=function(){this.a=this.b=null;this.f=[];this.c=null;this.m=[];this.s={};null!=this.i&&(this.i.stop(),this.i=null);return this.g.destroy()};m.update=function(){yf(this)["catch"](function(b){if(this.b)this.b.onError(b)}.bind(this))};m.onExpirationUpdated=function(){};
function yf(b){var c=Date.now(),d=b.b.networkingEngine.request(0,Vb(b.f,b.a.retryParameters));Qb(b.g,d);return d.promise.then(function(c){if(b.b)return c.uri&&!b.f.includes(c.uri)&&b.f.unshift(c.uri),Af(b,c.data,c.uri)}).then(function(){var d=(Date.now()-c)/1E3;bb(b.A,1,d);return d})}function Af(b,c,d){c=T.he(c,"MPD");if(!c)throw new E(2,4,4001,d);c=Ue(c,b.a.retryParameters,b.a.dash.xlinkFailGracefully,d,b.b.networkingEngine);Qb(b.g,c);return c.promise.then(function(c){return Bf(b,c,d)})}
function Bf(b,c,d){return u(function f(){var g,h,k,l,n,p,q,r,x,C,z,H,F,P,wa,aa,Ta,Ja,ba,qa,ia,xa,Aa,eb,Ua,fb,gb;return y(f,function(f){switch(f.j){case 1:l=vd;n=T;p=[d];q=n.S(c,"Location").map(n.lc).filter(l.La);0<q.length&&(r=wd(p,q),p=b.f=r);x=n.S(c,"BaseURL").map(n.lc);C=wd(p,x);z=b.a.dash.ignoreMinBufferTime;H=0;z||(H=n.L(c,"minBufferTime",n.Ga));b.v=n.L(c,"minimumUpdatePeriod",n.Ga,-1);F=n.L(c,"availabilityStartTime",n.Cf);P=n.L(c,"timeShiftBufferDepth",n.Ga);wa=n.L(c,"maxSegmentDuration",n.Ga);
aa=c.getAttribute("type")||"static";Ta=b.a.dash.ignoreSuggestedPresentationDelay;Ja=null;Ta||(Ja=n.L(c,"suggestedPresentationDelay",n.Ga));b.c?ba=b.c.presentationTimeline:(qa=Math.max(b.a.dash.defaultPresentationDelay,1.5*H),ia=null!=Ja?Ja:qa,ba=new X(F,ia,b.a.dash.autoCorrectDrift));xa={rb:"static"!=aa,presentationTimeline:ba,la:null,T:null,Z:null,w:null,bandwidth:0,Xd:!1};for(var uc=xa,tc=C,tb=T.L(c,"mediaPresentationDuration",T.Ga),hb=[],Ba=0,ib=T.S(c,"Period"),ya=0;ya<ib.length;ya++){var Ka=ib[ya];
Ba=T.L(Ka,"start",T.Ga,Ba);var Tb=T.L(Ka,"duration",T.Ga),Va=null;if(ya!=ib.length-1){var ud=T.L(ib[ya+1],"start",T.Ga);null!=ud&&(Va=ud-Ba)}else null!=tb&&(Va=tb-Ba);ud=zd;Va&&Tb&&Math.abs(Va-Tb)>ud&&B.l("There is a gap/overlap between Periods",Ka);null==Va&&(Va=Tb);Ka=Cf(b,uc,tc,{start:Ba,duration:Va,node:Ka,bd:null==Va||ya==ib.length-1});hb.push(Ka);Tb=uc.la.id;b.m.includes(Tb)||(b.m.push(Tb),b.c&&(b.b.filterNewPeriod(Ka),b.c.periods.push(Ka)));if(null==Va){ya!=ib.length-1&&B.l("Skipping Period",
ya+1,"and any subsequent Periods:","Period",ya+1,"does not have a valid start time.",hb[ya+1]);Ba=null;break}Ba+=Va}null==b.c&&b.b.filterAllPeriods(hb);null!=tb?(Ba!=tb&&B.l("@mediaPresentationDuration does not match the total duration of all","Periods."),g=hb,h=tb,k=!1):(g=hb,h=Ba,k=!0);Aa=h;eb=g;ba.ac("static"==aa);"static"!=aa&&k||ba.Aa(Aa||Infinity);(Ua=ba.ga())&&!isNaN(b.a.availabilityWindowOverride)&&(P=b.a.availabilityWindowOverride);null==P&&(P=Infinity);ba.yd(P);ba.hd(wa||1);if(b.c){f.B(0);
break}b.c={presentationTimeline:ba,periods:eb,offlineSessionIds:[],minBufferTime:H||0};if(!ba.re()){f.B(0);break}fb=n.S(c,"UTCTiming");return v(f,Df(b,C,fb),4);case 4:gb=f.o;if(!b.b)return f["return"]();ba.me(gb);w(f)}})})}
function Cf(b,c,d,e){c.la=Ef(e.node,null,d);c.T=e;c.la.id||(B.info("No Period ID given for Period with start time "+e.start+",  Assigning a default"),c.la.id="__shaka_period_"+e.start);T.S(e.node,"EventStream").forEach(b.Df.bind(b,e.start,e.duration));d=T.S(e.node,"AdaptationSet").map(b.Bf.bind(b,c)).filter(vd.La);if(c.rb){c=[];for(var f=t(d),g=f.next();!g.done;g=f.next()){g=t(g.value.Lf);for(var h=g.next();!h.done;h=g.next())c.push(h.value)}if(c.length!=(new Set(c)).size)throw new E(2,4,4018);}var k=
d.filter(function(b){return!b.Cd});d.filter(function(b){return b.Cd}).forEach(function(b){var c=b.streams[0],d=b.Cd;k.forEach(function(b){b.id==d&&b.streams.forEach(function(b){b.trickModeVideo=c})})});c=Ff(k,"video");f=Ff(k,"audio");if(!c.length&&!f.length)throw new E(2,4,4004);d=b.a.disableAudio;if(!f.length||d)f=[null];d=b.a.disableVideo;if(!c.length||d)c=[null];d=[];for(g=0;g<f.length;g++)for(h=0;h<c.length;h++)Gf(b,f[g],c[h],d);c=[];if(!b.a.disableText)for(b=Ff(k,"text"),f=0;f<b.length;f++)c.push.apply(c,
b[f].streams);return{startTime:e.start,textStreams:c,variants:d}}function Ff(b,c){return b.filter(function(b){return b.contentType==c})}
function Gf(b,c,d,e){if(c||d)if(c&&d){var f=c.drmInfos;var g=d.drmInfos;if(f.length&&g.length?0<nd(f,g).length:1){g=nd(c.drmInfos,d.drmInfos);for(var h=0;h<c.streams.length;h++)for(var k=0;k<d.streams.length;k++)f=(d.streams[k].bandwidth||0)+(c.streams[h].bandwidth||0),f={id:b.h++,language:c.language,primary:c.cd||d.cd,audio:c.streams[h],video:d.streams[k],bandwidth:f,drmInfos:g,allowedByApplication:!0,allowedByKeySystem:!0},e.push(f)}}else for(g=c||d,h=0;h<g.streams.length;h++)f=g.streams[h].bandwidth||
0,f={id:b.h++,language:g.language||"und",primary:g.cd,audio:c?g.streams[h]:null,video:d?g.streams[h]:null,bandwidth:f,drmInfos:g.drmInfos,allowedByApplication:!0,allowedByKeySystem:!0},e.push(f)}
m.Bf=function(b,c){b.Z=Ef(c,b.la,null);if("image"==b.Z.contentType)return B.l("Skipping Image AdaptationSet",b.Z),null;var d=!1,e=T.S(c,"Role"),f=e.map(function(b){return b.getAttribute("value")}).filter(vd.La),g=void 0,h="text"==b.Z.contentType;h&&(g="subtitle");for(var k=0;k<e.length;k++){var l=e[k].getAttribute("schemeIdUri");if(null==l||"urn:mpeg:dash:role:2011"==l)switch(l=e[k].getAttribute("value"),l){case "main":d=!0;break;case "caption":case "subtitle":g=l}}var n=null,p=!1;T.S(c,"EssentialProperty").forEach(function(b){"http://dashif.org/guidelines/trickmode"==
b.getAttribute("schemeIdUri")?n=b.getAttribute("value"):p=!0});k=T.S(c,"Accessibility");var q=new Map;e={};k=t(k);for(l=k.next();!l.done;e={Nb:e.Nb},l=k.next()){var r=l.value;l=r.getAttribute("schemeIdUri");r=r.getAttribute("value");"urn:scte:dash:cc:cea-608:2015"==l||"urn:scte:dash:cc:cea-708:2015"==l?(e.Nb=1,null!=r?r.split(";").forEach(function(b){return function(c){if(c.includes("=")){c=c.split("=");var d=c[0].startsWith("CC")?c[0]:"CC"+c[0];c=c[1].split(",")[0].split(":").pop()}else d="CC"+b.Nb,
b.Nb+=2;q.set(d,N(c))}}(e)):q.set("CC1","und")):"urn:mpeg:dash:role:2011"==l&&null!=r&&(f.push(r),"captions"==r&&(g="caption"))}if(p)return null;e=T.S(c,"ContentProtection");var x=He(e,this.a.dash.customScheme,this.a.dash.ignoreDrmInfo);e=N(c.getAttribute("lang")||"und");k=c.getAttribute("label");(l=T.S(c,"Label"))&&l.length&&(l=l[0],l.textContent&&(k=l.textContent));l=T.S(c,"Representation");f=l.map(this.Ef.bind(this,b,x,g,e,k,d,f,q)).filter(function(b){return!!b});if(0==f.length){if(this.a.dash.ignoreEmptyAdaptationSet||
h)return null;throw new E(2,4,4003);}b.Z.contentType&&"application"!=b.Z.contentType||(b.Z.contentType=Hf(f[0].mimeType,f[0].codecs),f.forEach(function(c){c.type=b.Z.contentType}));f.forEach(function(b){x.drmInfos.forEach(function(c){b.keyId&&c.keyIds.push(b.keyId)})});h=l.map(function(b){return b.getAttribute("id")}).filter(vd.La);return{id:b.Z.id||"__fake__"+this.h++,contentType:b.Z.contentType,language:e,cd:d,streams:f,drmInfos:x.drmInfos,Cd:n,Lf:h}};
m.Ef=function(b,c,d,e,f,g,h,k,l){b.w=Ef(l,b.Z,null);if(!If(b.w))return B.l("Skipping Representation",b.w),null;b.bandwidth=T.L(l,"bandwidth",T.xc)||0;var n=b.w.contentType;n="text"==n||"application"==n;try{var p=this.Mf.bind(this);if(b.w.Yb)var q=jf(b,p);else if(b.w.Oa)q=mf(b,this.s);else if(b.w.$b)q=qf(b,p,this.s,!!this.c);else{var r=b.w.sa,x=b.T.duration||0;q={createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(b){return 0<=b&&b<x?1:null},getSegmentReference:function(b){return 1!=
b?null:new U(1,0,x,function(){return r},0,null)},initSegmentReference:null,na:0}}}catch(C){if(n&&4002==C.code)return null;throw C;}l=T.S(l,"ContentProtection");l=Ke(l,this.a.dash.customScheme,c,this.a.dash.ignoreDrmInfo);return{id:this.h++,originalId:b.w.id,createSegmentIndex:q.createSegmentIndex,findSegmentPosition:q.findSegmentPosition,getSegmentReference:q.getSegmentReference,initSegmentReference:q.initSegmentReference,presentationTimeOffset:q.na,mimeType:b.w.mimeType,codecs:b.w.codecs,frameRate:b.w.frameRate,
pixelAspectRatio:b.w.pixelAspectRatio,bandwidth:b.bandwidth,width:b.w.width,height:b.w.height,kind:d,encrypted:0<c.drmInfos.length,keyId:l,language:e,label:f,type:b.Z.contentType,primary:g,trickModeVideo:null,emsgSchemeIdUris:b.w.emsgSchemeIdUris,roles:h,channelsCount:b.w.kd,audioSamplingRate:b.w.audioSamplingRate,closedCaptions:k}};
function xf(b){u(function d(){var e,f;return y(d,function(d){switch(d.j){case 1:return B.info("Updating manifest..."),e=0,Da(d,2),v(d,yf(b),4);case 4:e=d.o;Fa(d,3);break;case 2:f=Ga(d),b.b&&(f.severity=1,b.b.onError(f));case 3:if(!b.b)return d["return"]();zf(b,e);w(d)}})})}function zf(b,c){0>b.v||b.i.V(Math.max(3,b.v-c,cb(b.A)))}
function Ef(b,c,d){c=c||{contentType:"",mimeType:"",codecs:"",emsgSchemeIdUris:[],frameRate:void 0,kd:null,audioSamplingRate:null};d=d||c.sa;var e=T.Eb,f=T.Ee,g=T.S(b,"BaseURL").map(T.lc),h=b.getAttribute("contentType")||c.contentType,k=b.getAttribute("mimeType")||c.mimeType,l=b.getAttribute("codecs")||c.codecs;f=T.L(b,"frameRate",f)||c.frameRate;var n=b.getAttribute("par")||c.pixelAspectRatio,p=T.S(b,"InbandEventStream"),q=c.emsgSchemeIdUris.slice();p=t(p);for(var r=p.next();!r.done;r=p.next())r=
r.value.getAttribute("schemeIdUri"),q.includes(r)||q.push(r);p=T.S(b,"AudioChannelConfiguration");p=Jf(p)||c.kd;r=T.L(b,"audioSamplingRate",e)||c.audioSamplingRate;h||(h=Hf(k,l));return{sa:wd(d,g),Yb:T.kc(b,"SegmentBase")||c.Yb,Oa:T.kc(b,"SegmentList")||c.Oa,$b:T.kc(b,"SegmentTemplate")||c.$b,width:T.L(b,"width",e)||c.width,height:T.L(b,"height",e)||c.height,contentType:h,mimeType:k,codecs:l,frameRate:f,pixelAspectRatio:n,emsgSchemeIdUris:q,id:b.getAttribute("id"),kd:p,audioSamplingRate:r}}
function Jf(b){for(var c=0;c<b.length;++c){var d=b[c],e=d.getAttribute("schemeIdUri");if(e&&(d=d.getAttribute("value")))switch(e){case "urn:mpeg:dash:outputChannelPositionList:2012":return d.trim().split(/ +/).length;case "urn:mpeg:dash:23003:3:audio_channel_configuration:2011":case "urn:dts:dash:audio_channel_configuration:2012":var f=parseInt(d,10);if(!f){B.l("Channel parsing failure! Ignoring scheme and value",e,d);continue}return f;case "tag:dolby.com,2014:dash:audio_channel_configuration:2011":case "urn:dolby:dash:audio_channel_configuration:2011":f=
parseInt(d,16);if(!f){B.l("Channel parsing failure! Ignoring scheme and value",e,d);continue}for(b=0;f;)f&1&&++b,f>>=1;return b;default:B.l("Unrecognized audio channel scheme:",e,d)}}return null}
function If(b){var c=b.Yb?1:0;c+=b.Oa?1:0;c+=b.$b?1:0;if(0==c){if("text"==b.contentType||"application"==b.contentType)return!0;B.l("Representation does not contain a segment information source:","the Representation must contain one of SegmentBase, SegmentList,",'SegmentTemplate, or explicitly indicate that it is "text".',b);return!1}1!=c&&(B.l("Representation contains multiple segment information sources:","the Representation should only contain one of SegmentBase,","SegmentList, or SegmentTemplate.",
b),b.Yb?(B.info("Using SegmentBase by default."),b.Oa=null):B.info("Using SegmentList by default."),b.$b=null);return!0}
function Kf(b,c,d,e){c=wd(c,[d]);c=Vb(c,b.a.retryParameters);c.method=e;c=b.b.networkingEngine.request(4,c);Qb(b.g,c);return c.promise.then(function(b){if("HEAD"==e){if(!b.headers||!b.headers.date)return B.l("UTC timing response is missing","expected date header"),0;b=b.headers.date}else b=Bc(b.data);b=Date.parse(b);return isNaN(b)?(B.l("Unable to parse date from UTC timing response"),0):b-Date.now()})}
function Df(b,c,d){d=d.map(function(b){return{scheme:b.getAttribute("schemeIdUri"),value:b.getAttribute("value")}});var e=b.a.dash.clockSyncUri;!d.length&&e&&d.push({scheme:"urn:mpeg:dash:utc:http-head:2014",value:e});return vd.Ce(d,function(b){var d=b.scheme;b=b.value;switch(d){case "urn:mpeg:dash:utc:http-head:2014":case "urn:mpeg:dash:utc:http-head:2012":return Kf(this,c,b,"HEAD");case "urn:mpeg:dash:utc:http-xsdate:2014":case "urn:mpeg:dash:utc:http-iso:2014":case "urn:mpeg:dash:utc:http-xsdate:2012":case "urn:mpeg:dash:utc:http-iso:2012":return Kf(this,
c,b,"GET");case "urn:mpeg:dash:utc:direct:2014":case "urn:mpeg:dash:utc:direct:2012":return d=Date.parse(b),isNaN(d)?0:d-Date.now();case "urn:mpeg:dash:utc:http-ntp:2014":case "urn:mpeg:dash:utc:ntp:2014":case "urn:mpeg:dash:utc:sntp:2014":return B.da("NTP UTCTiming scheme is not supported"),Promise.reject();default:return B.da("Unrecognized scheme in UTCTiming element",d),Promise.reject()}}.bind(b))["catch"](function(){B.da("A UTCTiming element should always be given in live manifests! This content may not play on clients with bad clocks!");
return 0})}m.Df=function(b,c,d){var e=T.Eb,f=d.getAttribute("schemeIdUri")||"",g=d.getAttribute("value")||"",h=T.L(d,"timescale",e)||1;T.S(d,"Event").forEach(function(d){var k=T.L(d,"presentationTime",e)||0,n=T.L(d,"duration",e)||0;k=k/h+b;n=k+n/h;null!=c&&(k=Math.min(k,b+c),n=Math.min(n,b+c));d={schemeIdUri:f,value:g,startTime:k,endTime:n,id:d.getAttribute("id")||"",eventElement:d};this.b.onTimelineRegionAdded(d)}.bind(this))};
m.Mf=function(b,c,d){b=vf(b,c,d,this.a.retryParameters);b=this.b.networkingEngine.request(1,b);Qb(this.g,b);return b.promise.then(function(b){return b.data})};function Hf(b,c){return Xd(nc(b,c))?"text":b.split("/")[0]}W.qd("mpd",wf);W.Ib("application/dash+xml",wf);W.Ib("video/vnd.mpeg.dash.mpd",wf);function Lf(b,c){this.a=b;this.b=c}Lf.prototype.toString=function(){return"v"+this.a+"."+this.b};function Mf(b,c){var d=new Lf(2,6),e=Nf,f=e.a,g=d.b-f.b;(0<(d.a-f.a||g)?e.c:e.b)(e.a,d,b,c)}function Of(b,c,d,e){B.da([d,"has been deprecated and will be removed in",c,". We are currently at version",b,". Additional information:",e].join(" "))}function Pf(b,c,d,e){B.fc([d,"has been deprecated and has been removed in",c,". We are now at version",b,". Additional information:",e].join(""))}var Nf=null;function Qf(b,c,d,e){this.b=b;this.type=c;this.a=d;this.segments=e||null}function Rf(b,c,d,e){this.id=b;this.name=c;this.a=d;this.value=void 0===e?null:e}Rf.prototype.toString=function(){function b(b){return b.name+"="+(isNaN(Number(b.value))?'"'+b.value+'"':b.value)}var c="#"+this.name,d=this.a?this.a.map(b):[];this.value&&d.unshift(this.value);0<d.length&&(c+=":"+d.join(","));return c};function Sf(b,c){this.name=b;this.value=c}
Rf.prototype.getAttribute=function(b){var c=this.a.filter(function(c){return c.name==b});return c.length?c[0]:null};function Tf(b,c,d){return(b=b.getAttribute(c))?b.value:d||null}function Uf(b,c){this.b=c;this.a=b};var Vf={sb:function(b,c){return b.filter(function(b){return b.name==c})},Xa:function(b,c){var d=Vf.sb(b,c);return d.length?d[0]:null},Tc:function(b,c,d){return b.filter(function(b){var e=b.getAttribute("TYPE");b=b.getAttribute("GROUP-ID");return e.value==c&&b.value==d})},Lc:function(b,c){return wd([b],[c])[0]},ad:function(b){return/^#(?!EXT)/m.test(b)}};function Wf(b){this.b=b;this.a=0}function Xf(b){Yf(b,/[ \t]+/gm)}function Yf(b,c){c.lastIndex=b.a;var d=c.exec(b.b);d=null==d?null:{position:d.index,length:d[0].length,Of:d};if(b.a==b.b.length||null==d||d.position!=b.a)return null;b.a+=d.length;return d.Of}function Zf(b){return b.a==b.b.length?null:(b=Yf(b,/[^ \t\n]*/gm))?b[0]:null};function $f(){this.a=0}
function ag(b,c,d){c=Bc(c);c=c.replace(/\r\n|\r(?=[^\n]|$)/gm,"\n").trim();var e=c.split(/\n+/m);if(!/^#EXTM3U($|[ \t\n])/m.test(e[0]))throw new E(2,4,4015);c=0;for(var f=1;f<e.length;f++)if(!Vf.ad(e[f])){var g=bg(b,e[f]);--b.a;if(cg.includes(g.name)){c=1;break}else"EXT-X-STREAM-INF"==g.name&&(f+=1)}f=[];for(g=1;g<e.length;)if(Vf.ad(e[g]))g+=1;else{var h=bg(b,e[g]);if(dg.includes(h.name)){if(1!=c)throw new E(2,4,4017);e=e.splice(g,e.length-g);b=eg(b,d,e,f);return new Qf(d,c,f,b)}f.push(h);g+=1;"EXT-X-STREAM-INF"==
h.name&&(h.a.push(new Sf("URI",e[g])),g+=1)}return new Qf(d,c,f)}function eg(b,c,d,e){var f=[],g=[];d.forEach(function(d){if(/^(#EXT)/.test(d))d=bg(b,d),cg.includes(d.name)?e.push(d):g.push(d);else{if(Vf.ad(d))return[];d=Vf.Lc(c,d.trim());f.push(new Uf(d,g));g=[]}});return f}
function bg(b,c){var d=b.a++,e=c.match(/^#(EXT[^:]*)(?::(.*))?$/);if(!e)throw new E(2,4,4016,c);var f=e[1],g=e[2];e=[];var h;if(g){g=new Wf(g);var k;(k=Yf(g,/^([^,=]+)(?:,|$)/g))&&(h=k[1]);for(var l=/([^=]+)=(?:"([^"]*)"|([^",]*))(?:,|$)/g;k=Yf(g,l);)e.push(new Sf(k[1],k[2]||k[3]))}return new Rf(d,f,e,h)}var cg="EXT-X-TARGETDURATION EXT-X-MEDIA-SEQUENCE EXT-X-DISCONTINUITY-SEQUENCE EXT-X-PLAYLIST-TYPE EXT-X-MAP EXT-X-I-FRAMES-ONLY EXT-X-ENDLIST".split(" "),dg="EXTINF EXT-X-BYTERANGE EXT-X-DISCONTINUITY EXT-X-PROGRAM-DATE-TIME EXT-X-KEY EXT-X-DATERANGE".split(" ");function fg(b){try{var c=fg.parse(b);return Eb({uri:b,nd:b,data:c.data,headers:{"content-type":c.contentType}})}catch(d){return Cb(d)}}A("shaka.net.DataUriPlugin",fg);
fg.parse=function(b){var c=b.split(":");if(2>c.length||"data"!=c[0])throw B.error("Bad data URI, failed to parse scheme"),new E(2,1,1004,b);c=c.slice(1).join(":").split(",");if(2>c.length)throw B.error("Bad data URI, failed to extract encoding and MIME type"),new E(2,1,1004,b);var d=c[0];c=window.decodeURIComponent(c.slice(1).join(","));d=d.split(";");var e=null;1<d.length&&(e=d[1]);if("base64"==e)b=M.Da(c).buffer;else{if(e)throw B.error("Bad data URI, unknown encoding"),new E(2,1,1005,b);b=Ec(c)}return{data:b,
contentType:d[0]}};Ub("data",fg);function gg(){var b=this;this.a=this.f=null;this.ca=1;this.H=new Map;this.W=new Set;this.b=new Map;this.c=null;this.A="";this.v=new $f;this.U=0;this.h=new D(function(){hg(b)});this.g=ig;this.s=null;this.F=0;this.K=Infinity;this.i=new Pb;this.O=[];this.m=new Map;this.Y=!1}A("shaka.hls.HlsParser",gg);m=gg.prototype;m.configure=function(b){this.a=b};
m.start=function(b,c){var d=this;return u(function f(){var g,h;return y(f,function(f){switch(f.j){case 1:return d.f=c,v(f,jg(d,Vb([b],d.a.retryParameters),0),2);case 2:return g=f.o,d.A=g.uri,v(f,kg(d,g.data),3);case 3:return h=d.U,0<h&&d.h.V(h),f["return"](d.s)}})})};m.stop=function(){this.h&&(this.h.stop(),this.h=null);var b=[];this.i&&(b.push(this.i.destroy()),this.i=null);this.a=this.f=null;this.H.clear();this.W.clear();this.b.clear();this.s=null;return Promise.all(b)};
m.update=function(){if(this.g!=lg.Ua){for(var b=[],c=t(this.b.values()),d=c.next();!d.done;d=c.next())b.push(mg(this,d.value));return Promise.all(b)}};
function mg(b,c){return u(function e(){var f,g,h,k,l,n,p,q,r,x,C;return y(e,function(e){switch(e.j){case 1:return f=Vf,g=lg,h=c.we,v(e,jg(b,Vb([h],b.a.retryParameters),0),2);case 2:k=e.o;l=ag(b.v,k.data,k.uri);if(1!=l.type)throw new E(2,4,4017);p=(n=f.Xa(l.a,"EXT-X-MEDIA-SEQUENCE"))?Number(n.value):0;q=c.stream;return v(e,ng(b,c.Ec,l,p,q.mimeType,q.codecs),3);case 3:r=e.o;c.Zb.a=r;x=r[r.length-1];if(C=f.Xa(l.a,"EXT-X-ENDLIST"))og(b,g.Ua),b.c.Aa(x.endTime);w(e)}})})}m.onExpirationUpdated=function(){};
function kg(b,c){return u(function e(){var f,g,h,k,l,n,p,q,r,x,C;return y(e,function(e){switch(e.j){case 1:f=ag(b.v,c,b.A);if(0!=f.type)throw new E(2,4,4022);return v(e,pg(b,f),2);case 2:g=e.o;if(!b.f)throw new E(2,7,7001);if(b.Y&&0==g.variants.length)throw B.info("No stream is created, because we don't support AES-128","encryption yet"),new E(2,4,4034);b.f.filterAllPeriods([g]);h=Infinity;k=0;l=Infinity;for(var z=t(b.b.values()),F=z.next();!F.done;F=z.next())n=F.value,h=Math.min(h,n.gd),k=Math.max(k,
n.gd),"text"!=n.stream.type&&(l=Math.min(l,n.duration));b.g!=lg.Ua?(b.c=new X(0,3*b.F),b.c.ac(!1)):(b.c=new X(null,0),b.c.ac(!0));qg(b);if(b.g!=lg.Ua){b.U=b.K;p=lg;b.g==p.Fd&&(q=b.c.zc,isNaN(b.a.availabilityWindowOverride)||(q=b.a.availabilityWindowOverride),b.c.yd(q));for(r=0;95443.7176888889<=k;)r+=95443.7176888889,k-=95443.7176888889;if(r)for(B.debug("Offsetting live streams by",r,"to compensate for rollover"),z=t(b.b.values()),F=z.next();!F.done;F=z.next())x=F.value,95443.7176888889>x.gd?(B.C("Offset applied to",
x.stream.type),x.stream.presentationTimeOffset=-r,x.Zb.offset(r)):B.C("Offset NOT applied to",x.stream.type)}else for(b.c.Aa(l),b.c.offset(-h),z=t(b.b.values()),F=z.next();!F.done;F=z.next())C=F.value,C.stream.presentationTimeOffset=h,C.Zb.offset(-h),Ye(C.Zb,l);b.s={presentationTimeline:b.c,periods:[g],offlineSessionIds:[],minBufferTime:0};w(e)}})})}
function pg(b,c){return u(function e(){var f,g,h,k,l,n,p,q,r,x,C,z;return y(e,function(e){switch(e.j){case 1:return f=Vf,g=vd,h=c.a,k=f.sb(c.a,"EXT-X-MEDIA"),l=k.filter(function(b){return"SUBTITLES"==rg(b,"TYPE")}.bind(b)),n=l.map(function(b){var c=this;return u(function aa(){var e;return y(aa,function(f){switch(f.j){case 1:if(c.a.disableText)return f["return"](null);Da(f,2);return v(f,sg(c,b),4);case 4:return f["return"](f.o);case 2:e=Ga(f);if(c.a.hls.ignoreTextStreamFailures)return f["return"](null);
throw e;}})})}.bind(b)),p=k.filter(function(b){return"CLOSED-CAPTIONS"==rg(b,"TYPE")}),tg(b,p),v(e,Promise.all(n),2);case 2:return q=e.o,r=f.sb(h,"EXT-X-STREAM-INF"),x=r.map(function(b){return ug(this,b,c)}.bind(b)),v(e,Promise.all(x),3);case 3:return C=e.o,z=C.reduce(g.Kc,[]),z=z.filter(function(b){return null!=b}),e["return"]({startTime:0,variants:z,textStreams:q.filter(function(b){return null!=b})})}})})}
function ug(b,c,d){return u(function f(){var g,h,k,l,n,p,q,r,x,C,z,H,F,P,wa,aa,Ta,Ja,ba,qa,ia,xa,Aa,eb,Ua,fb,gb;return y(f,function(f){switch(f.j){case 1:g=yd;h=Vf;k=Tf(c,"CODECS","avc1.42E01E,mp4a.40.2");l=vg(k.split(/\s*,\s*/));n=c.getAttribute("RESOLUTION");q=p=null;r=Tf(c,"FRAME-RATE");x=Number(rg(c,"BANDWIDTH"));n&&(C=n.value.split("x"),p=C[0],q=C[1]);z=h.sb(d.a,"EXT-X-MEDIA");z=z.filter(function(b){return"CLOSED-CAPTIONS"!=rg(b,"TYPE")});z=z.filter(function(b){var c=Tf(b,"URI")||"";return"SUBTITLES"==
(Tf(b,"TYPE")||"")||""!=c});H=Tf(c,"AUDIO");F=Tf(c,"VIDEO");H?z=h.Tc(z,"AUDIO",H):F&&(z=h.Tc(z,"VIDEO",F));if(P=wg(g.ua,l)){if(wa=Tf(c,"SUBTITLES"))if(aa=h.Tc(z,"SUBTITLES",wa),aa.length&&(Ta=b.H.get(aa[0].id)))Ta.stream.codecs=P;Mb(l,P)}Ja=z.map(function(b){return xg(this,b,l)}.bind(b));ba=[];qa=[];return v(f,Promise.all(Ja),2);case 2:xa=f.o;xa=xa.filter(function(b){return null!=b});H?ba=xa:F&&(qa=xa);B.debug("Guessing stream type for",c.toString());eb=!1;ba.length||qa.length?ba.length?(fb=rg(c,
"URI"),gb=ba[0].Ec,fb==gb?(B.debug("Guessing audio-only."),Aa=g.Kb,eb=!0):(B.debug("Guessing video."),Aa=g.Ta)):(B.debug("Guessing audio."),Aa=g.Kb):1==l.length?(Ua=wg(g.Ta,l),n||r||Ua?(B.debug("Guessing video-only."),Aa=g.Ta):(B.debug("Guessing audio-only."),Aa=g.Kb)):(B.debug("Guessing multiplexed audio+video."),Aa=g.Ta,l=[l.join(",")]);if(eb){f.B(3);break}return v(f,yg(b,c,l,Aa),4);case 4:ia=f.o;case 3:if(ia)ia.stream.type==g.Kb?ba=[ia]:qa=[ia];else if(null===ia)return B.debug("streamInfo is null"),
f["return"]([]);qa&&zg(qa);ba&&zg(ba);return f["return"](Ag(b,ba,qa,x,p,q,r))}})})}function zg(b){b.forEach(function(b){if(b){var c=b.stream.codecs.split(",");c=c.filter(function(b){return"mp4a.40.34"!=b});b.stream.codecs=c.join(",")}})}
function Ag(b,c,d,e,f,g,h){d.forEach(function(b){if(b=b.stream)b.width=Number(f)||void 0,b.height=Number(g)||void 0,b.frameRate=Number(h)||void 0}.bind(b));var k=b.a?b.a.disableAudio:!1;if(!c.length||k)c=[null];k=b.a?b.a.disableVideo:!1;if(!d.length||k)d=[null];k=[];c=t(c);for(var l=c.next();!l.done;l=c.next()){l=l.value;for(var n=t(d),p=n.next();!p.done;p=n.next()){var q=p.value;p=l?l.stream:null;var r=q?q.stream:null,x=l?l.drmInfos:null,C=q?q.drmInfos:null;q=(q?q.Ec:"")+" - "+(l?l.Ec:"");var z=
void 0;if(p&&r)if(x.length&&C.length?0<nd(x,C).length:1)z=nd(x,C);else{B.l("Incompatible DRM info in HLS variant.  Skipping.");continue}else p?z=x:r&&(z=C);b.W.has(q)?B.debug("Skipping variant which only differs in text streams."):(p=Bg(b,p,r,e,z),k.push(p),b.W.add(q))}}return k}function Bg(b,c,d,e,f){return{id:b.ca++,language:c?c.language:"und",primary:!!c&&c.primary||!!d&&d.primary,audio:c,video:d,bandwidth:e,drmInfos:f,allowedByApplication:!0,allowedByKeySystem:!0}}
function sg(b,c){return u(function e(){var f;return y(e,function(e){switch(e.j){case 1:return rg(c,"TYPE"),v(e,xg(b,c,[]),2);case 2:return f=e.o,e["return"](f.stream)}})})}function tg(b,c){for(var d=t(c),e=d.next();!e.done;e=d.next()){e=e.value;rg(e,"TYPE");var f=Tf(e,"LANGUAGE")||"und";f=N(f);var g=rg(e,"GROUP-ID");e=rg(e,"INSTREAM-ID");b.m.get(g)||b.m.set(g,new Map);b.m.get(g).set(e,f)}}
function xg(b,c,d){return u(function f(){var g,h,k,l,n,p,q,r,x,C,z,H;return y(f,function(f){switch(f.j){case 1:g=rg(c,"URI");if(b.b.has(g))return f["return"](b.b.get(g));h=rg(c,"TYPE").toLowerCase();k=yd;"subtitles"==h&&(h=k.ua);l=N(Tf(c,"LANGUAGE","und"));n=Tf(c,"NAME");p=c.getAttribute("DEFAULT");q=c.getAttribute("AUTOSELECT");r=Tf(c,"CHANNELS");if("audio"==h)if(r){var F=r.split("/")[0];F=parseInt(F,10)}else F=null;else F=null;x=F;C=!!p||!!q;z=Tf(c,"CHARACTERISTICS");return v(f,Cg(b,g,d,h,l,C,n,
x,null,z),2);case 2:H=f.o;if(b.b.has(g))return f["return"](b.b.get(g));if(null==H)return f["return"](null);b.H.set(c.id,H);b.b.set(g,H);return f["return"](H)}})})}
function yg(b,c,d,e){return u(function g(){var h,k,l,n,p;return y(g,function(g){switch(g.j){case 1:h=yd;k=rg(c,"URI");if(b.b.has(k))return g["return"](b.b.get(k));l=Tf(c,"CLOSED-CAPTIONS");n=null;e==h.Ta&&l&&"NONE"!=l&&(n=b.m.get(l));return v(g,Cg(b,k,d,e,"und",!1,null,null,n,null),2);case 2:p=g.o;if(null==p)return g["return"](null);if(b.b.has(k))return g["return"](b.b.get(k));b.b.set(k,p);return g["return"](p)}})})}
function Cg(b,c,d,e,f,g,h,k,l,n){return u(function q(){var r,x,C,z,H,F,P,wa,aa,Ta,Ja,ba,qa,ia,xa,Aa,eb,Ua,fb,gb,tc,uc,Sb,tb,hb,Ba,ib;return y(q,function(q){switch(q.j){case 1:return r=Vf,x=r.Lc(b.A,c),v(q,jg(b,Vb([x],b.a.retryParameters),0),2);case 2:C=q.o;x=C.uri;z=ag(b.v,C.data,x);if(1!=z.type)throw new E(2,4,4017);H=[];z.segments.forEach(function(b){b=r.sb(b.b,"EXT-X-KEY");H.push.apply(H,b)});F=!1;P=[];wa=null;for(var Ka=t(H),ya=Ka.next();!ya.done;ya=Ka.next())if(aa=ya.value,Ta=rg(aa,"METHOD"),
"NONE"!=Ta){F=!0;if("AES-128"==Ta)return B.l("Unsupported HLS Encryption",Ta),b.Y=!0,q["return"](null);Ja=rg(aa,"KEYFORMAT");(qa=(ba=Dg[Ja])?ba(aa):null)?(qa.keyIds.length&&(wa=qa.keyIds[0]),P.push(qa)):B.l("Unsupported HLS KEYFORMAT",Ja)}if(F&&!P.length)throw new E(2,4,4026);Eg(b,z);ia=Fg(e,d);return v(q,Gg(b,e,ia,z),3);case 3:return xa=q.o,Hg.includes(xa)&&(ia=""),eb=(Aa=r.Xa(z.a,"EXT-X-MEDIA-SEQUENCE"))?Number(Aa.value):0,Da(q,4),v(q,ng(b,c,z,eb,xa,ia),6);case 6:Ua=q.o;Fa(q,5);break;case 4:fb=
Ga(q);if(4035==fb.code)return B.da("Skipping unsupported HLS stream",xa,c),q["return"](null);throw fb;case 5:return gb=Ua[0].startTime,tc=Ua[Ua.length-1].endTime,uc=tc-gb,Sb=new V(Ua),tb=Ig(z),hb=void 0,"text"==e&&(hb="subtitle"),Ba=[],n&&Ba.push(n),ib={id:b.ca++,originalId:h,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:Sb.find.bind(Sb),getSegmentReference:Sb.get.bind(Sb),initSegmentReference:tb,presentationTimeOffset:0,mimeType:xa,codecs:ia,kind:hb,encrypted:F,keyId:wa,language:f,
label:h,type:e,primary:g,trickModeVideo:null,emsgSchemeIdUris:null,frameRate:void 0,pixelAspectRatio:void 0,width:void 0,height:void 0,bandwidth:void 0,roles:Ba,channelsCount:k,audioSamplingRate:null,closedCaptions:l},q["return"]({stream:ib,Zb:Sb,drmInfos:P,Ec:c,we:x,gd:gb,ng:tc,duration:uc})}})})}
function Eg(b,c){var d=lg,e=Vf.Xa(c.a,"EXT-X-PLAYLIST-TYPE"),f=Vf.Xa(c.a,"EXT-X-ENDLIST");f=e&&"VOD"==e.value||f;e=e&&"EVENT"==e.value&&!f;e=!f&&!e;f?og(b,d.Ua):(e?og(b,d.Fd):og(b,d.te),d=Jg(c.a,"EXT-X-TARGETDURATION"),d=Number(d.value),b.F=Math.max(d,b.F),b.K=Math.min(d,b.K))}
function Ig(b){var c=Vf.sb(b.a,"EXT-X-MAP");if(!c.length)return null;if(1<c.length)throw new E(2,4,4020);c=c[0];var d=rg(c,"URI"),e=Vf.Lc(b.b,d);b=0;d=null;if(c=Tf(c,"BYTERANGE"))b=c.split("@"),c=Number(b[0]),b=Number(b[1]),d=b+c-1;return new Ve(function(){return[e]},b,d)}
function Kg(b,c,d,e){var f=c.b,g=c.a;c=Jg(f,"EXTINF").value.split(",");c=e+Number(c[0]);var h=0,k=null;if(f=Vf.Xa(f,"EXT-X-BYTERANGE"))h=f.value.split("@"),f=Number(h[0]),h=h[1]?Number(h[1]):b.a+1,k=h+f-1;return new U(d,e,c,function(){return[g]},h,k)}function qg(b){b.c&&(b.O.forEach(function(c){b.c.Bb(c,0)}),b.O=[])}
function ng(b,c,d,e,f,g){return u(function k(){var l,n,p,q,r,x,C,z,H,F,P;return y(k,function(k){switch(k.j){case 1:return l=d.segments,n=[],p=l[0].a,q=Kg(null,l[0],e,0),r=Ig(d),v(k,Lg(b,c,r,q,f,g),2);case 2:x=k.o;B.debug("First segment",p.split("/").pop(),"starts at",x);for(var aa=0;aa<l.length;++aa)C=l[aa],z=n[n.length-1],H=0==aa?x:z.endTime,F=e+aa,P=Kg(z,C,F,H),n.push(P);b.O.push(n);qg(b);return k["return"](n)}})})}
function Mg(b,c){return u(function e(){var f,g,h,k,l,n;return y(e,function(e){switch(e.j){case 1:f=1;g=vf(c.c(),c.b,c.b+2048-1,b.a.retryParameters);h=vf(c.c(),c.b,c.a,b.a.retryParameters);if(b.a.hls.useFullSegmentsForStartTime)return e["return"](jg(b,h,f));Da(e,2);return v(e,jg(b,g,f),4);case 4:return k=e.o,e["return"](k);case 2:l=Ga(e);if(7001==l.code)throw l;B.da("Unable to fetch a partial HLS segment! Falling back to a full segment request, which is expensive!  Your server should support Range requests and CORS preflights.",
g.uris[0]);return v(e,jg(b,h,f),5);case 5:return n=e.o,e["return"](n)}})})}
function Lg(b,c,d,e,f,g){return u(function k(){var l,n,p,q,r,x,C,z,H;return y(k,function(k){switch(k.j){case 1:if(b.s){l=b.b.get(c);n=l.Zb;if(p=n.get(e.position))return B.C("Found segment start time in previous manifest"),k["return"](p.startTime);B.debug("Unable to find segment start time in previous manifest!")}B.C("Fetching segment to find start time");f=f.toLowerCase();if(Hg.includes(f))throw B.da("Raw formats are not yet supported.  Skipping "+f),new E(1,4,4035);if("video/webm"==f)throw B.da("WebM in HLS is not yet supported.  Skipping."),
new E(1,4,4035);if("video/mp4"!=f&&"audio/mp4"!=f){k.B(2);break}q=[Mg(b,e)];d&&q.push(Mg(b,d));return v(k,Promise.all(q),3);case 3:return r=k.o,x=r[0],C=r[1]||r[0],k["return"](Ng(c,x.uri,x.data,C.data));case 2:if("video/mp2t"!=f){k.B(4);break}return v(k,Mg(b,e),5);case 5:return z=k.o,k["return"](Og(c,z.uri,z.data));case 4:if("application/mp4"!=f&&!f.startsWith("text/")){k.B(6);break}return v(k,Mg(b,e),7);case 7:return H=k.o,k["return"](Pg(f,g,H.data));case 6:throw new E(2,4,4030,c);}})})}
function Ng(b,c,d,e){var f=0;(new S).J("moov",Be).J("trak",Be).J("mdia",Be).ha("mdhd",function(b){b.reader.P(0==b.version?8:16);f=b.reader.G();b.parser.stop()}).parse(e,!0);if(!f)throw B.error("Unable to find timescale in init segment!"),new E(2,4,4030,b,c);var g=0,h=!1;(new S).J("moof",Be).J("traf",Be).ha("tfdt",function(b){g=(0==b.version?b.reader.G():b.reader.Hb())/f;h=!0;b.parser.stop()}).parse(d,!0);if(!h)throw new E(2,4,4030,b,c);return g}
function Og(b,c,d){function e(){g.seek(h+188);k=g.ma();71!=k&&(g.seek(h+192),k=g.ma());71!=k&&(g.seek(h+204),k=g.ma());71!=k&&f();g.ke(1)}function f(){throw new E(2,4,4030,b,c);}for(var g=new R(new DataView(d),0),h=0,k=0;;)if(h=g.fa(),k=g.ma(),71!=k&&f(),d=g.Wb(),8191==(d&8191))e();else if(d&16384)if(d=(g.ma()&48)>>4,0!=d&&2!=d||f(),3==d&&(d=g.ma(),g.P(d)),1!=g.G()>>8)e();else{g.P(3);d=g.ma()>>6;0!=d&&1!=d||f();0==g.ma()&&f();d=g.ma();var l=g.Wb(),n=g.Wb();return(1073741824*((d&14)>>1)+((l&65534)<<
14|(n&65534)>>1))/9E4}else e()}function Pg(b,c,d){b=nc(b,c);if(!Xd(b))return 0;c=new Vd(null);Yd(c,b);return c.oc(d)}function vg(b){var c=new Set,d=[];b=t(b);for(var e=b.next();!e.done;e=b.next()){e=e.value;var f=qc(e)[0];c.has(f)?B.debug("Ignoring duplicate codec"):(d.push(e),c.add(f))}return d}function wg(b,c){for(var d=Qg[b],e=0;e<d.length;e++)for(var f=0;f<c.length;f++)if(d[e].test(c[f].trim()))return c[f].trim();return"text"==b?"":null}
function Fg(b,c){if(1==c.length)return c[0];var d=wg(b,c);if(null!=d)return d;throw new E(2,4,4025,c);}
function Gg(b,c,d,e){return u(function g(){var h,k,l,n,p,q,r,x,C;return y(g,function(g){switch(g.j){case 1:h=yd;k=e.segments[0].a;l=new kb(k);n=l.ka.split(".").pop();p=Rg[c];if(q=p[n])return g["return"](q);if(c==h.ua)return d&&"vtt"!=d?g["return"]("application/mp4"):g["return"]("text/vtt");r=Vb([k],b.a.retryParameters);r.method="HEAD";return v(g,jg(b,r,1),2);case 2:x=g.o;C=x.headers["content-type"];if(!C)throw new E(2,4,4021,n);return g["return"](C.split(";")[0])}})})}
function rg(b,c){var d=b.getAttribute(c);if(!d)throw new E(2,4,4023,c);return d.value}function Jg(b,c){var d=Vf.Xa(b,c);if(!d)throw new E(2,4,4024,c);return d}
var Qg={audio:[/^vorbis$/,/^opus$/,/^flac$/,/^mp4a/,/^[ae]c-3$/],video:[/^avc/,/^hev/,/^hvc/,/^vp0?[89]/,/^av1$/],text:[/^vtt$/,/^wvtt/,/^stpp/]},Hg=["audio/aac","audio/ac3","audio/ec3","audio/mpeg"],Rg={audio:{mp4:"audio/mp4",m4s:"audio/mp4",m4i:"audio/mp4",m4a:"audio/mp4",cmfa:"audio/mp4",ts:"video/mp2t",aac:"audio/aac",ac3:"audio/ac3",ec3:"audio/ec3",mp3:"audio/mpeg"},video:{mp4:"video/mp4",m4s:"video/mp4",m4i:"video/mp4",m4v:"video/mp4",cmfv:"video/mp4",ts:"video/mp2t"},text:{mp4:"application/mp4",
m4s:"application/mp4",m4i:"application/mp4",cmft:"application/mp4",vtt:"text/vtt",ttml:"application/ttml+xml"}};function hg(b){u(function d(){var e,f;return y(d,function(d){switch(d.j){case 1:B.info("Updating manifest...");if(!b.f)return d["return"]();Da(d,2);return v(d,b.update(),4);case 4:e=b.U;b.h.V(e);Fa(d,0);break;case 2:f=Ga(d);if(!b.f)return d["return"]();f.severity=1;b.f.onError(f);b.h.V(.1);w(d)}})})}function og(b,c){b.g=c;b.c&&b.c.ac(b.g==lg.Ua);b.g!=lg.Ua||b.h.stop()}
function jg(b,c,d){if(!b.i)throw new E(2,7,7001);c=b.f.networkingEngine.request(d,c);Qb(b.i,c);return c.promise}
var Dg={"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":function(b){var c=rg(b,"METHOD");Mf("HLS SAMPLE-AES-CENC","SAMPLE-AES-CENC will no longer be supported, see Issue #1227");var d=["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"];if(!d.includes(c))return B.error("Widevine in HLS is only supported with [",d.join(", "),"], not",c),null;c=rg(b,"URI");c=fg.parse(c);c=new Uint8Array(c.data);c=xd("com.widevine.alpha",[{initDataType:"cenc",initData:c}]);if(b=Tf(b,"KEYID"))c.keyIds=[b.substr(2).toLowerCase()];
return c}},ig="VOD",lg={Ua:ig,te:"EVENT",Fd:"LIVE"};W.qd("m3u8",gg);W.Ib("application/x-mpegurl",gg);W.Ib("application/vnd.apple.mpegurl",gg);function Sg(){this.a=new Map}function Tg(b,c,d){Ug(b,c).text=d}function Ug(b,c){b.a.has(c)||b.a.set(c,new Vg);return b.a.get(c)}function Vg(){this.text=this.variant=null};function Wg(b,c){this.a=b;this.b=new Set([b]);c=c||[];for(var d=t(c),e=d.next();!e.done;e=d.next())this.add(e.value)}Wg.prototype.add=function(b){if(Xg(this.a,b))return this.b.add(b),!0;B.l("Rejecting variant - not compatible with root.");return!1};
function Xg(b,c){var d;if(!(d=!!b.audio!=!!c.audio||!!b.video!=!!c.video||b.language!=c.language)&&(d=b.audio&&c.audio)){d=b.audio;var e=c.audio;d=!(d.channelsCount==e.channelsCount&&Yg(d,e)&&Zg(d.roles,e.roles))}!d&&(d=b.video&&c.video)&&(d=b.video,e=c.video,d=!(Yg(d,e)&&Zg(d.roles,e.roles)));return d?!1:!0}Wg.prototype.values=function(){return this.b.values()};
function Yg(b,c){if(b.mimeType!=c.mimeType)return!1;var d=b.codecs.split(",").map(function(b){return qc(b)[0]}),e=c.codecs.split(",").map(function(b){return qc(b)[0]});if(d.length!=e.length)return!1;d.sort();e.sort();for(var f=0;f<d.length;f++)if(d[f]!=e[f])return!1;return!0}function Zg(b,c){var d=new Set(b),e=new Set(c);d["delete"]("main");e["delete"]("main");if(d.size!=e.size)return!1;d=t(d);for(var f=d.next();!f.done;f=d.next())if(!e.has(f.value))return!1;return!0};function $g(b){this.a=b;this.b=new ah(b.language,"",b.audio&&b.audio.channelsCount?b.audio.channelsCount:0,"")}$g.prototype.create=function(b){var c=this,d=b.filter(function(b){return Xg(c.a,b)});return d.length?new Wg(d[0],d):this.b.create(b)};function ah(b,c,d,e,f){this.f=b;this.c=c;this.a=d;this.b=void 0===e?"":e;this.g=void 0===f?"":f}
ah.prototype.create=function(b){var c=[];c=bh(b,this.f);var d=b.filter(function(b){return b.primary});c=c.length?c:d.length?d:b;this.c&&(b=ch(c,this.c,this.g),b.length?c=b:B.l("No exact match for variant role could be found."));this.a&&(b=O.Od(c,this.a),b.length?c=b:B.l("No exact match for the channel count could be found."));this.b&&(b=dh(c,this.b),b.length?c=b:B.l("No exact match for variant label could be found."));b=new Wg(c[0]);c=t(c);for(d=c.next();!d.done;d=c.next())d=d.value,Xg(b.a,d)&&b.add(d);
return b};function bh(b,c){var d=N(c),e=ve(d,b.map(function(b){return ue(b)}));return e?b.filter(function(b){return e==ue(b)}):[]}function ch(b,c,d){return b.filter(function(b){if(d){var e=b[d];return e&&e.roles.includes(c)}e=b.audio;b=b.video;return e&&0<=e.roles.indexOf(c)||b&&0<=b.roles.indexOf(c)})}function dh(b,c){return b.filter(function(b){return b.audio?b.audio.label.toLowerCase()==c.toLowerCase():!1})};function eh(){this.a=fh;this.b=(new Map).set(fh,2).set(gh,1)}function hh(b,c,d){b.b.set(fh,d).set(gh,c)}var gh=0,fh=1;function ih(b,c){this.g=b;this.h=jh(b);this.a=b.a.currentTime;this.f=Date.now()/1E3;this.b=!1;this.i=c;this.c=function(){}}ih.prototype.release=function(){this.g=null;this.c=function(){}};function kh(b,c){b.c=c}function lh(b){this.a=b}function jh(b){if(b.a.paused||0==b.a.playbackRate||0==b.a.buffered.length)var c=!1;else a:{c=b.a.buffered;b=b.a.currentTime;for(var d=0;d<c.length;d++){var e=c.start(d),f=c.end(d);if(!(b<e||b>f-.5)){c=!0;break a}}c=!1}return c};function mh(b,c,d,e,f){var g=this;this.a=b;this.A=c;this.v=d;this.m=f;this.f=new L;this.i=!1;this.s=b.readyState;this.c=!1;this.b=e;this.h=!1;this.f.D(b,"waiting",function(){return nh(g)});this.g=(new D(function(){nh(g)})).Qa(.25)}mh.prototype.release=function(){this.f&&(this.f.release(),this.f=null);null!=this.g&&(this.g.stop(),this.g=null);this.b&&(this.b.release(),this.b=null);this.a=this.A=this.m=null};mh.prototype.md=function(){this.h=!0;nh(this)};
function nh(b){if(0!=b.a.readyState){if(b.a.seeking){if(!b.i)return}else b.i=!1;if(!b.a.paused){b.a.readyState!=b.s&&(b.c=!1,b.s=b.a.readyState);var c=b.v.smallGapLimit,d=b.a.currentTime,e=b.a.buffered;a:{if(e&&e.length&&!(1==e.length&&1E-6>e.end(0)-e.start(0))){var f=xc("Edge/")||xc("Trident/")||xc("Tizen")||xc("CrKey")?.5:.1;for(var g=0;g<e.length;g++)if(e.start(g)>d&&(0==g||e.end(g-1)-d<=f)){f=g;break a}}f=null}if(null==f){if(b.b){b=b.b;d=b.g;e=jh(d);f=d.a.currentTime;g=Date.now()/1E3;if(b.a!=
f||b.h!=e)b.f=g,b.a=f,b.h=e,b.b=!1;f=g-b.f;f>=b.i&&e&&!b.b&&(b.c(b.a,f),b.b=!0,b.a=d.a.currentTime)}}else if(0!=f||b.h)if(g=e.start(f),!(g>=b.A.Ea())){var h=g-d;c=h<=c;var k=!1;if(!(.001>h)){if(!c&&!b.c){b.c=!0;var l=new J("largegap",{currentTime:d,gapSize:h});l.cancelable=!0;b.m(l);b.v.jumpLargeGaps&&!l.defaultPrevented?k=!0:B.info("Ignoring large gap at",d,"size",h)}if(c||k)0==f?B.info("Jumping forward",h,"seconds because of gap before start time of",g):B.info("Jumping forward",h,"seconds because of gap starting at",
e.end(f-1),"and ending at",g),b.a.currentTime=g}}}}};function oh(b){var c=this;this.c=b;this.a=new Set;this.b=(new D(function(){ph(c,!1)})).Qa(.25)}oh.prototype.release=function(){this.b.stop();for(var b=t(this.a),c=b.next();!c.done;c=b.next())c.value.release();this.a.clear()};function ph(b,c){for(var d=t(b.a),e=d.next();!e.done;e=d.next())e.value.g(b.c.currentTime,c)};function qh(b){var c=[];b=t(b);for(var d=b.next();!d.done;d=b.next()){d=t(d.value.variants);for(var e=d.next();!e.done;e=d.next())c.push(e.value)}return c}function rh(b,c){for(var d=null,e=t(b),f=e.next();!f.done;f=e.next())f=f.value,c>=f.startTime&&(d=f);return d};function sh(b){this.c=b;this.a=null;this.b=function(){}}sh.prototype.release=function(){this.a=this.c=null;this.b=function(){}};sh.prototype.g=function(b){var c=this.a,d=this.c.periods;b=rh(d,b)||d[0];c!=b&&this.b(b);this.a=b};function th(b,c){b.b=c};function uh(b){var c=this;this.a=b;this.f=!1;this.c=this.a.nc();this.b=new D(function(){c.a.be(.25*c.c)})}uh.prototype.release=function(){this.b&&(this.b.stop(),this.b=null);this.a=null};uh.prototype.set=function(b){this.c=b;vh(this)};function vh(b){b.b.stop();var c=b.f?0:b.c;if(0<=c)try{b.a.nc()!=c&&b.a.xd(c);return}catch(d){}b.b.Qa(.25);0!=b.a.nc()&&b.a.xd(0)};/*

 Copyright 2016 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/
function wh(b,c,d,e){c==HTMLMediaElement.HAVE_NOTHING||b.readyState>=c?e():(c=xh.get(c),d.ta(b,c,e))}var xh=new Map([[HTMLMediaElement.HAVE_METADATA,"loadedmetadata"],[HTMLMediaElement.HAVE_CURRENT_DATA,"loadeddata"],[HTMLMediaElement.HAVE_FUTURE_DATA,"canplay"],[HTMLMediaElement.HAVE_ENOUGH_DATA,"canplaythrough"]]);function yh(b,c,d){var e=this;this.a=b;this.g=c;this.f=d;this.h=!1;this.b=new L;this.c=new zh(b);wh(this.a,HTMLMediaElement.HAVE_METADATA,this.b,function(){Ah(e,e.f)})}yh.prototype.release=function(){this.b&&(this.b.release(),this.b=null);null!=this.c&&(this.c.release(),this.c=null);this.g=function(){};this.a=null};function Bh(b){return b.h?b.a.currentTime:b.f}function Ch(b,c){0<b.a.readyState?Dh(b.c,c):wh(b.a,HTMLMediaElement.HAVE_METADATA,b.b,function(){Ah(b,b.f)})}
function Ah(b,c){.001>Math.abs(b.a.currentTime-c)?Eh(b):(b.b.ta(b.a,"seeking",function(){Eh(b)}),Dh(b.c,0==b.a.currentTime?c:b.a.currentTime))}function Eh(b){b.h=!0;b.b.D(b.a,"seeking",function(){return b.g()})}function zh(b){var c=this;this.b=b;this.h=10;this.g=this.c=this.f=0;this.a=new D(function(){0>=c.f?(B.l(["Failed to move playhead from",c.c,"to",c.g].join(" ")),c.a.stop()):c.b.currentTime!=c.c?c.a.stop():(c.b.currentTime=c.g,c.f--)})}
zh.prototype.release=function(){this.a&&(this.a.stop(),this.a=null);this.b=null};function Dh(b,c){b.c=b.b.currentTime;b.g=c;b.f=b.h;b.b.currentTime=c;b.a.Qa(.1)};function Fh(b){function c(){null==d.c?d.f=!0:(d.b.ta(d.a,"seeking",function(){d.f=!0}),d.a.currentTime=Math.max(0,d.a.currentTime+d.c))}var d=this;this.a=b;this.f=!1;this.c=null;this.b=new L;wh(this.a,HTMLMediaElement.HAVE_CURRENT_DATA,this.b,function(){c()})}Fh.prototype.release=function(){this.b&&(this.b.release(),this.b=null);this.a=null};Fh.prototype.s=function(b){this.c=this.f?this.c:b};Fh.prototype.g=function(){return(this.f?this.a.currentTime:this.c)||0};Fh.prototype.v=function(){};
function Gh(b,c,d,e,f,g){var h=this;this.b=b;this.a=c.presentationTimeline;this.F=c.minBufferTime||0;this.h=d;this.A=f;this.m=null;this.f=new mh(b,c.presentationTimeline,d,Hh(b,d),g);this.c=new yh(b,function(){a:{var b=h.f;b.i=!0;b.h=!1;b.c=!1;b=Bh(h.c);var c=Ih(h,b);if(.001<Math.abs(c-b)){var d=(new Date).getTime()/1E3;if(!h.m||h.m<d-1){h.m=d;Ch(h.c,c);b=void 0;break a}}B.C("Seek to "+b);h.A();b=void 0}return b},Jh(this,e));this.i=(new D(function(){if(0!=h.b.readyState&&!h.b.paused){var b=h.b.currentTime,
c=h.a.tb(),d=h.a.Ea();3>d-c&&(c=d-3);b<c&&(c=Ih(h,b),B.info("Jumping forward "+(c-b)+" seconds to catch up with the seek range."),h.b.currentTime=c)}})).Qa(.25)}Gh.prototype.release=function(){this.c&&(this.c.release(),this.c=null);this.f&&(this.f.release(),this.f=null);this.i&&(this.i.stop(),this.i=null);this.b=this.c=this.a=this.h=null;this.A=function(){}};Gh.prototype.s=function(b){Ch(this.c,b)};Gh.prototype.g=function(){var b=Bh(this.c);return 0<this.b.readyState&&!this.b.paused?Kh(this,b):b};
function Jh(b,c){null==c?c=Infinity>b.a.aa()?b.a.tb():b.a.Ea():0>c&&(c=b.a.Ea()+c);return Lh(b,Kh(b,c))}Gh.prototype.v=function(){this.f.md()};function Lh(b,c){var d=b.a.aa();return c>=d?d-b.h.durationBackoff:c}
function Ih(b,c){var d=rd.bind(null,b.b.buffered),e=Math.max(b.F,b.h.rebufferingGoal),f=b.h.safeSeekOffset,g=b.a.tb(),h=b.a.Ea(),k=b.a.aa();3>h-g&&(g=h-3);var l=b.a.Qb(e),n=b.a.Qb(f);e=b.a.Qb(e+f);if(c>=k)return B.C("Playhead past duration."),Lh(b,c);if(c>h)return B.C("Playhead past end."),h;if(c<g){if(d(n))return B.C("Playhead before start & start is buffered"),n;B.C("Playhead before start & start is unbuffered");return e}if(c>=l||d(c))return B.C("Playhead in safe region or in buffered region."),
c;B.C("Playhead outside safe region & in unbuffered region.");return e}function Kh(b,c){var d=b.a.tb();if(c<d)return d;d=b.a.Ea();return c>d?d:c}function Hh(b,c){if(!c.stallEnabled)return null;var d=c.stallSkip,e=new ih(new lh(b),c.stallThreshold);kh(e,function(c,e){B.debug(["Stall detected at",c,"for",e,"seconds. Seeking forward",d,"seconds."].join(" "));b.currentTime+=d});return e};function Mh(){this.b=function(){};this.a=new Set}Mh.prototype.release=function(){this.b=function(){};this.a.clear()};function Nh(b,c){b.b=c};function Oh(b){var c=this;this.h=b;this.f=new Map;this.a=function(){};this.b=function(){};this.c=function(){};this.i=[{ib:null,hb:Ph,$a:function(b,e){return c.a(b,e)}},{ib:Qh,hb:Ph,$a:function(b,e){return c.a(b,e)}},{ib:Rh,hb:Ph,$a:function(b,e){return c.a(b,e)}},{ib:Ph,hb:Qh,$a:function(b,e){return c.b(b,e)}},{ib:Ph,hb:Rh,$a:function(b,e){return c.b(b,e)}},{ib:Qh,hb:Rh,$a:function(b,e){return c.c(b,e)}},{ib:Rh,hb:Qh,$a:function(b,e){return c.c(b,e)}}]}
Oh.prototype.release=function(){this.h=null;this.f.clear();this.a=function(){};this.b=function(){};this.c=function(){}};Oh.prototype.g=function(b,c){for(var d=t(this.h.a),e=d.next();!e.done;e=d.next()){e=e.value;var f=this.f.get(e),g=b<e.startTime?Qh:b>e.endTime?Rh:Ph;this.f.set(e,g);for(var h=t(this.i),k=h.next();!k.done;k=h.next())k=k.value,k.ib==f&&k.hb==g&&k.$a(e,c)}};function Sh(b,c,d,e){b.a=c;b.b=d;b.c=e}var Qh=1,Ph=2,Rh=3;function Th(b,c){this.a=c;this.c=b;this.g=null;this.m=1;this.A=Promise.resolve();this.h=[];this.i=new Map;this.b=new Map;this.v=!1;this.K=null;this.H=this.f=this.s=!1;this.F=0}Th.prototype.destroy=function(){for(var b=t(this.b.values()),c=b.next();!c.done;c=b.next())Uh(c.value);this.b.clear();this.i.clear();this.g=this.h=this.A=this.c=this.a=null;this.f=!0;return Promise.resolve()};
Th.prototype.configure=function(b){this.g=b;this.K=new zb({maxAttempts:Math.max(b.retryParameters.maxAttempts,2),baseDelay:b.retryParameters.baseDelay,backoffFactor:b.retryParameters.backoffFactor,fuzzFactor:b.retryParameters.fuzzFactor,timeout:0},!0)};
Th.prototype.start=function(){var b=this;return u(function d(){var e,f,g;return y(d,function(d){switch(d.j){case 1:return e=b.a.Ya(),f=Vh(b,e),g=b.a.ee(b.c.periods[f]),g.variant||g.text?v(d,Wh(b,g.variant?g.variant.audio:null,g.variant?g.variant.video:null,g.text,e),2):(B.error("init: no Streams chosen"),d["return"](new E(2,5,5005)));case 2:if(b.f)return d["return"]();B.debug("init: completed initial Stream setup");b.a&&b.a.pf&&(B.C("init: calling onInitialStreamsSetup()..."),b.a.pf());w(d)}})})};
function Xh(b){return Yh(b,"audio")}function Zh(b){return Yh(b,"video")}function Yh(b,c){var d=b.b.get(c);return d?d.Na||d.stream:null}
function $h(b,c){return u(function e(){var f,g,h,k,l,n,p,q,r,x;return y(e,function(e){switch(e.j){case 1:return f=yd,v(e,ne(b.a.N,f.ua),2);case 2:return b.F++,b.H=!1,g=b.F,h=b.a.N,k=new Map,l=new Set,k.set(f.ua,c),l.add(c),v(e,h.init(k,!1),3);case 3:return b.f?e["return"]():v(e,ai(b,l),4);case 4:if(b.f)return e["return"]();p=(n=b.a.N.g.isTextVisible())||b.g.alwaysStreamText;b.F!=g||b.b.has(f.ua)||b.H||!p||(q=b.a.Ya(),r=Vh(b,q),x=bi(c,r,0),b.b.set(f.ua,x),ci(b,x,0));w(e)}})})}
function di(b,c){var d=b.b.get("video");if(d){var e=d.stream;if(e)if(B.debug("setTrickPlay",c),c){var f=e.trickModeVideo;f&&!d.Na&&(B.debug("Engaging trick mode stream",f),ei(b,f,!1,0,!1),d.Na=e)}else if(e=d.Na)B.debug("Restoring non-trick-mode stream",e),d.Na=null,ei(b,e,!0,0,!1)}}function fi(b,c,d,e){var f=!1;if(c.video){var g=ei(b,c.video,d,e,!1);f=f||g}c.audio&&(b=ei(b,c.audio,d,e,!1),f=f||b);return f}
function ei(b,c,d,e,f){var g=b.b.get(c.type);if(!g&&"text"==c.type&&b.g.ignoreTextStreamFailures)return $h(b,c),!0;if(!g)return!1;var h=gi(b,c),k=Array.from(b.b.values()).every(function(b){return b.ja==g.ja});if(d&&h!=g.ja&&k)return B.debug("switch: switching to stream in another Period; clearing buffer and changing Periods"),b.b.forEach(function(c){hi(b,c)}),!0;g.Na&&(B.debug("switch during trick play mode",c),c.trickModeVideo?(g.Na=c,c=c.trickModeVideo,B.debug("switch found trick play stream",c)):
(g.Na=null,B.debug("switch found no special trick play stream")));k=b.h[h];if(!k||!k.Jb)return!1;k=b.i.get(c.id);if(!k||!k.Jb)return!1;if(g.stream==c&&!f)return B.debug("switch: Stream "+ii(g)+" already active"),!1;"text"==c.type&&ee(b.a.N,nc(c.mimeType,c.codecs));g.stream=c;g.rc=!0;B.debug("switch: switching to Stream "+ii(g));ji(b,g,h)&&(B.info("Aborting current segment request to switch."),g.Ub.abort());d&&(g.Va?g.Fc=!0:g.Ma?(g.Ra=!0,g.hc=e,g.Fc=!0):(Uh(g),ki(b,g,!0,e)["catch"](function(c){if(b.a)b.a.onError(c)})));
return!0}function ji(b,c,d){if(!c.Ub)return!1;var e=b.a.Ya(),f=ie(b.a.N,c.type),g=li(b,c,e,f,d);d=g?g.a?g.a-g.b:null:null;g&&!d&&(d=(g.endTime-g.oc())*c.stream.bandwidth/8);if(isNaN(d))return!1;(g=c.stream.initSegmentReference)&&(d+=(g.a?g.a-g.b:null)||0);g=b.a.getBandwidthEstimate();return 8*d/g<f-e-Math.max(b.c.minBufferTime||0,b.g.rebufferingGoal)||c.Ub.b.a>d?!0:!1}
function mi(b){function c(c){var f=b.a.N;"text"==c?(c=f.a,c=null==c.a||null==c.b?!1:d>=c.a&&d<c.b):(c=he(f,c),c=rd(c,d,e));return c}var d=b.a.Ya(),e=b.g.smallGapLimit,f=!1,g=Vh(b,d);if(kc(b.b.values(),function(b){return b.ja==g}))for(var h=t(b.b.keys()),k=h.next();!k.done;k=h.next())k=k.value,c(k)||(hi(b,b.b.get(k)),f=!0);else kc(b.b.keys(),c)||(B.debug("(all): seeked: unbuffered seek: clearing all buffers"),b.b.forEach(function(c){hi(b,c)}),f=!0);f||B.debug("(all): seeked: buffered seek: presentationTime="+
d)}function hi(b,c){var d=ii(c);c.Va?B.debug(d,"clear: already clearing the buffer"):c.Ra?B.debug(d,"clear: already waiting"):c.Ma?(B.debug(d,"clear: currently updating"),c.Ra=!0,c.hc=0):null==ge(b.a.N,c.type)?(B.debug(d,"clear: nothing buffered"),null==c.Ia&&ci(b,c,0)):(B.debug(d,"clear: handling right now"),Uh(c),ki(b,c,!1,0)["catch"](function(c){if(b.a)b.a.onError(c)}))}
function Wh(b,c,d,e,f){return u(function h(){var k,l,n,p,q,r,x;return y(h,function(h){switch(h.j){case 1:return k=b.a.Ya(),l=Vh(b,k),n=yd,p=new Map,q=new Set,c&&(p.set(n.Kb,c),q.add(c)),d&&(p.set(n.Ta,d),q.add(d)),e&&(p.set(n.ua,e),q.add(e)),r=b.a.N,x=b.g.forceTransmuxTS,v(h,r.init(p,x),2);case 2:if(b.f)return h["return"]();ni(b);return v(h,ai(b,q),3);case 3:if(b.f)return h["return"]();p.forEach(function(c,d){if(!b.b.has(d)){var e=bi(c,l,f);b.b.set(d,e);ci(b,e,0)}});w(h)}})})}
function bi(b,c,d){return{stream:b,type:b.type,zb:null,Fa:null,Na:null,rc:!0,ja:c,endOfStream:!1,Ma:!1,Ia:null,Ra:!1,hc:0,Fc:!1,Va:!1,pd:!1,Sb:!1,sd:d||0,Ub:null}}
function oi(b,c){var d=b.h[c];if(d)return B.debug("(all) Period "+c+" is being or has been set up"),d.promise;B.debug("(all) setting up Period "+c);d={promise:new G,Jb:!1};b.h[c]=d;for(var e=new Set,f=t(b.c.periods[c].variants),g=f.next();!g.done;g=f.next())g=g.value,g.video&&e.add(g.video),g.video&&g.video.trickModeVideo&&e.add(g.video.trickModeVideo),g.audio&&e.add(g.audio);f=t(b.c.periods[c].textStreams);for(g=f.next();!g.done;g=f.next())e.add(g.value);b.A=b.A.then(function(){if(!this.f)return ai(this,
e)}.bind(b)).then(function(){this.f||(this.h[c].promise.resolve(),this.h[c].Jb=!0,B.C("(all) setup Period "+c))}.bind(b))["catch"](function(b){this.f||(this.h[c].promise["catch"](function(){}),this.h[c].promise.reject(),delete this.h[c],B.l("(all) failed to setup Period "+c),this.a.onError(b))}.bind(b));return d.promise}
function ai(b,c){return u(function e(){var f,g,h,k,l,n,p;return y(e,function(e){switch(e.j){case 1:f=[];for(var q=t(c),x=q.next();!x.done;x=q.next())g=x.value,(h=b.i.get(g.id))?(B.debug("(all) Stream "+g.id+" is being or has been set up"),f.push(h.promise)):(B.C("(all) setting up Stream "+g.id),b.i.set(g.id,{promise:new G,Jb:!1}),f.push(g.createSegmentIndex()));Da(e,2);return v(e,Promise.all(f),4);case 4:if(b.f)return e["return"]();Fa(e,3);break;case 2:k=Ga(e);if(b.f)return e["return"]();e=t(c);for(x=
e.next();!x.done;x=e.next())l=x.value,b.i.get(l.id).promise["catch"](function(){}),b.i.get(l.id).promise.reject(),b.i["delete"](l.id);throw k;case 3:q=t(c);for(x=q.next();!x.done;x=q.next())n=x.value,p=b.i.get(n.id),p.Jb||(p.promise.resolve(),p.Jb=!0,B.C("(all) setup Stream "+n.id));w(e)}})})}function ni(b){var c=b.c.presentationTimeline.aa();Infinity>c?b.a.N.Aa(c):b.a.N.Aa(Math.pow(2,32))}
function pi(b,c){if(!b.f){var d=ii(c);if(!c.Ma&&null!=c.Ia&&!c.Va)if(c.Ia=null,c.Ra)B.debug(d,"skipping update and clearing the buffer"),ki(b,c,c.Fc,c.hc);else{try{var e=qi(b,c);null!=e&&(ci(b,c,e),c.Sb=!1)}catch(f){ri(b,f);return}e=Array.from(b.b.values());si(b,c);b.v&&e.every(function(b){return b.endOfStream})&&(B.C(d,"calling endOfStream()..."),b.a.N.endOfStream().then(function(){if(!this.f){var b=this.a.N.aa();0!=b&&b<this.c.presentationTimeline.aa()&&this.c.presentationTimeline.Aa(b)}}.bind(b)))}}}
function qi(b,c){if(ti(c))return me(b.a.N,c.stream.originalId||""),null;var d=ii(c),e=b.a.Ya(),f=ui(b,c,e);B.I(d,"timeNeeded="+f);var g=gi(b,c.stream),h=Vh(b,f),k=je(b.a.N,c.type,e);B.I(d,"update_:","presentationTime="+e,"bufferedAhead="+k);var l=Math.max(b.c.minBufferTime||0,b.g.rebufferingGoal,b.g.bufferingGoal)*b.m;if(f>=b.c.presentationTimeline.aa())return B.debug(d,"buffered to end of presentation"),c.endOfStream=!0,"video"==c.type&&(f=b.b.get("text"))&&"application/cea-608"==f.stream.mimeType&&
(f.endOfStream=!0),null;c.endOfStream=!1;c.ja=h;if(h!=g)return B.debug(d,"need Period "+h,"presentationTime="+e,"timeNeeded="+f,"currentPeriodIndex="+g),null;if(k>=l)return B.I(d,"buffering goal met"),.5;d=ie(b.a.N,c.type);d=li(b,c,e,d,g);if(!d)return 1;var n=Infinity;Array.from(b.b.values()).forEach(function(c){ti(c)||(c=ui(b,c,e),n=Math.min(n,c))});if(f>=n+b.c.presentationTimeline.a)return 1;c.sd=0;vi(b,c,e,g,d);return null}
function ui(b,c,d){if(!c.zb||!c.Fa)return Math.max(d,c.sd);d=gi(b,c.zb);return b.c.periods[d].startTime+c.Fa.endTime}
function li(b,c,d,e,f){var g=ii(c);if(c.Fa&&c.stream==c.zb)return e=c.Fa.position+1,B.I(g,"next position known:","position="+e),wi(b,c,f,e);c.Fa?(B.C(g,"next position unknown: another Stream buffered"),g=gi(b,c.zb),g=xi(b,c,b.c.periods[g].startTime+c.Fa.endTime,f)):(B.C(g,"next position unknown: nothing buffered"),g=xi(b,c,e||d,f));if(null==g)return null;d=null;null==e&&(d=wi(b,c,f,Math.max(0,g-1)));return d||wi(b,c,f,g)}
function xi(b,c,d,e){var f=ii(c);b=b.c.periods[e];B.debug(f,"looking up segment:","presentationTime="+d,"currentPeriod.startTime="+b.startTime);d=Math.max(0,d-b.startTime);c=c.stream.findSegmentPosition(d);null==c&&B.l(f,"cannot find segment:","currentPeriod.startTime="+b.startTime,"lookupTime="+d);return c}
function wi(b,c,d,e){var f=ii(c);d=b.c.periods[d];c=c.stream.getSegmentReference(e);if(!c)return B.C(f,"segment does not exist:","currentPeriod.startTime="+d.startTime,"position="+e),null;e=b.c.presentationTimeline;b=e.Rb();e=e.ub();return d.startTime+c.endTime<b||d.startTime+c.startTime>e?(B.I(f,"segment is not available:","currentPeriod.startTime="+d.startTime,"reference.startTime="+c.startTime,"reference.endTime="+c.endTime,"availabilityStart="+b,"availabilityEnd="+e),null):c}
function vi(b,c,d,e,f){var g=ii(c),h=b.c.periods[e];B.C(g,"fetchAndAppend_:","presentationTime="+d,"currentPeriod.startTime="+h.startTime,"reference.position="+f.position,"reference.startTime="+f.startTime,"reference.endTime="+f.endTime);var k=c.stream,l=b.c.presentationTimeline.aa(),n=b.c.periods[e+1];e=yi(b,c,e,Math.max(0,h.startTime-.1),n?n.startTime+.01:l);c.Ma=!0;c.rc=!1;B.I(g,"fetching segment");l=zi(b,c,f);Promise.all([e,l]).then(function(b){if(!this.f&&!this.s)return Ai(this,c,d,h,k,f,b[1])}.bind(b)).then(function(){this.f||
this.s||(c.Ma=!1,c.pd=!1,c.Ra||this.a.md(),ci(this,c,0),Bi(this,c,k),B.C(g,"finished fetch and append"))}.bind(b))["catch"](function(b){this.f||this.s||(c.Ma=!1,"text"==c.type&&this.g.ignoreTextStreamFailures?(1001==b.code?B.l(g,"Text stream failed to download. Proceeding without it."):B.l(g,"Text stream failed to parse. Proceeding without it."),this.b["delete"]("text")):7001==b.code?(c.Ma=!1,c.Ia=null,ci(this,c,0)):3017==b.code?Ci(this,c,b):(B.error(g,"failed fetch and append: code="+b.code),c.Sb=
!0,b.severity=2,ri(this,b)))}.bind(b))}
function Ci(b,c,d){var e=ii(c);if(Array.from(b.b.values()).some(function(b){return b!=c&&b.pd}))B.debug(e,"MediaSource threw QuotaExceededError:","waiting for another stream to recover...");else{var f=Math.round(100*b.m);if(20<f)b.m-=.2;else if(4<f)b.m-=.04;else{B.error(e,"MediaSource threw QuotaExceededError too many times");c.Sb=!0;b.s=!0;b.a.onError(d);return}B.l(e,"MediaSource threw QuotaExceededError:","reducing buffering goals by "+(100-Math.round(100*b.m))+"%");c.pd=!0}ci(b,c,4)}
function yi(b,c,d,e,f){if(!c.rc)return Promise.resolve();var g=ii(c);d=b.c.periods[d].startTime-c.stream.presentationTimeOffset;B.C(g,"setting timestamp offset to "+d);B.C(g,"setting append window start to "+e);B.C(g,"setting append window end to "+f);e=oe(b.a.N,c.type,d,e,f);if(!c.stream.initSegmentReference)return e;B.C(g,"fetching init segment");b=zi(b,c,c.stream.initSegmentReference).then(function(b){if(!this.f)return B.C(g,"appending init segment"),ke(this.a.N,c.type,b,null,null,c.stream.closedCaptions&&
0<c.stream.closedCaptions.size)}.bind(b))["catch"](function(b){c.rc=!0;return Promise.reject(b)});return Promise.all([e,b])}
function Ai(b,c,d,e,f,g,h){var k=ii(c),l=f.closedCaptions&&0<f.closedCaptions.size;null!=f.emsgSchemeIdUris&&0<f.emsgSchemeIdUris.length&&(new S).ha("emsg",b.O.bind(b,e,g,f.emsgSchemeIdUris)).parse(h);return Di(b,c,d).then(function(){if(!this.f)return B.C(k,"appending media segment"),ke(this.a.N,c.type,h,g.startTime+e.startTime,g.endTime+e.startTime,l)}.bind(b)).then(function(){if(!this.f)return B.I(k,"appended media segment"),c.zb=f,c.Fa=g,Promise.resolve()}.bind(b))}
Th.prototype.O=function(b,c,d,e){var f=e.reader.od(),g=e.reader.od(),h=e.reader.G(),k=e.reader.G(),l=e.reader.G(),n=e.reader.G();e=e.reader.eb(e.reader.M.byteLength-e.reader.fa());b=b.startTime+c.startTime+k/h;if(d.includes(f))if("urn:mpeg:dash:event:2012"==f)this.a.qf();else this.a.onEvent(new J("emsg",{detail:{startTime:b,endTime:b+l/h,schemeIdUri:f,value:g,timescale:h,presentationTimeDelta:k,eventDuration:l,id:n,messageData:e}}))};
function Di(b,c,d){var e=ii(c);B.I(e,"checking buffer length");var f=Math.max(b.g.bufferBehind,b.c.presentationTimeline.a),g=ge(b.a.N,c.type);if(null==g)return B.I(e,"buffer behind okay because nothing buffered:","presentationTime="+d,"bufferBehind="+f),Promise.resolve();var h=d-g,k=h-f;if(0>=k)return B.I(e,"buffer behind okay:","presentationTime="+d,"bufferedBehind="+h,"bufferBehind="+f,"underflow="+-k),Promise.resolve();B.C(e,"buffer behind too large:","presentationTime="+d,"bufferedBehind="+h,
"bufferBehind="+f,"overflow="+k);return b.a.N.remove(c.type,g,g+k).then(function(){this.f||B.C(e,"evicted "+k+" seconds")}.bind(b))}
function Bi(b,c,d){if(!b.v){var e=ii(c);c=Array.from(b.b.values());if(1!=c.length||"text"!=c[0].type)b.v=c.every(function(b){return"text"==b.type?!0:!b.Ra&&!b.Va&&b.Fa});if(b.v){B.debug(e,"startup complete");d=gi(b,d);b.h[d]||oi(b,d).then(function(){this.f||(B.C(e,"calling onCanSwitch()..."),this.a.de())}.bind(b))["catch"](vd.sc);for(d=0;d<b.c.periods.length;++d)oi(b,d)["catch"](vd.sc);b.a.wf&&(B.C(e,"calling onStartupComplete()..."),b.a.wf())}}}
function si(b,c){var d=ii(c),e=gi(b,c.stream);if(c.ja!=e){var f=c.ja,g=Array.from(b.b.values());g.every(function(b){return b.ja==f||ti(b)})?g.every(Ei)?(B.debug(d,"all need Period "+f),oi(b,f).then(function(){if(!this.f)if(g.every(function(b){var c=Ei(b),d=gi(this,b.stream);return ti(b)?!0:c&&b.ja==f&&d!=f}.bind(this))){var b=this.c.periods[f];B.C(d,"calling onChooseStreams()...");var c=this.a.ee(b),e=new Map;c.variant&&c.variant.video&&e.set("video",c.variant.video);c.variant&&c.variant.audio&&e.set("audio",
c.variant.audio);c.text&&e.set("text",c.text);c=t(this.b.keys());for(var n=c.next();!n.done;n=c.next())if(n=n.value,!e.has(n)&&"text"!=n){B.error(d,"invalid Streams chosen: missing "+n+" Stream");this.a.onError(new E(2,5,5005));return}c=t(Array.from(e.keys()));for(n=c.next();!n.done;n=c.next())if(n=n.value,!this.b.has(n))if("text"==n)Wh(this,null,null,e.get("text"),b.startTime),e["delete"](n);else{B.error(d,"invalid Streams chosen: unusable "+n+" Stream");this.a.onError(new E(2,5,5005));return}c=
t(Array.from(this.b.keys()));for(n=c.next();!n.done;n=c.next()){n=n.value;var p=this.b.get(n),q=e.get(n);if(q){var r=ti(p);r&&(p.ja=f,p.sd=b.startTime);ei(this,q,!1,0,!1);r&&ti(p)||ci(this,this.b.get(n),0)}else this.b["delete"](n)}B.C(d,"calling onCanSwitch()...");this.a.de()}else B.debug(d,"ignoring transition to Period",f,"since another is happening")}.bind(b))["catch"](vd.sc)):B.debug(d,"all MediaStates need Period "+f+", but not all MediaStates are idle"):B.debug(d,"not all MediaStates need Period "+
f)}}function ti(b){return b&&"text"==b.type&&"application/cea-608"==b.stream.mimeType}function Ei(b){return!b.Ma&&null==b.Ia&&!b.Ra&&!b.Va}function Vh(b,c){var d=rh(b.c.periods,c+zd);return d?b.c.periods.indexOf(d):0}
function gi(b,c){for(var d=b.c.periods,e=0;e<d.length;e++){for(var f=d[e],g=new Set,h=t(f.variants),k=h.next();!k.done;k=h.next())k=k.value,k.audio&&g.add(k.audio),k.video&&g.add(k.video),k.video&&k.video.trickModeVideo&&g.add(k.video.trickModeVideo);f=t(f.textStreams);for(h=f.next();!h.done;h=f.next())g.add(h.value);if(g.has(c))return e}return-1}
function zi(b,c,d){var e=vf(d.c(),d.b,d.a,b.g.retryParameters);B.I("fetching: reference=",d);b=b.a.Ab.request(1,e);c.Ub=b;return b.promise.then(function(b){c.Ub=null;return b.data})}
function ki(b,c,d,e){return u(function g(){var h,k,l,n;return y(g,function(g){switch(g.j){case 1:return h=ii(c),c.Ra=!1,c.Fc=!1,c.hc=0,c.Va=!0,B.debug(h,"clearing buffer"),e?(l=b.a.Ya(),n=b.a.N.aa(),k=b.a.N.remove(c.type,l+e,n)):k=ne(b.a.N,c.type).then(function(){if(!this.f&&d)return this.a.N.flush(c.type)}.bind(b)),v(g,k,2);case 2:if(b.f)return g["return"]();B.debug(h,"cleared buffer");c.zb=null;c.Fa=null;c.Va=!1;c.endOfStream=!1;ci(b,c,0);w(g)}})})}
function ci(b,c,d){B.I(ii(c),"updating in "+d+" seconds");c.Ia=(new yb(function(){return u(function f(){var d;return y(f,function(f){switch(f.j){case 1:return Da(f,2),v(f,pi(b,c),4);case 4:Fa(f,0);break;case 2:d=Ga(f);if(b.a)b.a.onError(d);w(f)}})})})).V(d)}function Uh(b){null!=b.Ia&&(b.Ia.stop(),b.Ia=null)}function ri(b,c){Bb(b.K).then(function(){this.f||(this.a.onError(c),c.handled||this.g.failureCallback(c))}.bind(b))}function ii(b){return"("+b.type+":"+b.stream.id+")"};function Fi(b,c,d,e,f,g){if(200<=d&&299>=d&&202!=d)return{uri:f||e,nd:e,data:c,headers:b,fromCache:!!b["x-shaka-from-cache"]};f=null;try{f=gc(c)}catch(h){}B.debug("HTTP error text:",f);throw new E(401==d||403==d?2:1,1,1001,e,d,f,b,g);};function Gi(b,c,d,e){var f=new Gi.b;lc(c.headers).forEach(function(b,c){f.append(c,b)});var g=new Gi.a,h={Id:!1,qe:!1};b=Gi.m(b,d,{body:c.body||void 0,headers:f,method:c.method,signal:g.signal,credentials:c.allowCrossSiteCredentials?"include":void 0},h,e);b=new I(b,function(){h.Id=!0;g.abort();return Promise.resolve()});if(c=c.retryParameters.timeout){var k=new D(function(){h.qe=!0;g.abort()});k.V(c/1E3);b["finally"](function(){k.stop()})}return b}A("shaka.net.HttpFetchPlugin",Gi);
Gi.m=function(b,c,d,e,f){return u(function h(){var k,l,n,p,q,r,x,C,z,H,F,P,wa,aa;return y(h,function(h){switch(h.j){case 1:return k=Gi.g,l=Gi.c,r=q=0,x=Date.now(),Da(h,2),v(h,k(b,d),4);case 4:return n=h.o,C=n.clone().body.getReader(),H=(z=n.headers.get("Content-Length"))?parseInt(z,10):0,F=function(b){function c(){return u(function ia(){var d,e,h;return y(ia,function(k){switch(k.j){case 1:return Da(k,2),v(k,C.read(),4);case 4:d=k.o;Fa(k,3);break;case 2:return e=Ga(k),B.C("error reading from stream",
e.message),k["return"]();case 3:d.done||(q+=d.value.byteLength);h=Date.now();if(100<h-x||d.done)f(h-x,q-r,H-q),r=q,x=h;d.done?b.close():(b.enqueue(d.value),c());w(k)}})})}c()},new l({start:F}),v(h,n.arrayBuffer(),5);case 5:p=h.o;Fa(h,3);break;case 2:P=Ga(h);if(e.Id)throw new E(1,1,7001,b,c);if(e.qe)throw new E(1,1,1003,b,c);throw new E(1,1,1002,b,P,c);case 3:return wa={},aa=n.headers,aa.forEach(function(b,c){wa[c.trim()]=b}),h["return"](Fi(wa,p,n.status,b,n.url,c))}})})};
Gi.isSupported=function(){if(window.ReadableStream)try{new ReadableStream({})}catch(b){return!1}else return!1;return!(!window.fetch||!window.AbortController)};Gi.isSupported=Gi.isSupported;Gi.g=window.fetch;Gi.a=window.AbortController;Gi.c=window.ReadableStream;Gi.b=window.Headers;Gi.isSupported()&&(Ub("http",Gi,2),Ub("https",Gi,2));function Hi(b,c,d,e){var f=new Hi.f,g=Date.now(),h=0,k=new Promise(function(k,n){f.open(c.method,b,!0);f.responseType="arraybuffer";f.timeout=c.retryParameters.timeout;f.withCredentials=c.allowCrossSiteCredentials;f.onabort=function(){n(new E(1,1,7001,b,d))};f.onload=function(c){c=c.target;var e=c.getAllResponseHeaders().trim().split("\r\n"),f={};e=t(e);for(var g=e.next();!g.done;g=e.next())g=g.value.split(": "),f[g[0].toLowerCase()]=g.slice(1).join(": ");try{var h=Fi(f,c.response,c.status,b,c.responseURL,
d);k(h)}catch(H){n(H)}};f.onerror=function(c){n(new E(1,1,1002,b,c,d))};f.ontimeout=function(){n(new E(1,1,1003,b,d))};f.onprogress=function(b){var c=Date.now();if(100<c-g||b.lengthComputable&&b.loaded==b.total)e(c-g,b.loaded-h,b.total-b.loaded),h=b.loaded,g=c};for(var l in c.headers)f.setRequestHeader(l.toLowerCase(),c.headers[l]);f.send(c.body)});return new I(k,function(){f.abort();return Promise.resolve()})}A("shaka.net.HttpXHRPlugin",Hi);Hi.f=window.XMLHttpRequest;Ub("http",Hi,1);
Ub("https",Hi,1);function Ii(){this.a=this.f=this.b=0;this.c=new Map;this.g=0}function Ji(b,c){b.b+=c;var d=b.g;b.g++;b.c.set(d,c);return d}Ii.prototype.close=function(b,c){if(this.c.has(b)){var d=this.c.get(b);this.c["delete"](b);this.f+=d;this.a+=c}};function Ki(b,c,d){this.h=b;this.b=new Map;this.c=!1;this.g=c;this.f=d;this.a=new Ii}Ki.prototype.destroy=function(){this.c=!0;return Promise.all(this.b.values()).then(function(){},function(){})};
function Li(b,c,d,e,f,g){var h=Ji(b.a,e);e=b.b.get(c)||Promise.resolve();b.b.set(c,e.then(function(){return u(function l(){var c,e,q,r,x,C;return y(l,function(l){switch(l.j){case 1:return v(l,Mi(b,d),2);case 2:c=l.o;if(b.c)throw new E(2,9,7001);if(f){e=new Uint8Array(c);q=new Ee(e);for(var n in q.data)r=Number(n),x=q.data[r],C=q.a[r],b.f(x,C)}b.a.close(h,c.byteLength);n=b.a;b.g(0==n.b?0:n.f/n.b,b.a.a);return l["return"](g(c))}})})}))}
function Ni(b){return u(function d(){return y(d,function(d){switch(d.j){case 1:return v(d,Promise.all(b.b.values()),2);case 2:return d["return"](b.a.a)}})})}function Mi(b,c){return u(function e(){var f,g;return y(e,function(e){switch(e.j){case 1:return f=b.h.request(1,c),v(e,f.promise,2);case 2:return g=e.o,e["return"](g.data)}})})};function Oi(b,c){var d=this;this.c=b;this.b=b.objectStore(c);this.a=new G;b.onabort=function(b){b.preventDefault();d.a.reject()};b.onerror=function(b){b.preventDefault();d.a.reject()};b.oncomplete=function(){d.a.resolve()}}Oi.prototype.abort=function(){try{this.c.abort()}catch(b){}return this.a["catch"](function(){})};
function Pi(b,c){return new Promise(function(d,e){var f=b.b.openCursor();f.onerror=e;f.onsuccess=function(b){b=b.target.result;if(!b)return d();c(b.key,b.value,b);b["continue"]()}})}Oi.prototype.store=function(){return this.b};Oi.prototype.promise=function(){return this.a};function Qi(b){this.b=b;this.a=[]}Qi.prototype.destroy=function(){return Promise.all(this.a.map(function(b){return b.abort()}))};function Ri(b,c){return Si(b,c,"readwrite")}function Si(b,c,d){d=b.b.transaction([c],d);var e=new Oi(d,c);b.a.push(e);e.promise().then(function(){Mb(b.a,e)},function(){Mb(b.a,e)});return e};function Ti(b,c,d){this.b=new Qi(b);this.c=c;this.a=d}m=Ti.prototype;m.destroy=function(){return this.b.destroy()};m.hasFixedKeySpace=function(){return!0};m.addSegments=function(){return Ui(this.c)};m.removeSegments=function(b,c){return Vi(this,this.c,b,c)};m.getSegments=function(b){var c=this;return u(function e(){var f;return y(e,function(e){switch(e.j){case 1:return v(e,Wi(c,c.c,b),2);case 2:return f=e.o,e["return"](f.map(function(b){return c.Kd(b)}))}})})};m.addManifests=function(){return Ui(this.a)};
m.updateManifestExpiration=function(b,c){var d=Ri(this.b,this.a),e=d.store();e.get(b).onsuccess=function(d){if(d=d.target.result)d.expiration=c,e.put(d,b)};return d.promise()};m.removeManifests=function(b,c){return Vi(this,this.a,b,c)};m.getManifests=function(b){var c=this;return u(function e(){var f;return y(e,function(e){switch(e.j){case 1:return v(e,Wi(c,c.a,b),2);case 2:return f=e.o,e["return"](f.map(function(b){return c.ic(b)}))}})})};
m.getAllManifests=function(){var b=this;return u(function d(){var e,f;return y(d,function(d){switch(d.j){case 1:return e=Si(b.b,b.a,"readonly"),f=new Map,v(d,Pi(e,function(d,e){f.set(d,b.ic(e))}),2);case 2:return v(d,e.promise(),3);case 3:return d["return"](f)}})})};m.Kd=function(b){return b};m.ic=function(b){return b};function Ui(b){return Promise.reject(new E(2,9,9011,"Cannot add new value to "+b))}
m.add=function(b,c){var d=this;return u(function f(){var g,h,k,l,n;return y(f,function(f){switch(f.j){case 1:g=Ri(d.b,b);h=g.store();k=[];for(var p=t(c),r=p.next();!r.done;r=p.next())l=r.value,n=h.add(l),n.onsuccess=function(b){k.push(b.target.result)};return v(f,g.promise(),2);case 2:return f["return"](k)}})})};
function Vi(b,c,d,e){b=Ri(b.b,c);c=b.store();var f={};d=t(d);for(var g=d.next();!g.done;f={key:f.key},g=d.next())f.key=g.value,c["delete"](f.key).onsuccess=function(b){return function(){return e(b.key)}}(f);return b.promise()}
function Wi(b,c,d){return u(function f(){var g,h,k,l,n,p,q;return y(f,function(f){switch(f.j){case 1:g=Si(b.b,c,"readonly");h=g.store();k={};l=[];n={};p=t(d);for(q=p.next();!q.done;n={request:n.request,key:n.key},q=p.next())n.key=q.value,n.request=h.get(n.key),n.request.onsuccess=function(b){return function(){void 0==b.request.result&&l.push(b.key);k[b.key]=b.request.result}}(n);return v(f,g.promise(),2);case 2:if(l.length)throw new E(2,9,9012,"Could not find values for "+l);return f["return"](d.map(function(b){return k[b]}))}})})}
;function Xi(b){this.a=new Qi(b)}Xi.prototype.destroy=function(){return this.a.destroy()};Xi.prototype.getAll=function(){var b=this;return u(function d(){var e,f;return y(d,function(d){switch(d.j){case 1:return e=Si(b.a,"session-ids","readonly"),f=[],v(d,Pi(e,function(b,d){f.push(d)}),2);case 2:return v(d,e.promise(),3);case 3:return d["return"](f)}})})};Xi.prototype.add=function(b){var c=Ri(this.a,"session-ids"),d=c.store();b=t(b);for(var e=b.next();!e.done;e=b.next())d.add(e.value);return c.promise()};
Xi.prototype.remove=function(b){var c=this;return u(function e(){var f;return y(e,function(e){switch(e.j){case 1:return f=Ri(c.a,"session-ids"),v(e,Pi(f,function(c,e,f){0<=b.indexOf(e.sessionId)&&f["delete"]()}),2);case 2:return v(e,f.promise(),0)}})})};function Yi(){this.a=new Map}Yi.prototype.destroy=function(){for(var b=[],c=t(this.a.values()),d=c.next();!d.done;d=c.next())b.push(d.value.destroy());this.a.clear();return Promise.all(b)};Yi.prototype.init=function(){var b=this;Zi.forEach(function(c,d){var e=c();e?b.a.set(d,e):B.info("Skipping "+d+" as it is not supported on this platform")});for(var c=[],d=t(this.a.values()),e=d.next();!e.done;e=d.next())c.push(e.value.init());return Promise.all(c)};
function $i(b){var c=null;b.a.forEach(function(b,e){b.getCells().forEach(function(b,d){b.hasFixedKeySpace()||c||(c={path:{za:e,ea:d},ea:b})})});if(c)return c;throw new E(2,9,9013,"Could not find a cell that supports add-operations");}function aj(b,c){b.a.forEach(function(b,e){b.getCells().forEach(function(b,d){c({za:e,ea:d},b)})})}
function bj(b,c,d){b=b.a.get(c);if(!b)throw new E(2,9,9013,"Could not find mechanism with name "+c);c=b.getCells().get(d);if(!c)throw new E(2,9,9013,"Could not find cell with name "+d);return c}function cj(b,c){b.a.forEach(function(b){c(b.getEmeSessionCell())})}function dj(b){var c=Array.from(b.a.keys());if(!c.length)throw new E(2,9,9E3,"No supported storage mechanisms found");return b.a.get(c[0]).getEmeSessionCell()}
Yi.prototype.erase=function(){var b=this;return u(function d(){var e,f,g;return y(d,function(d){switch(d.j){case 1:return e=Array.from(b.a.values()),f=0<e.length,f||(g=Zi,g.forEach(function(b){(b=b())&&e.push(b)})),v(d,Promise.all(e.map(function(b){return b.erase()})),2);case 2:if(f)d.B(0);else return v(d,Promise.all(e.map(function(b){return b.destroy()})),0)}})})};function ej(b,c){Zi.set(b,c)}A("shaka.offline.StorageMuxer.register",ej);A("shaka.offline.StorageMuxer.unregister",function(b){Zi["delete"](b)});
var Zi=new Map;function fj(b){Ti.apply(this,arguments)}ua(fj,Ti);fj.prototype.updateManifestExpiration=function(b,c){var d=Ri(this.b,this.a),e=d.store(),f=new G;e.get(b).onsuccess=function(d){(d=d.target.result)?(d.expiration=c,e.put(d),f.resolve()):f.reject(new E(2,9,9012,"Could not find values for "+b))};return d.promise().then(function(){return f})};
fj.prototype.ic=function(b){return{originalManifestUri:b.originalManifestUri,duration:b.duration,size:b.size,expiration:null==b.expiration?Infinity:b.expiration,periods:b.periods.map(gj),sessionIds:b.sessionIds,drmInfo:b.drmInfo,appMetadata:b.appMetadata}};function gj(b){hj(b);b.streams.forEach(function(){});return{startTime:b.startTime,streams:b.streams.map(ij)}}
function ij(b){var c=b.initSegmentUri?jj(b.initSegmentUri):null;return{id:b.id,originalId:null,primary:b.primary,presentationTimeOffset:b.presentationTimeOffset,contentType:b.contentType,mimeType:b.mimeType,codecs:b.codecs,frameRate:b.frameRate,pixelAspectRatio:void 0,kind:b.kind,language:b.language,label:b.label,width:b.width,height:b.height,initSegmentKey:c,encrypted:b.encrypted,keyId:b.keyId,segments:b.segments.map(kj),variantIds:b.variantIds}}
function kj(b){var c=jj(b.uri);return{startTime:b.startTime,endTime:b.endTime,dataKey:c}}fj.prototype.Kd=function(b){return{data:b.data}};function jj(b){var c;if((c=/^offline:[0-9]+\/[0-9]+\/([0-9]+)$/.exec(b))||(c=/^offline:segment\/([0-9]+)$/.exec(b)))return Number(c[1]);throw new E(2,9,9004,"Could not parse uri "+b);}
function hj(b){var c=b.streams.filter(function(b){return"audio"==b.contentType}),d=b.streams.filter(function(b){return"video"==b.contentType});if(!c.every(function(b){return b.variantIds})||!d.every(function(b){return b.variantIds})){c.forEach(function(b){b.variantIds=[]});d.forEach(function(b){b.variantIds=[]});var e=0;if(d.length&&!c.length){B.debug("Found video-only content. Creating variants for video.");var f=e++;d.forEach(function(b){b.variantIds.push(f)})}if(!d.length&&c.length){B.debug("Found audio-only content. Creating variants for audio.");
var g=e++;c.forEach(function(b){b.variantIds.push(g)})}d.length&&c.length&&(B.debug("Found audio-video content. Creating variants."),c.forEach(function(b){d.forEach(function(c){var d=e++;b.variantIds.push(d);c.variantIds.push(d)})}))}};function lj(b,c,d,e){Ti.call(this,b,c,d);this.f=e}ua(lj,Ti);lj.prototype.hasFixedKeySpace=function(){return this.f};lj.prototype.addSegments=function(b){return this.f?Ui(this.c):this.add(this.c,b)};lj.prototype.addManifests=function(b){return this.f?Ui(this.a):this.add(this.a,b)};lj.prototype.ic=function(b){null==b.expiration&&(b.expiration=Infinity);return b};function mj(){this.g=this.c=this.b=this.a=this.f=null}m=mj.prototype;
m.init=function(){var b=this,c=new G,d=window.indexedDB.open("shaka_offline_db",4);d.onsuccess=function(d){d=d.target.result;b.f=d;var e=d.objectStoreNames;e.contains("manifest")&&e.contains("segment")?(B.debug("Mounting v1 idb storage cell"),e=new fj(d,"segment","manifest")):e=null;b.a=e;e=d.objectStoreNames;e.contains("manifest-v2")&&e.contains("segment-v2")?(B.debug("Mounting v2 idb storage cell"),e=new lj(d,"segment-v2","manifest-v2",!0)):e=null;b.b=e;e=d.objectStoreNames;e.contains("manifest-v3")&&
e.contains("segment-v3")?(B.debug("Mounting v3 idb storage cell"),e=new lj(d,"segment-v3","manifest-v3",!1)):e=null;b.c=e;d.objectStoreNames.contains("session-ids")?(B.debug("Mounting session ID idb storage cell"),d=new Xi(d)):d=null;b.g=d;c.resolve()};d.onupgradeneeded=function(b){b=b.target.result;for(var c=t(["segment-v3","manifest-v3","session-ids"]),d=c.next();!d.done;d=c.next())d=d.value,b.objectStoreNames.contains(d)||b.createObjectStore(d,{autoIncrement:!0})};d.onerror=function(b){c.reject(new E(2,
9,9001,d.error));b.preventDefault()};return c};m.destroy=function(){var b=this;return u(function d(){return y(d,function(d){switch(d.j){case 1:if(!b.a){d.B(2);break}return v(d,b.a.destroy(),2);case 2:if(!b.b){d.B(4);break}return v(d,b.b.destroy(),4);case 4:if(!b.c){d.B(6);break}return v(d,b.c.destroy(),6);case 6:if(!b.g){d.B(8);break}return v(d,b.g.destroy(),8);case 8:b.f&&b.f.close(),w(d)}})})};
m.getCells=function(){var b=new Map;this.a&&b.set("v1",this.a);this.b&&b.set("v2",this.b);this.c&&b.set("v3",this.c);return b};m.getEmeSessionCell=function(){return this.g};
m.erase=function(){var b=this;return u(function d(){return y(d,function(d){switch(d.j){case 1:if(!b.a){d.B(2);break}return v(d,b.a.destroy(),2);case 2:if(!b.b){d.B(4);break}return v(d,b.b.destroy(),4);case 4:if(!b.c){d.B(6);break}return v(d,b.c.destroy(),6);case 6:return b.f&&b.f.close(),v(d,nj(),8);case 8:return b.f=null,b.a=null,b.b=null,b.c=null,v(d,b.init(),0)}})})};
function nj(){var b=new G,c=window.indexedDB.deleteDatabase("shaka_offline_db");c.onblocked=function(){B.l("Deleting","shaka_offline_db","is being blocked")};c.onsuccess=function(){b.resolve()};c.onerror=function(d){b.reject(new E(2,9,9001,c.error));d.preventDefault()};return b}ej("idb",function(){return window.indexedDB?new mj:null});function oj(b,c,d,e){this.a=b;this.g=c;this.f=d;this.c=e;this.b=["offline:",b,"/",c,"/",d,"/",e].join("")}oj.prototype.za=function(){return this.g};oj.prototype.ea=function(){return this.f};oj.prototype.key=function(){return this.c};oj.prototype.toString=function(){return this.b};
function pj(b){b=/^offline:([a-z]+)\/([^/]+)\/([^/]+)\/([0-9]+)$/.exec(b);if(null==b)return null;var c=b[1];if("manifest"!=c&&"segment"!=c)return null;var d=b[2];if(!d)return null;var e=b[3];return e&&null!=c?new oj(c,d,e,Number(b[4])):null};function qj(b,c){this.b=b;this.a=c}function rj(b,c){var d=new X(null,0);d.Aa(c.duration);var e=c.periods.map(function(c){return sj(b,c,d)}),f=c.drmInfo?[c.drmInfo]:[];c.drmInfo&&e.forEach(function(b){b.variants.forEach(function(b){b.drmInfos=f})});return{presentationTimeline:d,minBufferTime:2,offlineSessionIds:c.sessionIds,periods:e}}
function sj(b,c,d){var e=c.streams.filter(function(b){return"audio"==b.contentType}),f=c.streams.filter(function(b){return"video"==b.contentType});e=tj(b,e,f);f=c.streams.filter(function(b){return"text"==b.contentType}).map(function(c){return uj(b,c)});c.streams.forEach(function(e){e=e.segments.map(function(c,d){return vj(b,d,c)});d.Bb(e,c.startTime)});return{startTime:c.startTime,variants:Array.from(e.values()),textStreams:f}}
function tj(b,c,d){for(var e=new Set,f=t(c),g=f.next();!g.done;g=f.next()){var h=t(g.value.variantIds);for(g=h.next();!g.done;g=h.next())e.add(g.value)}f=t(d);for(g=f.next();!g.done;g=f.next())for(h=t(g.value.variantIds),g=h.next();!g.done;g=h.next())e.add(g.value);f=new Map;e=t(e);for(g=e.next();!g.done;g=e.next())g=g.value,f.set(g,{id:g,language:"",primary:!1,audio:null,video:null,bandwidth:0,drmInfos:[],allowedByApplication:!0,allowedByKeySystem:!0});c=t(c);for(e=c.next();!e.done;e=c.next())for(e=
e.value,g=uj(b,e),h=t(e.variantIds),e=h.next();!e.done;e=h.next())e=f.get(e.value),e.language=g.language,e.primary=e.primary||g.primary,e.audio=g;d=t(d);for(c=d.next();!c.done;c=d.next())for(e=c.value,c=uj(b,e),g=t(e.variantIds),e=g.next();!e.done;e=g.next())e=f.get(e.value),e.primary=e.primary||c.primary,e.video=c;return f}
function uj(b,c){var d=c.segments.map(function(c,d){return vj(b,d,c)}),e=new V(d);d={id:c.id,originalId:c.originalId,createSegmentIndex:function(){return Promise.resolve()},findSegmentPosition:function(b){return e.find(b)},getSegmentReference:function(b){return e.get(b)},initSegmentReference:null,presentationTimeOffset:c.presentationTimeOffset,mimeType:c.mimeType,codecs:c.codecs,width:c.width||void 0,height:c.height||void 0,frameRate:c.frameRate||void 0,pixelAspectRatio:c.pixelAspectRatio||void 0,
kind:c.kind,encrypted:c.encrypted,keyId:c.keyId,language:c.language,label:c.label||null,type:c.contentType,primary:c.primary,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,audioSamplingRate:null,closedCaptions:null};null!=c.initSegmentKey&&(d.initSegmentReference=wj(b,c.initSegmentKey));return d}function vj(b,c,d){var e=new oj("segment",b.b,b.a,d.dataKey);return new U(c,d.startTime,d.endTime,function(){return[e.toString()]},0,null)}
function wj(b,c){var d=new oj("segment",b.b,b.a,c);return new Ve(function(){return[d.toString()]},0,null)};function xj(){this.a=null}m=xj.prototype;m.configure=function(){};
m.start=function(b){var c=this;return u(function e(){var f,g,h,k,l,n;return y(e,function(e){switch(e.j){case 1:f=pj(b);c.a=f;if(null==f||"manifest"!=f.a)return e["return"](Promise.reject(new E(2,1,9004,f)));g=new Yi;Ea(e,2);return v(e,g.init(),4);case 4:return v(e,bj(g,f.za(),f.ea()),5);case 5:return h=e.o,v(e,h.getManifests([f.key()]),6);case 6:return k=e.o,l=k[0],n=new qj(f.za(),f.ea()),e["return"](rj(n,l));case 2:return Ha(e),v(e,g.destroy(),7);case 7:Ia(e,0)}})})};m.stop=function(){return Promise.resolve()};
m.update=function(){};
m.onExpirationUpdated=function(b,c){var d=this;return u(function f(){var g,h,k,l,n,p,q,r;return y(f,function(f){switch(f.j){case 1:return g=d.a,h=new Yi,Da(f,2,3),v(f,h.init(),5);case 5:return v(f,bj(h,g.za(),g.ea()),6);case 6:return k=f.o,v(f,k.getManifests([g.key()]),7);case 7:l=f.o;n=l[0];p=n.sessionIds.includes(b);q=void 0==n.expiration||n.expiration>c;if(!p||!q){f.B(3);break}B.debug("Updating expiration for stored content");return v(f,k.updateManifestExpiration(g.key(),c),3);case 3:return Ha(f),
v(f,h.destroy(),10);case 10:Ia(f,0);break;case 2:r=Ga(f),B.error("There was an error updating",g,r),f.B(3)}})})};W.Ib("application/x-offline-manifest",xj);function yj(b){var c=pj(b);return c&&"manifest"==c.a?yj.h(b):c&&"segment"==c.a?yj.i(c.key(),c):Cb(new E(2,1,9004,b))}A("shaka.offline.OfflineScheme",yj);yj.h=function(b){b={uri:b,nd:b,data:new ArrayBuffer(0),headers:{"content-type":"application/x-offline-manifest"}};return Eb(b)};yj.i=function(b,c){var d=new Yi;return Eb(void 0).X(function(){return d.init()}).X(function(){return bj(d,c.za(),c.ea())}).X(function(b){return b.getSegments([c.key()])}).X(function(b){return{uri:c,nd:c,data:b[0].data,headers:{}}})["finally"](function(){return d.destroy()})};
Ub("offline",yj);function zj(b,c,d){return u(function f(){var g,h,k,l,n,p;return y(f,function(f){switch(f.j){case 1:g=[];for(var q=[],x=t(d),C=x.next();!C.done;C=x.next()){C=C.value;for(var z=!1,H=t(q),F=H.next();!F.done;F=H.next())if(F=F.value,Aj(F.info,C)){F.sessionIds.push(C.sessionId);z=!0;break}z||q.push({info:C,sessionIds:[C.sessionId]})}h=t(q);k=h.next();case 2:if(k.done){f.B(4);break}l=k.value;n=Bj(b,c,l);return v(f,n,5);case 5:p=f.o;g=g.concat(p);k=h.next();f.B(2);break;case 4:return f["return"](g)}})})}
function Bj(b,c,d){return u(function f(){var g,h,k,l;return y(f,function(f){switch(f.j){case 1:return g=new Gc({Ab:c,onError:function(){},uc:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),Da(f,2),g.configure(b),v(f,Oc(g,d.info.keySystem,d.info.licenseUri,d.info.serverCertificate,d.info.audioCapabilities,d.info.videoCapabilities),4);case 4:Fa(f,3);break;case 2:return h=Ga(f),B.l("Error initializing EME",h),v(f,g.destroy(),5);case 5:return f["return"]([]);case 3:return Da(f,6),
v(f,Vc(g),8);case 8:Fa(f,7);break;case 6:return k=Ga(f),B.l("Error setting server certificate",k),v(f,g.destroy(),9);case 9:return f["return"]([]);case 7:return l=[],v(f,Promise.all(d.sessionIds.map(function(b){return u(function r(){var c;return y(r,function(d){switch(d.j){case 1:return Da(d,2),v(d,Yc(g,b),4);case 4:l.push(b);Fa(d,0);break;case 2:c=Ga(d),B.l("Error deleting offline session",c),w(d)}})})})),10);case 10:return v(f,g.destroy(),11);case 11:return f["return"](l)}})})}
function Aj(b,c){function d(b,c){return b.robustness==c.robustness&&b.contentType==c.contentType}return b.keySystem==c.keySystem&&b.licenseUri==c.licenseUri&&Ob(b.audioCapabilities,c.audioCapabilities,d)&&Ob(b.videoCapabilities,c.videoCapabilities,d)};function Cj(b,c){var d=Dj(),e=this;this.h=c;this.c=b;this.f=d;this.i=null;this.g=[];this.b=this.a=null;this.m=!0;this.s=Promise.resolve().then(function(){return Ej(e)})}Cj.prototype.destroy=function(){var b=this;return u(function d(){var e;return y(d,function(d){switch(d.j){case 1:return b.m=!1,b.b&&b.b.abort(),Fj(b),v(d,b.s,2);case 2:b.a&&b.a.ya.cb();for(var f=t(b.g),h=f.next();!h.done;h=f.next())e=h.value,e.ya.cb();b.a=null;b.g=[];b.h=null;w(d)}})})};
function Gj(b,c){var d={Cb:function(){},tc:function(){},cb:function(){},onError:function(){},vc:function(){},pg:function(){}};b.g.push({create:c,ya:d});b.b&&b.b.abort();Fj(b);return d}
function Ej(b){return u(function d(){return y(d,function(d){switch(d.j){case 1:if(b.m){if(0==b.g.length||b.a&&!b.a.Za)var e=!1;else{b.a&&(b.a.ya.cb(),b.a=null);e=b.g.shift();var g=e.create(b.f);g?(e.ya.Cb(),b.a={node:g.node,payload:g.payload,Za:g.Za,ya:e.ya}):e.ya.vc();e=!0}e?e=Promise.resolve():b.a?e=Hj(b):(b.h.nf(b.c),b.i=new G,e=b.i);return v(d,e,1)}d.B(0)}})})}
function Hj(b){return u(function d(){var e,f;return y(d,function(d){switch(d.j){case 1:return b.c=b.h.Ve(b.c,b.f,b.a.node,b.a.payload),Da(d,2),b.b=b.h.De(b.c,b.f,b.a.payload),v(d,b.b.promise,4);case 4:b.b=null;b.c==b.a.node&&(b.a.ya.tc(),b.a=null);Fa(d,0);break;case 2:e=Ga(d);if(7001==e.code)b.a.ya.cb();else b.a.ya.onError(e);b.a=null;b.b=null;f=b;return v(d,b.h.handleError(b.f,e),5);case 5:f.c=d.o,w(d)}})})}function Fj(b){b.i&&(b.i.resolve(),b.i=null)};function Ij(b){this.a=null;for(var c=0;c<b.textTracks.length;++c){var d=b.textTracks[c];d.mode="disabled";"Shaka Player TextTrack"==d.label&&(this.a=d)}this.a||(this.a=b.addTextTrack("subtitles","Shaka Player TextTrack"));this.a.mode="hidden"}A("shaka.text.SimpleTextDisplayer",Ij);Ij.prototype.remove=function(b,c){if(!this.a)return!1;Jj(this.a,function(d){return d.startTime<c&&d.endTime>b});return!0};Ij.prototype.remove=Ij.prototype.remove;
Ij.prototype.append=function(b){var c=Kj,d=[];b=t(b);for(var e=b.next();!e.done;e=b.next())e=e.value,e.nestedCues.length?d=d.concat(e.nestedCues):d.push(e);var f=[];b=this.a.cues?Array.from(this.a.cues):[];e={};d=t(d);for(var g=d.next();!g.done;e={xb:e.xb},g=d.next())e.xb=g.value,b.some(function(b){return function(c){return c.startTime==b.xb.startTime&&c.endTime==b.xb.endTime&&c.text==b.xb.payload?!0:!1}}(e))||(g=c(e.xb))&&f.push(g);f.slice().sort(function(b,c){return b.startTime!=c.startTime?b.startTime-
c.startTime:b.endTime!=c.endTime?b.endTime-c.startTime:f.indexOf(c)-f.indexOf(b)}).forEach(function(b){this.a.addCue(b)}.bind(this))};Ij.prototype.append=Ij.prototype.append;Ij.prototype.destroy=function(){this.a&&Jj(this.a,function(){return!0});this.a=null;return Promise.resolve()};Ij.prototype.destroy=Ij.prototype.destroy;Ij.prototype.isTextVisible=function(){return"showing"==this.a.mode};Ij.prototype.isTextVisible=Ij.prototype.isTextVisible;
Ij.prototype.setTextVisibility=function(b){this.a.mode=b?"showing":"hidden"};Ij.prototype.setTextVisibility=Ij.prototype.setTextVisibility;
function Kj(b){if(b.startTime>=b.endTime)return B.l("Invalid cue times: "+b.startTime+" - "+b.endTime),null;var c=new VTTCue(b.startTime,b.endTime,b.payload);c.lineAlign=b.lineAlign;c.positionAlign=b.positionAlign;b.size&&(c.size=b.size);try{c.align=b.textAlign}catch(d){}"center"==b.textAlign&&"center"!=c.align&&(c.align="middle");"vertical-lr"==b.writingMode?c.vertical="lr":"vertical-rl"==b.writingMode&&(c.vertical="rl");1==b.lineInterpretation&&(c.snapToLines=!1);null!=b.line&&(c.line=b.line);null!=
b.position&&(c.position=b.position);return c}function Jj(b,c){var d=b.mode;b.mode="showing"==d?"showing":"hidden";for(var e=b.cues,f=e.length-1;0<=f;f--){var g=e[f];g&&c(g)&&b.removeCue(g)}b.mode=d};function Lj(b,c,d,e,f){var g=f in e,h=!0,k;for(k in c){var l=f+"."+k,n=g?e[f]:d[k];g||k in d?void 0===c[k]?void 0===n||g?delete b[k]:b[k]=Kb(n):n.constructor==Object&&c[k]&&c[k].constructor==Object?(b[k]||(b[k]=Kb(n)),l=Lj(b[k],c[k],n,e,l),h=h&&l):typeof c[k]!=typeof n||null==c[k]||"function"!=typeof c[k]&&c[k].constructor!=n.constructor?(B.fc("Invalid config, wrong type for "+l),h=!1):("function"==typeof d[k]&&d[k].length!=c[k].length&&B.da("Unexpected number of arguments for "+l),b[k]=c[k]):(B.fc("Invalid config, unrecognized key "+
l),h=!1)}return h}A("shaka.util.ConfigUtils.mergeConfigObjects",Lj);function Mj(b,c){for(var d={},e=d,f=0,g=0;;){f=b.indexOf(".",f);if(0>f)break;if(0==f||"\\"!=b[f-1])g=b.substring(g,f).replace(/\\\./g,"."),e[g]={},e=e[g],g=f+1;f+=1}e[b.substring(g).replace(/\\\./g,".")]=c;return d}A("shaka.util.ConfigUtils.convertToConfigObject",Mj);function Nj(){}A("shaka.util.PlayerConfiguration",Nj);
function Oj(){var b=5E5,c=Infinity;navigator.connection&&(b=1E6*navigator.connection.downlink,navigator.connection.saveData&&(c=360));var d={retryParameters:Ab(),servers:{},clearKeys:{},advanced:{},delayLicenseRequestUntilPlayed:!1,initDataTransform:fd,fairPlayTransform:!0,updateExpirationTime:1},e={retryParameters:Ab(),availabilityWindowOverride:NaN,disableAudio:!1,disableVideo:!1,disableText:!1,dash:{customScheme:function(b){if(b)return null},clockSyncUri:"",ignoreDrmInfo:!1,xlinkFailGracefully:!1,
defaultPresentationDelay:10,ignoreMinBufferTime:!1,autoCorrectDrift:!0,ignoreSuggestedPresentationDelay:!1,ignoreEmptyAdaptationSet:!1},hls:{ignoreTextStreamFailures:!1,useFullSegmentsForStartTime:!1}},f={retryParameters:Ab(),failureCallback:function(b){B.error("Unhandled streaming error",b);return[b]},rebufferingGoal:2,bufferingGoal:10,bufferBehind:30,ignoreTextStreamFailures:!1,alwaysStreamText:!1,startAtSegmentBoundary:!1,smallGapLimit:.5,jumpLargeGaps:!1,durationBackoff:1,forceTransmuxTS:!1,safeSeekOffset:5,
stallEnabled:!0,stallThreshold:1,stallSkip:.1,useNativeHlsOnSafari:!0};xc("Web0S")&&(f.stallEnabled=!1);var g={trackSelectionCallback:function(b){return u(function n(){return y(n,function(c){switch(c.j){case 1:return c["return"](b)}})})},progressCallback:function(b,c){return[b,c]},usePersistentLicense:!0},h={drm:d,manifest:e,streaming:f,offline:g,abrFactory:Q,abr:{enabled:!0,defaultBandwidthEstimate:b,switchInterval:8,bandwidthUpgradeTarget:.85,bandwidthDowngradeTarget:.95,restrictions:{minWidth:0,
maxWidth:Infinity,minHeight:0,maxHeight:c,minPixels:0,maxPixels:Infinity,minFrameRate:0,maxFrameRate:Infinity,minBandwidth:0,maxBandwidth:Infinity}},preferredAudioLanguage:"",preferredTextLanguage:"",preferredVariantRole:"",preferredTextRole:"",preferredAudioChannelCount:2,restrictions:{minWidth:0,maxWidth:Infinity,minHeight:0,maxHeight:Infinity,minPixels:0,maxPixels:Infinity,minFrameRate:0,maxFrameRate:Infinity,minBandwidth:0,maxBandwidth:Infinity},playRangeStart:0,playRangeEnd:Infinity,textDisplayFactory:function(){return null}};
g.trackSelectionCallback=function(b){return u(function n(){return y(n,function(c){switch(c.j){case 1:return c["return"](Pj(b,h.preferredAudioLanguage))}})})};return h}function Qj(b,c,d){var e={".drm.servers":"",".drm.clearKeys":"",".drm.advanced":{distinctiveIdentifierRequired:!1,persistentStateRequired:!1,videoRobustness:"",audioRobustness:"",serverCertificate:new Uint8Array(0),individualizationServer:""}};return Lj(b,c,d||Oj(),e,"")}Nj.mergeConfigObjects=Qj;
function Pj(b,c){var d=b.filter(function(b){return"variant"==b.type}),e=[],f=ve(c,d.map(function(b){return b.language}));f&&(e=d.filter(function(b){return N(b.language)==f}));0==e.length&&(e=d.filter(function(b){return b.primary}));0==e.length&&(1<(new Set(d.map(function(b){return b.language}))).size&&B.l("Could not choose a good audio track based on language preferences or primary tracks.  An arbitrary language will be stored!"),e=d);var g=e.filter(function(b){return b.height&&480>=b.height});g.length&&
(g.sort(function(b,c){return c.height-b.height}),e=g.filter(function(b){return b.height==g[0].height}));d=[];if(e.length){var h=Math.floor(e.length/2);e.sort(function(b,c){return b.bandwidth-c.bandwidth});d.push(e[h])}e=t(b);for(h=e.next();!h.done;h=e.next())h=h.value,"text"==h.type&&d.push(h);return d};function Rj(){this.a=null;this.b=[]}function Sj(b,c){if(null==b.a)b.a={timestamp:Date.now()/1E3,state:c,duration:0};else{var d=Date.now()/1E3;b.a.duration=d-b.a.timestamp;b.a.state!=c&&(b.b.push(b.a),b.a={timestamp:d,state:c,duration:0})}}function Tj(b,c){var d=0;b.a&&b.a.state==c&&(d+=b.a.duration);for(var e=t(b.b),f=e.next();!f.done;f=e.next())f=f.value,d+=f.state==c?f.duration:0;return d}
function Uj(b){function c(b){return{timestamp:b.timestamp,state:b.state,duration:b.duration}}for(var d=[],e=t(b.b),f=e.next();!f.done;f=e.next())d.push(c(f.value));b.a&&d.push(c(b.a));return d};function Vj(){this.b=this.c=null;this.a=[]};function Wj(){this.f=this.v=this.h=this.b=this.i=this.m=this.s=this.g=this.A=NaN;this.a=new Rj;this.c=new Vj};function Y(b,c){var d=this;Jb.call(this);this.i=Xj;this.a=null;this.mb=!1;this.g=new L;this.Gc=this.m=this.kb=this.c=this.v=this.f=this.ec=this.F=this.bc=this.K=this.ob=this.s=this.H=this.h=this.U=null;this.ae=1E9;this.cc=new Set;this.qb=!0;this.ra=null;this.Wd=!1;this.Sd=0;this.qa=null;this.ca=new Sg;this.b=Yj(this);this.dc={width:Infinity,height:Infinity};this.A=null;this.Lb=new ah(this.b.preferredAudioLanguage,this.b.preferredVariantRole,this.b.preferredAudioChannelCount);this.pa=this.b.preferredTextLanguage;
this.lb=this.b.preferredTextRole;this.Hc=[];c&&c(this);this.U=Zj(this);this.g.D(window,"online",function(){d.td()});this.O={name:"detach"};this.W={name:"attach"};this.Ja={name:"unload"};this.Qc={name:"manifest-parser"};this.Oc={name:"manifest"};this.nb={name:"media-source"};this.Ic={name:"drm-engine"};this.Y={name:"load"};this.Vc={name:"src-equals-drm-engine"};this.pb={name:"src-equals"};var e=new Map;e.set(this.W,function(b,c){return Fb(ak(d,b,c))});e.set(this.O,function(b){b.u&&(d.g.oa(b.u,"error"),
b.u=null);d.a=null;b=Promise.resolve();return Fb(b)});e.set(this.Ja,function(b){return Fb(bk(d,b))});e.set(this.nb,function(b){b=ck(d,b);return Fb(b)});e.set(this.Qc,function(b,c){var e=dk(d,b,c);return Fb(e)});e.set(this.Oc,function(b){return ek(d,b)});e.set(this.Ic,function(){var b=fk(d);return Fb(b)});e.set(this.Y,function(b,c){return Fb(gk(d,b,c))});e.set(this.Vc,function(b){b=hk(d,b);return Fb(b)});e.set(this.pb,function(b,c){return ik(d,b,c)});this.Sa=new Cj(this.O,{Ve:function(b,c,e,k){var f=
null;b==d.O&&(f=e==d.O?d.O:d.W);b==d.W&&(f=e==d.O||c.u!=k.u?d.O:e==d.W?d.W:e==d.nb||e==d.Y?d.nb:e==d.pb?d.Vc:null);b==d.nb&&(f=e==d.Y&&c.u==k.u?d.Qc:d.Ja);b==d.Qc&&(f=jk(d.Y,d.Oc,d.Ja,e,c,k));b==d.Oc&&(f=jk(d.Y,d.Ic,d.Ja,e,c,k));b==d.Ic&&(f=jk(d.Y,d.Y,d.Ja,e,c,k));b==d.Vc&&(f=e==d.pb&&c.u==k.u?d.pb:d.Ja);if(b==d.Y||b==d.pb)f=d.Ja;b==d.Ja&&(f=k.u&&c.u==k.u?d.W:d.O);return f},De:function(b,c,h){d.dispatchEvent(new J("onstatechange",{state:b.name}));return e.get(b)(c,h)},handleError:function(b,c){return u(function k(){return y(k,
function(e){switch(e.j){case 1:return B.l("The walker saw an error:"),c instanceof E?B.l("Error Code:",c.code):(B.l("Error Message:",c.message),B.l("Error Stack:",c.stack)),v(e,bk(d,b),2);case 2:return e["return"](b.u?d.W:d.O)}})})},nf:function(b){d.dispatchEvent(new J("onstateidle",{state:b.name}))}});b&&this.Mb(b,!0)}$a(Y,Jb);A("shaka.Player",Y);
Y.prototype.destroy=function(){var b=this;return u(function d(){var e;return y(d,function(d){switch(d.j){case 1:if(b.i==kk)return d["return"]();b.i=kk;e=Gj(b.Sa,function(){return{node:b.O,payload:Dj(),Za:!1}});return v(d,new Promise(function(d){e.Cb=function(){B.info("Preparing to destroy walker...")};e.tc=function(){d();b.dispatchEvent(new J("loaded"))};e.cb=function(){d()};e.onError=function(){d()};e.vc=function(){d()}}),2);case 2:return v(d,b.Sa.destroy(),3);case 3:b.g&&(b.g.release(),b.g=null);
b.Gc=null;b.m=null;b.b=null;if(!b.U){d.B(0);break}return v(d,b.U.destroy(),5);case 5:b.U=null,w(d)}})})};Y.prototype.destroy=Y.prototype.destroy;Y.version="v2.5.12";var lk=["2","5"];Nf=new function(b){this.a=b;this.c=Of;this.b=Pf}(new Lf(Number(lk[0]),Number(lk[1])));var mk=["output-restricted","internal-error"],nk={};Y.registerSupportPlugin=function(b,c){nk[b]=c};
Y.isBrowserSupported=function(){if(!(window.Promise&&window.Uint8Array&&Array.prototype.forEach))return!1;var b=yc();return b&&12>b||!(window.MediaKeys&&window.navigator&&window.navigator.requestMediaKeySystemAccess&&window.MediaKeySystemAccess&&window.MediaKeySystemAccess.prototype.getConfiguration)?!1:rc()?!0:sc("application/x-mpegurl")};
Y.probeSupport=function(){return ld().then(function(b){for(var c=W.Gf(),d={},e=t('video/mp4; codecs="avc1.42E01E",video/mp4; codecs="avc3.42E01E",video/mp4; codecs="hev1.1.6.L93.90",video/mp4; codecs="hvc1.1.6.L93.90",video/mp4; codecs="hev1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="hvc1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="vp9",video/mp4; codecs="vp09.00.10.08",video/mp4; codecs="av01.0.01M.08",audio/mp4; codecs="mp4a.40.2",audio/mp4; codecs="ac-3",audio/mp4; codecs="ec-3",audio/mp4; codecs="opus",audio/mp4; codecs="flac",video/webm; codecs="vp8",video/webm; codecs="vp9",video/webm; codecs="vp09.00.10.08",audio/webm; codecs="vorbis",audio/webm; codecs="opus",video/mp2t; codecs="avc1.42E01E",video/mp2t; codecs="avc3.42E01E",video/mp2t; codecs="hvc1.1.6.L93.90",video/mp2t; codecs="mp4a.40.2",video/mp2t; codecs="ac-3",video/mp2t; codecs="ec-3",text/vtt,application/mp4; codecs="wvtt",application/ttml+xml,application/mp4; codecs="stpp"'.split(",")),f=
e.next();!f.done;f=e.next()){f=f.value;d[f]=rc()?Xd(f)?!0:MediaSource.isTypeSupported(f)||Bd(f):sc(f);var g=f.split(";")[0];d[g]=d[g]||d[f]}b={manifest:c,media:d,drm:b};for(var h in nk)b[h]=nk[h]();return b})};Y.prototype.Mb=function(b,c){c=void 0===c?!0:c;if(this.i==kk)return Promise.reject(ok());var d=Dj();d.u=b;rc()||(c=!1);var e=c?this.nb:this.W,f=Gj(this.Sa,function(){return{node:e,payload:d,Za:!1}});f.Cb=function(){return B.info("Starting attach...")};return pk(f)};Y.prototype.attach=Y.prototype.Mb;
Y.prototype.detach=function(){var b=this;if(this.i==kk)return Promise.reject(ok());var c=Gj(this.Sa,function(){return{node:b.O,payload:Dj(),Za:!1}});c.Cb=function(){return B.info("Starting detach...")};return pk(c)};Y.prototype.detach=Y.prototype.detach;
Y.prototype.bg=function(b){var c=this;b=void 0===b?!0:b;if(this.i==kk)return Promise.reject(ok());rc()||(b=!1);var d=Dj(),e=Gj(this.Sa,function(e){var f=e.u&&b?c.nb:e.u?c.W:c.O;d.u=e.u;return{node:f,payload:d,Za:!1}});e.Cb=function(){return B.info("Starting unload...")};return pk(e)};Y.prototype.unload=Y.prototype.bg;
Y.prototype.load=function(b,c,d){if(this.i==kk)return Promise.reject(ok());this.dispatchEvent(new J("loading"));var e=Dj();e.uri=b;e.Ad=Date.now()/1E3;d&&"string"!=typeof d&&(Mf("Loading with a manifest parser factory","Please register a manifest parser and for the mime-type."),e.Ca=function(){return new d});d&&"string"==typeof d&&(e.mimeType=d);void 0!==c&&(e.startTime=c);var f=qk(this,e)?this.pb:this.Y,g=Gj(this.Sa,function(b){if(null==b.u)return null;e.u=b.u;return{node:f,payload:e,Za:!0}});g.Cb=
function(){return B.info("Starting load of "+b+"...")};return new Promise(function(b,c){g.vc=function(){return c(new E(2,7,7002))};g.tc=function(){return b()};g.cb=function(){return c(ok())};g.onError=function(b){return c(b)}})};Y.prototype.load=Y.prototype.load;
function qk(b,c){if(c.Ca)return!1;if(!rc())return!0;var d=c.mimeType,e=c.uri||"";d||(d={mp4:"video/mp4",m4v:"video/mp4",m4a:"audio/mp4",webm:"video/webm",weba:"audio/webm",mkv:"video/webm",ts:"video/mp2t",ogv:"video/ogg",ogg:"audio/ogg",mpg:"video/mpeg",mpeg:"video/mpeg",m3u8:"application/x-mpegurl",mp3:"audio/mpeg",aac:"audio/aac",flac:"audio/flac",wav:"audio/wav"}[W.getExtension(e)]);return d?""==(c.u||vc()).canPlayType(d)?!1:W.isSupported(e,d)?wc()&&b.b.streaming.useNativeHlsOnSafari:!0:!1}
function ak(b,c,d){null==c.u&&(c.u=d.u,b.g.D(c.u,"error",function(){var c=rk(b);c&&b.Pa(c)}));b.a=c.u;return Promise.resolve()}
function bk(b,c){return u(function e(){var f;return y(e,function(e){switch(e.j){case 1:return b.i!=kk&&(b.i=Xj),f=b.Hc.map(function(b){return b()}),b.Hc=[],v(e,Promise.all(f),2);case 2:b.dispatchEvent(new J("unloading"));c.Ca=null;c.mimeType=null;c.startTime=null;c.uri=null;c.u&&(b.g.oa(c.u,"loadedmetadata"),b.g.oa(c.u,"playing"),b.g.oa(c.u,"pause"),b.g.oa(c.u,"ended"),b.g.oa(c.u,"ratechange"));b.ob&&(b.ob.release(),b.ob=null);b.bc&&(b.bc.stop(),b.bc=null);if(!b.v){e.B(3);break}return v(e,b.v.stop(),
4);case 4:b.v=null;case 3:if(!b.m){e.B(5);break}return v(e,b.m.stop(),5);case 5:if(!b.f){e.B(7);break}return v(e,b.f.destroy(),8);case 8:b.f=null;case 7:b.K&&(b.K.release(),b.K=null);b.s&&(b.s.release(),b.s=null);if(!b.H){e.B(9);break}return v(e,b.H.destroy(),10);case 10:b.H=null;case 9:if(!c.u||!c.u.src){e.B(11);break}return v(e,new Promise(function(b){return(new D(b)).V(.1)}),12);case 12:c.u.removeAttribute("src"),c.u.load();case 11:if(!b.h){e.B(13);break}return v(e,b.h.destroy(),14);case 14:b.h=
null;case 13:b.ca.a.clear(),b.kb=null,b.F=null,b.cc.clear(),b.c=null,b.A=null,b.Jc=null,b.qb=!0,sk(b),w(e)}})})}function ck(b,c){return u(function e(){var f,g,h,k;return y(e,function(e){switch(e.j){case 1:return f=window.muxjs?new od:new pd,g=b.b.textDisplayFactory,h=new g,b.Jc=g,k=new be(c.u,f,h),v(e,k.v,2);case 2:b.H=k,w(e)}})})}
function dk(b,c,d){return u(function f(){var g,h,k,l;return y(f,function(f){switch(f.j){case 1:c.Ca=d.Ca;c.mimeType=d.mimeType;c.uri=d.uri;g=c.uri;h=b.U;b.kb=g;if(c.Ca){b.v=c.Ca();f.B(2);break}k=b;return v(f,W.create(g,h,b.b.manifest.retryParameters,c.mimeType),3);case 3:k.v=f.o;case 2:l=Kb(b.b.manifest),d.u&&"AUDIO"===d.u.nodeName&&(l.disableVideo=!0),b.v.configure(l),w(f)}})})}
function ek(b,c){var d=c.uri,e=b.U;b.ec=new Mh;Nh(b.ec,function(c){tk(b,"timelineregionadded",c)});var f={networkingEngine:e,filterNewPeriod:function(c){return b.Rc(c)},filterAllPeriods:function(c){return uk(b,c)},onTimelineRegionAdded:function(c){var d=b.ec;a:{var e=t(d.a);for(var f=e.next();!f.done;f=e.next())if(f=f.value,f.schemeIdUri==c.schemeIdUri&&f.id==c.id&&f.startTime==c.startTime&&f.endTime==c.endTime){e=f;break a}e=null}null==e&&(d.a.add(c),d.b(c))},onEvent:function(c){return b.dispatchEvent(c)},
onError:function(c){return b.Pa(c)}};return new I(Promise.resolve().then(function(){return u(function h(){var c;return y(h,function(e){switch(e.j){case 1:return c=b,v(e,b.v.start(d,f),2);case 2:c.c=e.o;b.dispatchEvent(new J("manifestparsed"));if(0==b.c.periods.length)throw new E(2,4,4014);vk(b.c.periods);w(e)}})})}),function(){B.info("Aborting parser step...");return b.v.stop()})}
function fk(b){return u(function d(){return y(d,function(d){switch(d.j){case 1:return b.h=wk(b,{Ab:b.U,onError:function(d){b.Pa(d)},uc:function(d){xk(b,d)},onExpirationUpdated:function(d,e){yk(b,d,e)},onEvent:function(d){b.dispatchEvent(d)}}),b.h.configure(b.b.drm),v(d,Nc(b.h,qh(b.c.periods),b.c.offlineSessionIds),2);case 2:uk(b,b.c.periods),w(d)}})})}
function gk(b,c,d){return u(function f(){var g,h,k,l,n,p,q,r,x,C;return y(f,function(f){switch(f.j){case 1:return c.startTime=d.startTime,g=c.u,h=c.uri,b.kb=h,b.K=new uh({nc:function(){return c.u.playbackRate},xd:function(b){c.u.playbackRate=b},be:function(b){c.u.currentTime+=b}}),b.A=new Wj,k=function(){return zk(b)},l=function(){return Ak(b)},b.g.D(g,"playing",k),b.g.D(g,"pause",k),b.g.D(g,"ended",k),b.g.D(g,"ratechange",l),n=b.b.abrFactory,b.m&&b.Gc==n||(b.Gc=n,b.m=new n,b.m.configure(b.b.abr)),
Bk(b,b.c.periods),b.Lb=new ah(b.b.preferredAudioLanguage,b.b.preferredVariantRole,b.b.preferredAudioChannelCount),b.pa=b.b.preferredTextLanguage,Ck(b.c.presentationTimeline,b.b.playRangeStart,b.b.playRangeEnd),v(f,b.h.Mb(g),2);case 2:return b.m.init(function(c,d,f){d=void 0===d?!1:d;f=void 0===f?0:f;B.debug("switch_");a:{var g=t(b.c.periods);for(var h=g.next();!h.done;h=g.next())if(h=h.value,h.variants.includes(c)){g=h;break a}g=null}Dk(b,g,c,!0);b.f&&fi(b.f,c,d,f)&&Ek(b)}),b.s=Fk(b,c.startTime),
b.ob=Gk(b),p=Math.max(b.c.minBufferTime,b.b.streaming.rebufferingGoal),Hk(b,p),b.f=Ik(b),b.f.configure(b.b.streaming),O.Jd(b.c,b.b.preferredAudioChannelCount),b.i=Jk,b.dispatchEvent(new J("streaming")),v(f,b.f.start(),3);case 3:b.b.streaming.startAtSegmentBoundary&&(q=b.s.g(),r=Kk(b,q),b.s.s(r)),b.c.periods.forEach(b.Rc.bind(b)),Lk(b),Ek(b),x=Mk(b)||b.c.periods[0],C=x.variants.some(function(b){return b.primary}),b.b.preferredAudioLanguage||C||B.l("No preferred audio language set.  We will choose an arbitrary language initially"),
Nk(b,x.variants),b.g.ta(g,"loadedmetadata",function(){b.A.b=Date.now()/1E3-d.Ad}),w(f)}})})}
function hk(b,c){return u(function e(){var f,g;return y(e,function(e){switch(e.j){case 1:return f=yd,b.h=wk(b,{Ab:b.U,onError:function(c){b.Pa(c)},uc:function(c){xk(b,c)},onExpirationUpdated:function(c,e){yk(b,c,e)},onEvent:function(c){b.dispatchEvent(c)}}),b.h.configure(b.b.drm),g={id:0,language:"und",primary:!1,audio:null,video:{id:0,originalId:null,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return null},getSegmentReference:function(){return null},initSegmentReference:null,
presentationTimeOffset:0,mimeType:"video/mp4",codecs:"",encrypted:!0,keyId:null,language:"und",label:null,type:f.Ta,primary:!1,frameRate:void 0,pixelAspectRatio:void 0,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,audioSamplingRate:null,closedCaptions:null},bandwidth:100,drmInfos:[],allowedByApplication:!0,allowedByKeySystem:!0},v(e,Nc(b.h,[g],[]),2);case 2:return v(e,b.h.Mb(c.u),0)}})})}
function ik(b,c,d){function e(){return zk(b)}c.uri=d.uri;c.startTime=d.startTime;b.kb=c.uri;b.A=new Wj;b.s=new Fh(c.u);null!=c.startTime&&b.s.s(c.startTime);b.K=new uh({nc:function(){return c.u.playbackRate},xd:function(b){c.u.playbackRate=b},be:function(b){c.u.currentTime+=b}});Hk(b,b.b.streaming.rebufferingGoal);b.g.D(c.u,"playing",e);b.g.D(c.u,"pause",e);b.g.D(c.u,"ended",e);b.g.D(c.u,"ratechange",function(){return Ak(b)});"none"!=b.a.preload&&b.g.ta(c.u,"loadedmetadata",function(){b.A.b=Date.now()/
1E3-d.Ad});b.a.audioTracks&&(b.g.D(b.a.audioTracks,"addtrack",function(){return Lk(b)}),b.g.D(b.a.audioTracks,"removetrack",function(){return Lk(b)}),b.g.D(b.a.audioTracks,"change",function(){return Lk(b)}));if(b.a.textTracks){var f=b.a.textTracks;b.g.D(f,"addtrack",function(){return Lk(b)});b.g.D(f,"removetrack",function(){return Lk(b)});b.g.D(f,"change",function(){return Lk(b)})}c.u.src=c.uri;b.i=Ok;b.dispatchEvent(new J("streaming"));var g=new G;wh(b.a,HTMLMediaElement.HAVE_METADATA,b.g,function(){g.resolve()});
var h=!1;b.Hc.push(function(){h=!0});wh(b.a,HTMLMediaElement.HAVE_CURRENT_DATA,b.g,function(){return u(function l(){var c;return y(l,function(d){switch(d.j){case 1:if(h)return d["return"]();Pk(b);c=Qk(b);if(c.find(function(b){return"disabled"!=b.mode})){d.B(2);break}return v(d,new Promise(function(c){b.g.ta(b.a.textTracks,"change",c);(new D(c)).V(1)}),2);case 2:if(h)return d["return"]();Rk(b);w(d)}})})});b.a.error?g.reject(rk(b)):"none"==b.a.preload&&(B.da('With <video preload="none">, the browser will not load anything until play() is called. We are unable to measure load latency in a meaningful way, and we cannot provide track info yet. Please do not use preload="none" with Shaka Player.'),
g.resolve());b.g.ta(b.a,"error",function(){g.reject(rk(b))});return new I(g,function(){g.reject(new E(2,7,7001));return Promise.resolve()})}function Pk(b){var c=b.b.preferredAudioLanguage;if(""!=c){b.ud(c);var d=b.b.preferredVariantRole;""!=d&&b.ud(c,d)}}function Rk(b){var c=b.b.preferredTextLanguage;if(""!=c){b.vd(c);var d=b.b.preferredTextRole;""!=d&&b.vd(c,d)}}
function vk(b){function c(b){return b.video&&b.audio||b.video&&b.video.codecs.includes(",")}b.some(function(b){return b.variants.some(c)})&&(B.debug("Found variant with audio and video content, so filtering out audio-only content in all periods."),b.forEach(function(b){b.variants=b.variants.filter(c)}))}function wk(b,c){return new Gc(c,b.b.drm.updateExpirationTime)}function Zj(b){return new K(function(c,d){b.m&&b.m.segmentDownloaded(c,d)})}
function Fk(b,c){return new Gh(b.a,b.c,b.b.streaming,c,function(){b.ob&&ph(b.ob,!0);b.f&&mi(b.f);b.F&&Sk(b)},function(c){return b.dispatchEvent(c)})}function Gk(b){var c=new sh(b.c);th(c,function(){Lk(b)});var d=new Oh(b.ec);Sh(d,function(c){tk(b,"timelineregionenter",c)},function(c){tk(b,"timelineregionexit",c)},function(c,d){d||(tk(b,"timelineregionenter",c),tk(b,"timelineregionexit",c))});var e=new oh(b.a);e.a.add(c);e.a.add(d);return e}
function Hk(b,c){b.F=new eh;b.F.a=gh;hh(b.F,c,Math.min(.5,c/2));sk(b);b.bc=(new D(function(){Sk(b)})).Qa(.25)}function Sk(b){switch(b.i){case Ok:var c=b.a.ended?!0:qd(b.a.buffered)>=b.a.duration-1;break;case Jk:a:if(b.a.ended||fe(b.H))c=!0;else{if(b.c.presentationTimeline.ga()){var d=b.c.presentationTimeline.ub();if(qd(b.a.buffered)>=d){c=!0;break a}}c=!1}break;default:c=!1}var e=sd(b.a.buffered,b.a.currentTime);d=b.F;var f=c,g=d.b.get(d.a);c=d.a;e=f||e>=g?fh:gh;d.a=e;c!=e&&sk(b)}
function Ik(b){return new Th(b.c,{Ya:function(){return b.s.g()},getBandwidthEstimate:function(){return b.m.getBandwidthEstimate()},N:b.H,Ab:b.U,ee:b.mf.bind(b),de:b.ye.bind(b),onError:b.Pa.bind(b),onEvent:function(c){return b.dispatchEvent(c)},qf:b.rf.bind(b),md:b.vf.bind(b)})}Y.prototype.configure=function(b,c){2==arguments.length&&"string"==typeof b&&(b=Mj(b,c));var d=Qj(this.b,b,Yj(this));Tk(this);return d};Y.prototype.configure=Y.prototype.configure;
function Tk(b){if(b.v){var c=Kb(b.b.manifest);b.a&&"AUDIO"===b.a.nodeName&&(c.disableVideo=!0);b.v.configure(c)}b.h&&b.h.configure(b.b.drm);if(b.f){b.f.configure(b.b.streaming);try{b.c.periods.forEach(b.Rc.bind(b))}catch(g){b.Pa(g)}var d=Xh(b.f),e=Zh(b.f);c=Mk(b);d=O.Rd(d,e,c.variants);b.m&&d&&d.allowedByApplication&&d.allowedByKeySystem?Nk(b,c.variants):(B.debug("Choosing new streams after changing configuration"),Uk(b,c))}if(b.H&&(c=b.b.textDisplayFactory,b.Jc!=c)){d=new c;e=b.H;var f=e.g;e.g=d;
f&&(d.setTextVisibility(f.isTextVisible()),f.destroy());e.a&&(e.a.c=d);b.Jc=c;b.f&&(c=b.f,(d=c.b.get("text"))&&ei(c,d.stream,!0,0,!0))}b.m&&(b.m.configure(b.b.abr),b.b.abr.enabled&&!b.qb?b.m.enable():b.m.disable(),Vk(b));b.F&&(c=b.b.streaming.rebufferingGoal,b.c&&(c=Math.max(c,b.c.minBufferTime)),hh(b.F,c,Math.min(.5,c/2)))}Y.prototype.getConfiguration=function(){var b=Yj(this);Qj(b,this.b,Yj(this));return b};Y.prototype.getConfiguration=Y.prototype.getConfiguration;
Y.prototype.Nf=function(){for(var b in this.b)delete this.b[b];Qj(this.b,Yj(this),Yj(this));Tk(this)};Y.prototype.resetConfiguration=Y.prototype.Nf;Y.prototype.Oe=function(){return this.i};Y.prototype.getLoadMode=Y.prototype.Oe;Y.prototype.Te=function(){return this.a};Y.prototype.getMediaElement=Y.prototype.Te;Y.prototype.mc=function(){return this.U};Y.prototype.getNetworkingEngine=Y.prototype.mc;Y.prototype.He=function(){return this.kb};Y.prototype.getAssetUri=Y.prototype.He;
Y.prototype.Re=function(){Mf("getManifestUri",'Please use "getAssetUri" instead.');return this.kb};Y.prototype.getManifestUri=Y.prototype.Re;Y.prototype.ga=function(){return this.c?this.c.presentationTimeline.ga():this.a&&this.a.src?Infinity==this.a.duration:!1};Y.prototype.isLive=Y.prototype.ga;Y.prototype.ab=function(){return this.c?this.c.presentationTimeline.ab():!1};Y.prototype.isInProgress=Y.prototype.ab;
Y.prototype.hf=function(){if(this.c){if(!this.c.periods.length)return!1;var b=this.c.periods[0].variants;return b.length?!b[0].video:!1}return this.a&&this.a.src?this.a.videoTracks?0==this.a.videoTracks.length:0==this.a.videoHeight:!1};Y.prototype.isAudioOnly=Y.prototype.hf;Y.prototype.Pf=function(){if(this.c){var b=this.c.presentationTimeline;return{start:b.tb(),end:b.Ea()}}return this.a&&this.a.src&&(b=this.a.seekable,b.length)?{start:b.start(0),end:b.end(b.length-1)}:{start:0,end:0}};
Y.prototype.seekRange=Y.prototype.Pf;Y.prototype.keySystem=function(){return ad(this.drmInfo())};Y.prototype.keySystem=Y.prototype.keySystem;Y.prototype.drmInfo=function(){return this.h?this.h.a:null};Y.prototype.drmInfo=Y.prototype.drmInfo;Y.prototype.Pb=function(){return this.h?this.h.Pb():Infinity};Y.prototype.getExpiration=Y.prototype.Pb;Y.prototype.Yd=function(){return this.F?this.F.a==gh:!1};Y.prototype.isBuffering=Y.prototype.Yd;
Y.prototype.Xe=function(){if(this.K){var b=this.K;b=b.f?0:b.c}else b=0;return b};Y.prototype.getPlaybackRate=Y.prototype.Xe;Y.prototype.ag=function(b){0==b?B.da("A trick play rate of 0 is unsupported!"):(this.a.paused&&this.a.play(),this.K&&this.K.set(b),this.i==Jk&&di(this.f,1<Math.abs(b)))};Y.prototype.trickPlay=Y.prototype.ag;Y.prototype.ze=function(){this.i==Ok&&this.K.set(1);this.i==Jk&&(this.K.set(1),di(this.f,!1))};Y.prototype.cancelTrickPlay=Y.prototype.ze;
Y.prototype.Zc=function(){if(this.c&&this.s){for(var b=Wk(this),c=[],d=t(Xk(this)),e=d.next();!e.done;e=d.next()){e=e.value;var f=O.Ed(e);f.active=e==b;c.push(f)}return c}return this.a&&this.a.audioTracks?Array.from(this.a.audioTracks).map(function(b){return O.Td(b)}):[]};Y.prototype.getVariantTracks=Y.prototype.Zc;
Y.prototype.wb=function(){if(this.c&&this.s){for(var b=Yk(this),c=[],d=t(Zk(this)),e=d.next();!e.done;e=d.next()){e=e.value;var f=O.Bc(e);f.active=e==b;c.push(f)}return c}return this.a&&this.a.src&&this.a.textTracks?Qk(this).map(function(b){return O.ff(b)}):[]};Y.prototype.getTextTracks=Y.prototype.wb;
Y.prototype.wd=function(b){if(this.c&&this.f){var c=Mk(this),d=c.textStreams.find(function(c){return c.id==b.id});d?($k(this,c,d,!1),al(this,d),this.pa=d.language):B.error("No stream with id",b.id)}else if(this.a&&this.a.src&&this.a.textTracks){c=Qk(this);c=t(c);for(d=c.next();!d.done;d=c.next())d=d.value,O.$c(d)==b.id?d.mode=this.mb?"showing":"hidden":d.mode="disabled";bl(this)}};Y.prototype.selectTextTrack=Y.prototype.wd;
Y.prototype.Qf=function(){Mf("selectEmbeddedTextTrack","If closed captions are signaled in the manifest, a text stream will be created to represent them. Please use SelectTextTrack.");var b=this.wb().filter(function(b){return"application/cea-608"==b.mimeType});0<b.length?this.wd(b[0]):B.l("Unable to find the text track embedded in the video.")};Y.prototype.selectEmbeddedTextTrack=Y.prototype.Qf;
Y.prototype.gg=function(){Mf("usingEmbeddedTextTrack","If closed captions are signaled in the manifest, a text stream will be created to represent them. There should be no reason to know if the player is playing embedded text.");var b=this.wb().filter(function(b){return b.active})[0];return b?"application/cea-608"==b.mimeType:!1};Y.prototype.usingEmbeddedTextTrack=Y.prototype.gg;
Y.prototype.Rf=function(b,c,d){d=void 0===d?0:d;if(this.c&&this.f){var e=Mk(this);this.b.abr.enabled&&B.da("Changing tracks while abr manager is enabled will likely result in the selected track being overriden. Consider disabling abr before calling selectVariantTrack().");var f=e.variants.find(function(c){return c.id==b.id});f?O.yb(f)?(Dk(this,e,f,!1),cl(this,f,c,d),this.Lb=new $g(f),Nk(this,e.variants)):B.error("Unable to switch to restricted track",b.id):B.error("No variant with id",b.id)}else if(this.a&&
this.a.audioTracks){c=Array.from(this.a.audioTracks);c=t(c);for(d=c.next();!d.done;d=c.next())d=d.value,O.$c(d)==b.id&&(d.enabled=!0);dl(this)}};Y.prototype.selectVariantTrack=Y.prototype.Rf;Y.prototype.Je=function(){return el(this.Zc())};Y.prototype.getAudioLanguagesAndRoles=Y.prototype.Je;Y.prototype.cf=function(){return el(this.wb())};Y.prototype.getTextLanguagesAndRoles=Y.prototype.cf;Y.prototype.Ie=function(){return Array.from(fl(this.Zc()))};Y.prototype.getAudioLanguages=Y.prototype.Ie;
Y.prototype.bf=function(){return Array.from(fl(this.wb()))};Y.prototype.getTextLanguages=Y.prototype.bf;Y.prototype.ud=function(b,c){if(this.c&&this.s){var d=Mk(this);this.Lb=new ah(b,c||"",0,"","audio");gl(this,d)}else if(this.a&&this.a.audioTracks){var e=Array.from(this.a.audioTracks);d=N(b);e=t(e);for(var f=e.next();!f.done;f=e.next()){f=f.value;var g=O.Td(f);N(g.language)!=d||c&&!g.roles.includes(c)||(f.enabled=!0)}dl(this)}};Y.prototype.selectAudioLanguage=Y.prototype.ud;
Y.prototype.vd=function(b,c){if(this.c&&this.s){var d=Mk(this);this.pa=b;this.lb=c||"";var e=O.Ob(d.textStreams,this.pa,this.lb)[0]||null;e&&($k(this,d,e,!1),(this.b.streaming.alwaysStreamText||this.qc())&&al(this,e))}else{var f=N(b);(d=this.wb().filter(function(b){return N(b.language)==f&&(!c||b.roles.includes(c))})[0])&&this.wd(d)}};Y.prototype.selectTextLanguage=Y.prototype.vd;
Y.prototype.Sf=function(b){if(this.c&&this.s){for(var c=Mk(this),d=null,e=t(Xk(this)),f=e.next();!f.done;f=e.next())if(f=f.value,f.audio.label==b){d=f;break}null==d?B.l("No variants were found with label: "+b+". Ignoring the request to switch."):(this.Lb=new ah(d.language,"",0,b),gl(this,c))}};Y.prototype.selectVariantsByLabel=Y.prototype.Sf;
Y.prototype.qc=function(){var b=this.mb;return this.H?this.H.g.isTextVisible():this.a&&this.a.src&&this.a.textTracks?Qk(this).some(function(b){return"showing"==b.mode}):b};Y.prototype.isTextTrackVisible=Y.prototype.qc;function Qk(b){return Array.from(b.a.textTracks).filter(function(b){return"metadata"!=b.kind&&"Shaka Player TextTrack"!=b.label})}
Y.prototype.Wf=function(b){var c=this;return u(function e(){var f,g,h,k,l,n;return y(e,function(e){switch(e.j){case 1:f=c.mb;g=!!b;if(f==g)return e["return"]();c.mb=g;if(c.i!=Jk){if(c.a&&c.a.src&&c.a.textTracks){h=Qk(c);for(var p=t(h),r=p.next();!r.done;r=p.next())k=r.value,"disabled"!=k.mode&&(k.mode=g?"showing":"hidden")}e.B(2);break}c.H.g.setTextVisibility(g);if(c.b.streaming.alwaysStreamText){e.B(2);break}if(!g){p=c.f;p.H=!0;if(r=p.b.get("text"))Uh(r),p.b["delete"]("text");e.B(2);break}if(Yh(c.f,
"text")){e.B(2);break}l=Mk(c);n=O.Ob(l.textStreams,c.pa,c.lb);if(!(0<n.length)){e.B(2);break}return v(e,$h(c.f,n[0]),2);case 2:hl(c),w(e)}})})};Y.prototype.setTextTrackVisibility=Y.prototype.Wf;
Y.prototype.Ye=function(){if(!this.ga())return B.l("getPlayheadTimeAsDate is for live streams!"),null;var b=this.Sa.f,c=0;if(this.s)c=this.s.g();else if(b){if(null==b.startTime)return new Date;c=b.startTime}if(this.c)return new Date(1E3*(this.c.presentationTimeline.f+this.a.currentTime));if(this.a&&this.a.getStartDate)return b=this.a.getStartDate(),isNaN(b.getTime())?(B.l("EXT-X-PROGRAM-DATETIME required to get playhead time as Date!"),null):new Date(b.getTime()+1E3*c);B.l("No way to get playhead time as Date!");
return null};Y.prototype.getPlayheadTimeAsDate=Y.prototype.Ye;Y.prototype.$e=function(){if(!this.ga())return B.l("getPresentationStartTimeAsDate is for live streams!"),null;if(this.c)return new Date(1E3*this.c.presentationTimeline.f);if(this.a&&this.a.getStartDate){var b=this.a.getStartDate();return isNaN(b.getTime())?(B.l("EXT-X-PROGRAM-DATETIME required to get presentation start time as Date!"),null):b}B.l("No way to get presentation start time as Date!");return null};
Y.prototype.getPresentationStartTimeAsDate=Y.prototype.$e;Y.prototype.Wc=function(){var b={total:[],audio:[],video:[],text:[]};this.i==Ok&&(b.total=td(this.a.buffered));this.i==Jk&&this.H.Wc(b);return b};Y.prototype.getBufferedInfo=Y.prototype.Wc;
Y.prototype.getStats=function(){if(this.i!=Jk&&this.i!=Ok)return{width:NaN,height:NaN,streamBandwidth:NaN,decodedFrames:NaN,droppedFrames:NaN,corruptedFrames:NaN,estimatedBandwidth:NaN,loadLatency:NaN,playTime:NaN,pauseTime:NaN,bufferingTime:NaN,licenseTime:NaN,switchHistory:[],stateHistory:[]};zk(this);var b=this.a;if(b.getVideoPlaybackQuality){b=b.getVideoPlaybackQuality();var c=this.A,d=Number(b.totalVideoFrames);c.s=Number(b.droppedVideoFrames);c.m=d;this.A.i=Number(b.corruptedVideoFrames)}this.h?
(b=this.h,b=b.O?b.O:NaN):b=NaN;this.A.h=b;if(this.i==Jk){if(b=Wk(this))this.A.v=b.bandwidth;b&&b.video&&(c=this.A,d=b.video.height||NaN,c.A=b.video.width||NaN,c.g=d);b=this.m.getBandwidthEstimate();this.A.f=b}var e=this.A;b=e.A;c=e.g;d=e.v;var f=e.m,g=e.s,h=e.i,k=e.f,l=e.b,n=Tj(e.a,"playing"),p=Tj(e.a,"paused"),q=Tj(e.a,"buffering"),r=e.h,x=Uj(e.a),C=[];e=t(e.c.a);for(var z=e.next();!z.done;z=e.next())z=z.value,C.push({timestamp:z.timestamp,id:z.id,type:z.type,fromAdaptation:z.fromAdaptation,bandwidth:z.bandwidth});
return{width:b,height:c,streamBandwidth:d,decodedFrames:f,droppedFrames:g,corruptedFrames:h,estimatedBandwidth:k,loadLatency:l,playTime:n,pauseTime:p,bufferingTime:q,licenseTime:r,stateHistory:x,switchHistory:C}};Y.prototype.getStats=Y.prototype.getStats;
Y.prototype.addTextTrack=function(b,c,d,e,f,g){var h=this;return u(function l(){var n,p,q,r,x,C,z,H,F;return y(l,function(l){switch(l.j){case 1:if(h.i==Ok)throw B.error("Cannot add text when loaded with src="),Error("State error!");if(h.i!=Jk)throw B.error("Must call load() and wait for it to resolve before adding text tracks."),Error("State error!");n=Mk(h);p=yd;q=h.c.periods.indexOf(n);r=q+1;x=r>=h.c.periods.length?h.c.presentationTimeline.aa():h.c.periods[r].startTime;C=x-n.startTime;if(Infinity==
C)throw new E(1,4,4033);z=new U(1,0,C,function(){return[b]},0,null);H={id:h.ae++,originalId:null,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return 1},getSegmentReference:function(b){return 1==b?z:null},initSegmentReference:null,presentationTimeOffset:0,mimeType:e,codecs:f||"",kind:d,encrypted:!1,keyId:null,language:c,label:g||null,type:p.ua,primary:!1,frameRate:void 0,pixelAspectRatio:void 0,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,
audioSamplingRate:null,closedCaptions:null};h.cc.add(H);n.textStreams.push(H);return v(l,$h(h.f,H),2);case 2:return(F=Yh(h.f,"text"))&&Tg(h.ca,n,F),h.cc["delete"](H),B.debug("Choosing new streams after adding a text stream"),Uk(h,n),Lk(h),l["return"](O.Bc(H))}})})};Y.prototype.addTextTrack=Y.prototype.addTextTrack;Y.prototype.Vf=function(b,c){this.dc.width=b;this.dc.height=c};Y.prototype.setMaxHardwareResolution=Y.prototype.Vf;
Y.prototype.td=function(){if(this.i==Jk){var b=this.f;if(b.f)B.error("Unable to retry after StreamingEngine is destroyed!"),b=!1;else if(b.s)B.error("Unable to retry after StreamingEngine encountered a fatal error!"),b=!1;else{for(var c=t(b.b.values()),d=c.next();!d.done;d=c.next()){d=d.value;var e=ii(d);d.Sb&&(B.info(e,"Retrying after failure..."),d.Sb=!1,ci(b,d,.1))}b=!0}}else b=!1;return b};Y.prototype.retryStreaming=Y.prototype.td;Y.prototype.Pe=function(){return this.c};
Y.prototype.getManifest=Y.prototype.Pe;Y.prototype.Qe=function(){return this.v?this.v.constructor:null};Y.prototype.getManifestParserFactory=Y.prototype.Qe;function Dk(b,c,d,e){Ug(b.ca,c).variant=d;b=b.A.c;b.c!=d&&(b.c=d,b.a.push({timestamp:Date.now()/1E3,id:d.id,type:"variant",fromAdaptation:e,bandwidth:d.bandwidth}))}function $k(b,c,d,e){Tg(b.ca,c,d);b=b.A.c;b.b!=d&&(b.b=d,b.a.push({timestamp:Date.now()/1E3,id:d.id,type:"text",fromAdaptation:e,bandwidth:null}))}
function Yj(b){var c=Oj();c.streaming.failureCallback=function(c){var d=[1001,1002,1003];b.ga()&&d.includes(c.code)&&(c.severity=1,B.l("Live streaming error.  Retrying automatically..."),b.td())};c.textDisplayFactory=function(){return new Ij(b.a)};return c}
function Bk(b,c){for(var d=0;d<c.length;d++){for(var e=c[d],f=new Map,g=t(e.variants),h=g.next();!h.done;h=g.next())if(h=h.value,h.video&&h.video.closedCaptions){h=h.video;for(var k=t(h.closedCaptions.keys()),l=k.next();!l.done;l=k.next())if(l=l.value,!f.has(l)){var n={id:b.ae++,originalId:l,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return null},getSegmentReference:function(){return null},initSegmentReference:null,presentationTimeOffset:0,mimeType:"application/cea-608",
codecs:"",kind:"caption",encrypted:!1,keyId:null,language:h.closedCaptions.get(l),label:null,type:"text",primary:!1,frameRate:void 0,pixelAspectRatio:void 0,trickModeVideo:null,emsgSchemeIdUris:null,roles:h.roles,channelsCount:null,audioSamplingRate:null,closedCaptions:null};f.set(l,n)}}f=t(f.values());for(g=f.next();!g.done;g=f.next())e.textStreams.push(g.value)}}
function uk(b,c){var d=b.f?Xh(b.f):null,e=b.f?Zh(b.f):null;c.forEach(O.filterNewPeriod.bind(null,b.h,d,e));d=Nb(c,function(b){return b.variants.some(O.yb)});if(0==d)throw new E(2,4,4032);if(d<c.length)throw new E(2,4,4011);c.forEach(function(b){O.Gd(b.variants,this.b.restrictions,this.dc)&&this.f&&Mk(this)==b&&Lk(this);il(this,b.variants)}.bind(b))}m=Y.prototype;
m.Rc=function(b){var c=this.f?Xh(this.f):null,d=this.f?Zh(this.f):null;O.filterNewPeriod(this.h,c,d,b);c=b.variants;if(!c.some(O.yb))throw new E(2,4,4011);il(this,b.variants);O.Gd(c,this.b.restrictions,this.dc)&&this.f&&Mk(this)==b&&Lk(this);if(b=this.h?this.h.a:null)for(c=t(c),d=c.next();!d.done;d=c.next()){d=t(d.value.drmInfos);for(var e=d.next();!e.done;e=d.next())if(e=e.value,e.keySystem==b.keySystem){e=t(e.initData||[]);for(var f=e.next();!f.done;f=e.next())f=f.value,Xc(this.h,f.initDataType,
f.initData)}}};function cl(b,c,d,e){d=void 0===d?!1:d;e=void 0===e?0:e;if(b.qb)return b.ra=c,b.Wd=d,b.Sd=e,!0;(c=fi(b.f,c,d,e))&&dl(b);return c}function al(b,c){if(b.qb)return b.qa=c,!0;var d=ei(b.f,c,!0,0,!1);d&&bl(b);return d}
function Kk(b,c){function d(b,c){if(!b)return null;var d=b.findSegmentPosition(c-g.startTime);return null==d?null:(d=b.getSegmentReference(d))?d.startTime+g.startTime:null}var e=Xh(b.f),f=Zh(b.f),g=Mk(b);e=d(e,c);f=d(f,c);return null!=f&&null!=e?Math.max(f,e):null!=f?f:null!=e?e:c}function sk(b){var c=b.Yd();if(b.A&&b.F&&b.s){var d=b.K;d.f=c;vh(d);zk(b)}b.dispatchEvent(new J("buffering",{buffering:c}))}function Ak(b){var c=b.a.playbackRate;0!=c&&b.K.set(c)}
function zk(b){if(b.A&&b.F){var c=b.A.a;b.F.a==gh?Sj(c,"buffering"):b.a.paused?Sj(c,"paused"):b.a.ended?Sj(c,"ended"):Sj(c,"playing")}}function Nk(b,c){try{il(b,c)}catch(e){return b.Pa(e),null}var d=c.filter(function(b){return O.yb(b)});d=b.Lb.create(d);b.m.setVariants(Array.from(d.values()));return b.m.chooseVariant()}function Uk(b,c){var d=gl(b,c,!1),e=O.Ob(c.textStreams,b.pa,b.lb)[0]||null,f=!1;e&&(b.b.streaming.alwaysStreamText||b.qc())&&($k(b,c,e,!0),f=al(b,e));(d||f)&&Ek(b)}
function gl(b,c,d){d=void 0===d?!0:d;var e=Nk(b,c.variants),f=!1;e&&(Dk(b,c,e,!0),f=cl(b,e,!0));d&&f&&Ek(b);return f}
m.mf=function(b){B.debug("onChooseStreams_",b);try{B.I("onChooseStreams_, choosing variant from ",b.variants);B.I("onChooseStreams_, choosing text from ",b.textStreams);this.qb=!0;this.m.disable();Vk(this);B.debug("Choosing new streams after period changed");var c=Nk(this,b.variants),d=O.Ob(b.textStreams,this.pa,this.lb)[0]||null;this.ra&&(b.variants.includes(this.ra)&&(c=this.ra),this.ra=null);this.qa&&(b.textStreams.includes(this.qa)&&(d=this.qa),this.qa=null);c&&Dk(this,b,c,!0);d&&$k(this,b,d,
!0);var e=this.f,f=e.b.get("video");if(f)var g=e.c.periods[f.ja];else{var h=e.b.get("audio");g=h?e.c.periods[h.ja]:null}var k=c?c.audio:null;if(!g&&d){var l;if(l=k){b=d;var n=N(this.b.preferredTextLanguage),p=N(k.language),q=N(b.language);l=re(q,n)&&!re(p,q)}l&&(this.mb=!0);this.mb&&this.H.g.setTextVisibility(!0);hl(this)}var r=this.b.streaming.alwaysStreamText||this.qc()?{variant:c,text:d}:{variant:c,text:null};B.I("onChooseStreams_, chose variant ",r.variant);B.I("onChooseStreams_, chose text ",
r.text);return r}catch(x){return this.Pa(x),{variant:null,text:null}}};m.ye=function(){B.debug("canSwitch_");this.qb=!1;this.b.abr.enabled&&(this.m.enable(),Vk(this));this.ra&&(fi(this.f,this.ra,this.Wd,this.Sd),dl(this),this.ra=null);this.qa&&(ei(this.f,this.qa,!0,0,!1),bl(this),this.qa=null)};m.rf=function(){this.v&&this.v.update&&this.v.update()};m.vf=function(){this.s&&this.s.v()};function Ek(b){jl(b,new J("adaptation"))}function Lk(b){jl(b,new J("trackschanged"))}
function dl(b){jl(b,new J("variantchanged"))}function bl(b){jl(b,new J("textchanged"))}function hl(b){jl(b,new J("texttrackvisibility"))}function Vk(b){jl(b,new J("abrstatuschanged",{og:b.b.abr.enabled}))}m.Pa=function(b){if(this.i!=kk){var c=new J("error",{detail:b});this.dispatchEvent(c);c.defaultPrevented&&(b.handled=!0)}};function tk(b,c,d){b.dispatchEvent(new J(c,{detail:{schemeIdUri:d.schemeIdUri,value:d.value,startTime:d.startTime,endTime:d.endTime,id:d.id,eventElement:d.eventElement}}))}
function rk(b){if(!b.a.error)return null;var c=b.a.error.code;if(1==c)return null;var d=b.a.error.msExtendedCode;d&&(0>d&&(d+=Math.pow(2,32)),d=d.toString(16));return new E(2,3,3016,c,d,b.a.error.message)}
function xk(b,c){if(b.f){var d=Mk(b),e=!1,f=Object.keys(c);0==f.length&&B.l("Got a key status event without any key statuses, so we don't know the real key statuses. If we don't have all the keys, you'll need to set restrictions so we don't select those tracks.");var g=1==f.length&&"00"==f[0];g&&B.l("Got a synthetic key status event, so we don't know the real key statuses. If we don't have all the keys, you'll need to set restrictions so we don't select those tracks.");f.length&&b.c.periods.forEach(function(b){b.variants.forEach(function(b){O.df(b).forEach(function(d){var f=
b.allowedByKeySystem;d.keyId&&(d=c[g?"00":d.keyId],b.allowedByKeySystem=!!d&&!mk.includes(d));f!=b.allowedByKeySystem&&(e=!0)})})});f=Xh(b.f);var h=Zh(b.f);(f=O.Rd(f,h,d.variants))&&!f.allowedByKeySystem&&(B.debug("Choosing new variants after key status changed"),gl(b,d));e&&(Lk(b),Nk(b,d.variants))}}function yk(b,c,d){if(b.v&&b.v.onExpirationUpdated)b.v.onExpirationUpdated(c,d);b.dispatchEvent(new J("expirationupdated"))}
function Ck(b,c,d){0<c&&(b.ga()?B.l("|playRangeStart| has been configured for live content. Ignoring the setting."):b.ne(c));d<b.aa()&&(b.ga()?B.l("|playRangeEnd| has been configured for live content. Ignoring the setting."):b.Aa(d))}
function il(b,c){var d=b.h?mc(b.h.Y):{},e=Object.keys(d);e=e.length&&"00"==e[0];for(var f=!1,g=!1,h=[],k=[],l=t(c),n=l.next();!n.done;n=l.next()){n=n.value;var p=[];n.audio&&p.push(n.audio);n.video&&p.push(n.video);p=t(p);for(var q=p.next();!q.done;q=p.next())if(q=q.value,q.keyId){var r=d[e?"00":q.keyId];r?mk.includes(r)&&(k.includes(r)||k.push(r)):h.includes(q.keyId)||h.push(q.keyId)}n.allowedByApplication?n.allowedByKeySystem&&(f=!0):g=!0}if(!f)throw new E(2,4,4012,{hasAppRestrictions:g,missingKeys:h,
restrictedKeyStatuses:k});}function jl(b,c){u(function e(){return y(e,function(e){switch(e.j){case 1:return v(e,Promise.resolve(),2);case 2:b.i!=kk&&b.dispatchEvent(c),w(e)}})})}function fl(b){var c=new Set;b=t(b);for(var d=b.next();!d.done;d=b.next())d=d.value,d.language?c.add(N(d.language)):c.add("und");return c}
function el(b){var c=new Map;b=t(b);for(var d=b.next();!d.done;d=b.next()){var e=d.value;d="und";var f=[];e.language&&(d=N(e.language));"variant"==e.type?f=e.audioRoles:f=e.roles;f&&f.length||(f=[""]);c.has(d)||c.set(d,new Set);e=t(f);for(f=e.next();!f.done;f=e.next())f=f.value,c.get(d).add(f)}var g=[];c.forEach(function(b,c){for(var d=t(b),e=d.next();!e.done;e=d.next())g.push({language:c,role:e.value})});return g}
function Xk(b){b=Mk(b);return null==b?[]:b.variants.filter(function(b){return O.yb(b)})}function Zk(b){var c=Mk(b);return null==c?[]:c.textStreams.filter(function(c){return!b.cc.has(c)})}function Mk(b){var c=b.s.g(),d=null;b=t(b.c.periods);for(var e=b.next();!e.done;e=b.next())e=e.value,e.startTime<=c&&(d=e);return d}function Wk(b){var c=Mk(b);return Ug(b.ca,c).variant}
function Yk(b){var c=Mk(b);if(null==c)return null;if(!Ug(b.ca,c).text){var d=O.Ob(c.textStreams,b.pa,b.lb);d.length&&Tg(b.ca,c,d[0])}return Ug(b.ca,c).text}function ok(){return new E(2,7,7E3)}function jk(b,c,d,e,f,g){return e==b&&f.u==g.u&&f.uri==g.uri&&f.mimeType==g.mimeType&&f.Ca==g.Ca?c:d}function Dj(){return{Ca:null,u:null,mimeType:null,startTime:null,Ad:null,uri:null}}
function pk(b){return new Promise(function(c,d){b.cb=function(){return d(ok())};b.tc=function(){return c()};b.onError=function(b){return d(b)};b.vc=function(){return d(ok())}})}var kk=0,Xj=1,Jk=2,Ok=3;Y.LoadMode={DESTROYED:kk,NOT_LOADED:Xj,MEDIA_SOURCE:Jk,SRC_EQUALS:Ok};function kl(b,c,d){var e=void 0==c.expiration?Infinity:c.expiration,f=c.presentationTimeline.aa();c=ll(c.periods[0]);return{offlineUri:null,originalManifestUri:b,duration:f,size:0,expiration:e,tracks:c,appMetadata:d}}function ml(b,c){var d=sj(new qj(b.za(),b.ea()),c.periods[0],new X(null,0)),e=c.appMetadata||{};d=ll(d);return{offlineUri:b.toString(),originalManifestUri:c.originalManifestUri,duration:c.duration,size:c.size,expiration:c.expiration,tracks:d,appMetadata:e}}
function ll(b){var c=[],d=O.We(b.variants);d=t(d);for(var e=d.next();!e.done;e=d.next())c.push(O.Ed(e.value));b=t(b.textStreams);for(d=b.next();!d.done;d=b.next())c.push(O.Bc(d.value));return c};function nl(){this.a={}}function ol(b,c){var d=c.audio,e=c.video;d&&!e&&(b.a[d.id]=d.bandwidth||c.bandwidth);!d&&e&&(b.a[e.id]=e.bandwidth||c.bandwidth);if(d&&e){var f=d.bandwidth||393216,g=e.bandwidth||c.bandwidth-f;0>=g&&(B.l("Audio bit rate consumes variants bandwidth. Setting video bandwidth to match variant's bandwidth."),g=c.bandwidth);b.a[d.id]=f;b.a[e.id]=g}}function pl(b,c,d){d=d.endTime-d.startTime;return ql(b,c)*d}
function ql(b,c){var d=b.a[c];null==d&&(d=0,B.error("Asking for bitrate of stream not given to the estimator"));0==d&&B.l("Using bitrate of 0, this stream won't affect progress");return d};function rl(b){this.a=!1;this.b=new G;this.c=b}rl.prototype.destroy=function(){var b=this;if(this.a)return this.b;this.a=!0;return this.c().then(function(){b.b.resolve()},function(){b.b.resolve()})};function sl(b,c,d){b=t(b.periods);for(var e=b.next();!e.done;e=b.next())e=e.value,e.variants=e.variants.filter(function(b){return O.ed(b,c,d)})}function tl(b){b=t(b.periods);for(var c=b.next();!c.done;c=b.next())c=c.value,c.variants=c.variants.filter(function(b){var c=!0;b.audio&&(c=c&&de(b.audio));b.video&&(c=c&&de(b.video));return c})}function ul(b,c){for(var d=t(b.periods),e=d.next();!e.done;e=d.next())e=e.value,e.variants=e.variants.filter(function(b){return md(c,b)})}
function vl(b){var c=new wl;b.periods.forEach(function(b,d){var e=xl(b.variants);if(0==d){e=t(e.a);for(var f=e.next();!f.done;f=e.next())c.add(f.value)}else yl(c,e)});b=t(b.periods);for(var d=b.next();!d.done;d=b.next())d=d.value,d.variants=d.variants.filter(function(b){return zl(c,new Al(b))})}
function Bl(b,c){return u(function e(){var f,g,h,k;return y(e,function(e){switch(e.j){case 1:f=null,g=t(b.periods),h=g.next();case 2:if(h.done){e.B(0);break}k=h.value;f&&(k.variants=k.variants.filter(function(b){return zl(f,new Al(b))}));return v(e,c(k),5);case 5:f=xl(k.variants),h=g.next(),e.B(2)}})})}function Al(b){var c=b.audio;b=b.video;this.b=c?c.mimeType:null;this.a=c?c.codecs.split(".")[0]:null;this.f=b?b.mimeType:null;this.c=b?b.codecs.split(".")[0]:null}function wl(){this.a=[]}
wl.prototype.add=function(b){zl(this,b)||this.a.push(b)};function yl(b,c){b.a=b.a.filter(function(b){return zl(c,b)})}function zl(b,c){return b.a.some(function(b){return c.b==b.b&&c.a==b.a&&c.f==b.f&&c.c==b.c})}function xl(b){var c=new wl;b=t(b);for(var d=b.next();!d.done;d=b.next())c.add(new Al(d.value));return c};function Z(b){var c=this;if(b&&b.constructor!=Y)throw new E(2,9,9008);this.b=this.a=null;b?(this.a=b.b,this.b=b.mc()):(this.a=Oj(),this.b=new K);this.f=!1;this.c=[];this.g=[];var d=!b;this.h=new rl(function(){return u(function f(){var b;return y(f,function(f){switch(f.j){case 1:return b=function(){},v(f,Promise.all(c.g.map(function(c){return c.then(b,b)})),2);case 2:if(!d){f.B(3);break}return v(f,c.b.destroy(),3);case 3:c.a=null,c.b=null,w(f)}})})})}A("shaka.offline.Storage",Z);
function Cl(){if(rc())a:{var b=t(Zi.values());for(var c=b.next();!c.done;c=b.next())if(c=c.value,c=c()){c.destroy();b=!0;break a}b=!1}else b=!1;return b}Z.support=Cl;Z.prototype.destroy=function(){return this.h.destroy()};Z.prototype.destroy=Z.prototype.destroy;
Z.prototype.configure=function(b,c){2==arguments.length&&"string"==typeof b&&(b=Mj(b,c));var d=b,e=!1;null!=d.trackSelectionCallback&&(e=!0,d.offline=d.offline||{},d.offline.trackSelectionCallback=d.trackSelectionCallback,delete d.trackSelectionCallback);null!=d.progressCallback&&(e=!0,d.offline=d.offline||{},d.offline.progressCallback=d.progressCallback,delete d.progressCallback);null!=d.usePersistentLicense&&(e=!0,d.offline=d.offline||{},d.offline.usePersistentLicense=d.usePersistentLicense,delete d.usePersistentLicense);
e&&Mf("Storage.configure with OfflineConfig","Please configure storage with a player configuration.");return Qj(this.a,b)};Z.prototype.configure=Z.prototype.configure;Z.prototype.getConfiguration=function(){var b=Oj();Qj(b,this.a,Oj());return b};Z.prototype.getConfiguration=Z.prototype.getConfiguration;Z.prototype.mc=function(){return this.b};Z.prototype.getNetworkingEngine=Z.prototype.mc;
Z.prototype.store=function(b,c,d){var e=this;return Dl(this,El(this,b,c||{},function(){return u(function g(){var c,k;return y(g,function(g){switch(g.j){case 1:return d&&"string"!=typeof d?(Mf("Storing with a manifest parser factory","Please register a manifest parser and for the mime-type."),c=d,g["return"](new c)):v(g,W.create(b,e.b,e.a.manifest.retryParameters,d),2);case 2:return k=g.o,g["return"](k)}})})}))};Z.prototype.store=Z.prototype.store;Z.prototype.af=function(){return this.f};
Z.prototype.getStoreInProgress=Z.prototype.af;
function El(b,c,d,e){return u(function g(){var h,k,l,n,p,q,r,x,C,z;return y(g,function(g){switch(g.j){case 1:Fl();if(b.f)return g["return"](Promise.reject(new E(2,9,9006)));b.f=!0;return v(g,Gl(b,c,e),2);case 2:h=g.o;Hl(b);k=!h.presentationTimeline.ga()&&!h.presentationTimeline.ab();if(!k)throw new E(2,9,9005,c);l=null;n=new Yi;q=p=null;Da(g,3,4);return v(g,Il(b,h,function(b){q=q||b}),6);case 6:l=g.o;Hl(b);if(q)throw q;return v(g,Jl(b,h,l),7);case 7:return v(g,n.init(),8);case 8:return Hl(b),v(g,
$i(n),9);case 9:return p=g.o,Hl(b),v(g,Kl(b,p.ea,l,h,c,d),10);case 10:r=g.o;Hl(b);if(q)throw q;return v(g,p.ea.addManifests([r]),11);case 11:return x=g.o,Hl(b),C=new oj("manifest",p.path.za,p.path.ea,x[0]),g["return"](ml(C,r));case 4:return Ha(g),b.f=!1,b.c=[],v(g,n.destroy(),12);case 12:if(!l){g.B(13);break}return v(g,l.destroy(),13);case 13:Ia(g,0);break;case 3:z=Ga(g);if(!p){g.B(15);break}return v(g,p.ea.removeSegments(b.c,function(){}),15);case 15:throw q||z;}})})}
function Jl(b,c,d){return u(function f(){var g,h;return y(f,function(f){switch(f.j){case 1:return g={width:Infinity,height:Infinity},sl(c,b.a.restrictions,g),tl(c),ul(c,d),vl(c),h=b.a.preferredAudioChannelCount,O.Jd(c,h),v(f,Bl(c,function(c){return u(function p(){var d,f,g,h,k,l,F,P;return y(p,function(p){switch(p.j){case 1:d=O;f=[];for(var q=t(c.variants),r=q.next();!r.done;r=q.next())g=r.value,f.push(d.Ed(g));q=t(c.textStreams);for(r=q.next();!r.done;r=q.next())h=r.value,f.push(d.Bc(h));return v(p,
b.a.offline.trackSelectionCallback(f),2);case 2:k=p.o;l=new Set;F=new Set;q=t(k);for(r=q.next();!r.done;r=q.next())P=r.value,"variant"==P.type&&l.add(P.id),"text"==P.type&&F.add(P.id);c.variants=c.variants.filter(function(b){return l.has(b.id)});c.textStreams=c.textStreams.filter(function(b){return F.has(b.id)});w(p)}})})}),2);case 2:Ll(c),w(f)}})})}
function Kl(b,c,d,e,f,g){return u(function k(){var l,n,p,q,r,x,C,z,H,F;return y(k,function(k){switch(k.j){case 1:return l=kl(f,e,g),n=e.periods.some(function(b){return b.variants.some(function(b){return b.drmInfos&&b.drmInfos.length})}),p=e.periods.some(function(b){return b.variants.some(function(b){return b.drmInfos.some(function(b){return b.initData&&b.initData.length})})}),q=n&&!p,r=null,q&&(x=d.a,r=Ml.get(x.keySystem)),C=new Ki(b.b,function(c,d){l.size=d;b.a.offline.progressCallback(l,c)},function(c,
e){q&&b.a.offline.usePersistentLicense&&r==e&&Xc(d,"cenc",c)}),Ea(k,2),H=z=Nl(b,C,c,d,e,f,g),v(k,Ni(C),4);case 4:H.size=k.o;z.expiration=d.Pb();F=cd(d);z.sessionIds=b.a.offline.usePersistentLicense?F:[];if(n&&b.a.offline.usePersistentLicense&&!F.length)throw new E(2,9,9007);return k["return"](z);case 2:return Ha(k),v(k,C.destroy(),5);case 5:Ia(k,0)}})})}Z.prototype.remove=function(b){return Dl(this,Ol(this,b))};Z.prototype.remove=Z.prototype.remove;
function Ol(b,c){return u(function e(){var f,g,h,k,l,n;return y(e,function(e){switch(e.j){case 1:Fl();f=pj(c);if(null==f||"manifest"!=f.a)return e["return"](Promise.reject(new E(2,9,9004,c)));g=f;h=new Yi;Ea(e,2);return v(e,h.init(),4);case 4:return v(e,bj(h,g.za(),g.ea()),5);case 5:return k=e.o,v(e,k.getManifests([g.key()]),6);case 6:return l=e.o,n=l[0],v(e,Promise.all([Pl(b,n,h),Ql(b,k,g,n)]),2);case 2:return Ha(e),v(e,h.destroy(),8);case 8:Ia(e,0)}})})}
function Rl(b,c){for(var d=[],e=t(b.periods),f=e.next();!f.done;f=e.next()){f=t(f.value.streams);for(var g=f.next();!g.done;g=f.next())g=g.value,c&&"video"==g.contentType?d.push({contentType:nc(g.mimeType,g.codecs),robustness:b.drmInfo.videoRobustness}):c||"audio"!=g.contentType||d.push({contentType:nc(g.mimeType,g.codecs),robustness:b.drmInfo.audioRobustness})}return d}function Pl(b,c,d){return u(function f(){return y(f,function(f){switch(f.j){case 1:return v(f,Sl(b.b,b.a.drm,d,c),0)}})})}
function Ql(b,c,d,e){function f(){k+=1;b.a.offline.progressCallback(l,k/h)}var g=Tl(e),h=g.length+1,k=0,l=ml(d,e);return Promise.all([c.removeSegments(g,f),c.removeManifests([d.key()],f)])}Z.prototype.Kf=function(){return Dl(this,Ul(this))};Z.prototype.removeEmeSessions=Z.prototype.Kf;
function Ul(b){return u(function d(){var e,f,g,h,k,l,n,p,q;return y(d,function(d){switch(d.j){case 1:return Fl(),e=b.b,f=b.a.drm,g=new Yi,h=!1,Ea(d,2),v(d,g.init(),4);case 4:k=[];cj(g,function(b){return k.push(b)});l=Promise.resolve();n={};p=t(k);for(q=p.next();!q.done;n={Ac:n.Ac},q=p.next())n.Ac=q.value,l=l.then(function(b){return function(){return u(function z(){var d,g;return y(z,function(k){switch(k.j){case 1:return v(k,b.Ac.getAll(),2);case 2:return d=k.o,v(k,zj(f,e,d),3);case 3:return g=k.o,
v(k,b.Ac.remove(g),4);case 4:g.length!=d.length&&(h=!0),w(k)}})})}}(n));return v(d,l,2);case 2:return Ha(d),v(d,g.destroy(),6);case 6:Ia(d,3);break;case 3:return d["return"](!h)}})})}Z.prototype.list=function(){return Dl(this,Vl())};Z.prototype.list=Z.prototype.list;
function Vl(){return u(function c(){var d,e,f;return y(c,function(c){switch(c.j){case 1:return Fl(),d=[],e=new Yi,Ea(c,2),v(c,e.init(),4);case 4:return f=Promise.resolve(),aj(e,function(c,e){f=f.then(function(){return u(function n(){var f;return y(n,function(g){switch(g.j){case 1:return v(g,e.getAllManifests(),2);case 2:f=g.o,f.forEach(function(e,f){var g=ml(new oj("manifest",c.za,c.ea,f),e);d.push(g)}),w(g)}})})})}),v(c,f,2);case 2:return Ha(c),v(c,e.destroy(),6);case 6:Ia(c,3);break;case 3:return c["return"](d)}})})}
function Gl(b,c,d){return u(function f(){var g,h,k,l,n,p;return y(f,function(f){switch(f.j){case 1:return g=null,h=b.b,k={networkingEngine:h,filterAllPeriods:function(){},filterNewPeriod:function(){},onTimelineRegionAdded:function(){},onEvent:function(){},onError:function(b){g=b}},v(f,d(),2);case 2:return l=f.o,l.configure(b.a.manifest),Hl(b),Ea(f,3),v(f,l.start(c,k),5);case 5:return n=f.o,Hl(b),p=Wl(n),v(f,Promise.all(jc(p,function(b){return b.createSegmentIndex()})),6);case 6:Hl(b);if(g)throw g;
return f["return"](n);case 3:return Ha(f),v(f,l.stop(),7);case 7:Ia(f,0)}})})}function Il(b,c,d){return u(function f(){var g,h,k;return y(f,function(f){switch(f.j){case 1:return g=new Gc({Ab:b.b,onError:d,uc:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),h=qh(c.periods),k=b.a,g.configure(k.drm),v(f,Lc(g,h,k.offline.usePersistentLicense),2);case 2:return v(f,Vc(g),3);case 3:return v(f,Wc(g),4);case 4:return f["return"](g)}})})}
function Nl(b,c,d,e,f,g,h){var k=new nl,l=f.periods.map(function(e){return Xl(b,c,d,k,f,e)}),n=e.a,p=b.a.offline.usePersistentLicense;n&&p&&(n.initData=[]);return{originalManifestUri:g,duration:f.presentationTimeline.aa(),size:0,expiration:e.Pb(),periods:l,sessionIds:p?cd(e):[],drmInfo:n,appMetadata:h}}
function Xl(b,c,d,e,f,g){for(var h=t(g.variants),k=h.next();!k.done;k=h.next())ol(e,k.value);h=t(g.textStreams);for(k=h.next();!k.done;k=h.next())e.a[k.value.id]=52;h=Yl(g);var l=new Map;h=t(h);for(k=h.next();!k.done;k=h.next()){k=k.value;var n=Zl(b,c,d,e,f,k);l.set(k.id,n)}g.variants.forEach(function(b){b.audio&&l.get(b.audio.id).variantIds.push(b.id);b.video&&l.get(b.video.id).variantIds.push(b.id)});return{startTime:g.startTime,streams:Array.from(l.values())}}
function Zl(b,c,d,e,f,g){var h={id:g.id,originalId:g.originalId,primary:g.primary,presentationTimeOffset:g.presentationTimeOffset||0,contentType:g.type,mimeType:g.mimeType,codecs:g.codecs,frameRate:g.frameRate,pixelAspectRatio:g.pixelAspectRatio,kind:g.kind,language:g.language,label:g.label,width:g.width||null,height:g.height||null,initSegmentKey:null,encrypted:g.encrypted,keyId:g.keyId,segments:[],variantIds:[]};f=f.presentationTimeline.Rb();var k=g.id,l=g.initSegmentReference;l&&(l=vf(l.c(),l.b,
l.a,b.a.streaming.retryParameters),Li(c,k,l,.5*ql(e,g.id),!0,function(c){return u(function q(){var e;return y(q,function(f){switch(f.j){case 1:return v(f,d.addSegments([{data:c}]),2);case 2:e=f.o,b.c.push(e[0]),h.initSegmentKey=e[0],w(f)}})})}));$l(g,f,function(f){var l=vf(f.c(),f.b,f.a,b.a.streaming.retryParameters);Li(c,k,l,pl(e,g.id,f),!1,function(c){return u(function x(){var e;return y(x,function(g){switch(g.j){case 1:return v(g,d.addSegments([{data:c}]),2);case 2:e=g.o,b.c.push(e[0]),h.segments.push({startTime:f.startTime,
endTime:f.endTime,dataKey:e[0]}),w(g)}})})})});return h}function $l(b,c,d){c=b.findSegmentPosition(c);for(var e=null==c?null:b.getSegmentReference(c);e;)d(e),e=b.getSegmentReference(++c)}function Hl(b){if(b.h.a)throw new E(2,9,7001);}function Fl(){if(!Cl())throw new E(2,9,9E3);}function Dl(b,c){return u(function e(){return y(e,function(e){switch(e.j){case 1:return b.g.push(c),Ea(e,2),v(e,c,4);case 4:return e["return"](e.o);case 2:Ha(e),Mb(b.g,c),Ia(e,0)}})})}
function Tl(b){var c=[];b.periods.forEach(function(b){b.streams.forEach(function(b){null!=b.initSegmentKey&&c.push(b.initSegmentKey);b.segments.forEach(function(b){c.push(b.dataKey)})})});return c}Z.deleteAll=function(){return u(function c(){var d;return y(c,function(c){switch(c.j){case 1:return d=new Yi,Ea(c,2),v(c,d.erase(),2);case 2:return Ha(c),v(c,d.destroy(),5);case 5:Ia(c,0)}})})};
function Sl(b,c,d,e){return u(function g(){var h,k,l;return y(g,function(g){switch(g.j){case 1:if(!e.drmInfo)return g["return"]();h=dj(d);k=e.sessionIds.map(function(b){return{sessionId:b,keySystem:e.drmInfo.keySystem,licenseUri:e.drmInfo.licenseServerUri,serverCertificate:e.drmInfo.serverCertificate,audioCapabilities:Rl(e,!1),videoCapabilities:Rl(e,!0)}});return v(g,zj(c,b,k),2);case 2:return l=g.o,v(g,h.remove(l),3);case 3:return v(g,h.add(k.filter(function(b){return-1==l.indexOf(b.sessionId)})),
0)}})})}function Wl(b){var c=new Set;b=t(b.periods);for(var d=b.next();!d.done;d=b.next()){d=d.value;for(var e=t(d.textStreams),f=e.next();!f.done;f=e.next())c.add(f.value);d=t(d.variants);for(e=d.next();!e.done;e=d.next())e=e.value,e.audio&&c.add(e.audio),e.video&&c.add(e.video)}return c}
function Yl(b){for(var c=new Set,d=t(b.textStreams),e=d.next();!e.done;e=d.next())c.add(e.value);b=t(b.variants);for(d=b.next();!d.done;d=b.next())d=d.value,d.audio&&c.add(d.audio),d.video&&c.add(d.video);return c}function Ll(b){if(0==b.periods.length)throw new E(2,4,4014);b=t(b.periods);for(var c=b.next();!c.done;c=b.next())am(c.value)}
function am(b){var c=new Set(b.variants.map(function(b){return b.video})),d=new Set(b.variants.map(function(b){return b.audio}));b=b.textStreams;1<c.size&&B.l("Multiple video tracks selected to be stored");c=t(d);for(var e=c.next();!e.done;e=c.next()){e=e.value;for(var f=t(d),g=f.next();!g.done;g=f.next())g=g.value,e!=g&&e.language==g.language&&B.l("Similar audio tracks were selected to be stored",e.id,g.id)}d=t(b);for(c=d.next();!c.done;c=d.next())for(c=c.value,e=t(b),f=e.next();!f.done;f=e.next())f=
f.value,c!=f&&c.language==f.language&&B.l("Similar text tracks were selected to be stored",c.id,f.id)}var Ml=(new Map).set("org.w3.clearkey","1077efecc0b24d02ace33c1e52e2fb4b").set("com.widevine.alpha","edef8ba979d64acea3c827dcd51d21ed").set("com.microsoft.playready","9a04f07998404286ab92e65be0885f95").set("com.adobe.primetime","f239e769efa348509c16a903c6932efb");nk.offline=Cl;A("shaka.polyfill.installAll",function(){for(var b=0;b<bm.length;++b)try{bm[b].xe()}catch(c){B.da("Error installing polyfill!",c)}});var bm=[];function cm(b,c){c=c||0;for(var d={priority:c,xe:b},e=0;e<bm.length;e++)if(bm[e].priority<c){bm.splice(e,0,d);return}bm.push(d)}A("shaka.polyfill.register",cm);cm(function(){dm()},-1);cm(function(){B.debug("IndexedDB.install");var b=!1;if(xc("CrKey"))B.debug("Removing IndexedDB from ChromeCast"),b=!0;else try{window.indexedDB&&(b=!1)}catch(c){B.debug("Removing IndexedDB due to an exception when accessing it"),b=!0}b&&delete window.indexedDB});function em(b,c,d){if("input"==b)switch(this.type){case "range":b="change"}HTMLInputElement.prototype.originalAddEventListener.call(this,b,c,d)}cm(function(){B.debug("InputEvent.install");xc("Trident/")&&!HTMLInputElement.prototype.originalAddEventListener&&(B.info("Patching input event support on IE."),HTMLInputElement.prototype.originalAddEventListener=HTMLInputElement.prototype.addEventListener,HTMLInputElement.prototype.addEventListener=em)});cm(function(){B.debug("mathRound.install")});function fm(){var b=MediaSource.prototype.addSourceBuffer;MediaSource.prototype.addSourceBuffer=function(c){for(var d=[],e=0;e<arguments.length;++e)d[e]=arguments[e];d=b.apply(this,d);d.abort=function(){};return d}}function gm(){var b=SourceBuffer.prototype.remove;SourceBuffer.prototype.remove=function(c,d){return b.call(this,c,d-.001)}}function hm(){var b=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(c){return"mp2t"==c.split(/ *; */)[0].split("/")[1].toLowerCase()?!1:b(c)}}
function im(){var b=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(c){return"opus"!=qc(c)[0]&&b(c)}}
function jm(){var b=MediaSource.isTypeSupported,c=/^dv(?:h[e1]|a[v1])\./;MediaSource.isTypeSupported=function(d){for(var e=d.split(/ *; */),f=e[0],g={},h=1;h<e.length;++h){var k=e[h].split("="),l=k[0];k=k[1].replace(/"(.*)"/,"$1");g[l]=k}e=g.codecs;if(!e)return b(d);var n=!1,p=!1;d=e.split(",").filter(function(b){c.test(b)&&(p=!0);/^(hev|hvc)1\.2/.test(b)&&(n=!0);return!0});p&&(n=!1);g.codecs=d.join(",");n&&(g.eotf="smpte2084");for(var q in g)f+="; "+q+'="'+g[q]+'"';return cast.__platform__.canDisplayType(f)}}
cm(function(){B.debug("MediaSource.install");var b=yc();window.MediaSource?window.cast&&cast.__platform__&&cast.__platform__.canDisplayType?(B.info("Patching Chromecast MSE bugs."),jm()):b?(hm(),12>=b?(B.info("Patching Safari 11 & 12 MSE bugs."),fm(),gm()):(B.info("Patching Safari 13 MSE bugs."),fm())):xc("Tizen 2")||xc("Tizen 3")||xc("Tizen 4")?im():B.info("Using native MSE as-is."):B.info("No MSE implementation available.")});function km(b,c){B.debug("PatchedMediaKeysMs.requestMediaKeySystemAccess");try{var d=new lm(b,c);return Promise.resolve(d)}catch(e){return Promise.reject(e)}}
function lm(b,c){B.debug("PatchedMediaKeysMs.MediaKeySystemAccess");this.keySystem=b;for(var d=!1,e=0;e<c.length;++e){var f=c[e],g={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:f.initDataTypes,sessionTypes:["temporary"],label:f.label},h=!1;if(f.audioCapabilities)for(var k=0;k<f.audioCapabilities.length;++k){var l=f.audioCapabilities[k];if(l.contentType){h=!0;var n=l.contentType.split(";")[0];MSMediaKeys.isTypeSupported(this.keySystem,
n)&&(g.audioCapabilities.push(l),d=!0)}}if(f.videoCapabilities)for(k=0;k<f.videoCapabilities.length;++k)l=f.videoCapabilities[k],l.contentType&&(h=!0,n=l.contentType.split(";")[0],MSMediaKeys.isTypeSupported(this.keySystem,n)&&(g.videoCapabilities.push(l),d=!0));h||(d=MSMediaKeys.isTypeSupported(this.keySystem,"video/mp4"));"required"==f.persistentState&&(d=!1);if(d){this.a=g;return}}d=Error("Unsupported keySystem");d.name="NotSupportedError";d.code=DOMException.NOT_SUPPORTED_ERR;throw d;}
lm.prototype.createMediaKeys=function(){B.debug("PatchedMediaKeysMs.MediaKeySystemAccess.createMediaKeys");var b=new mm(this.keySystem);return Promise.resolve(b)};lm.prototype.getConfiguration=function(){B.debug("PatchedMediaKeysMs.MediaKeySystemAccess.getConfiguration");return this.a};function nm(b){B.debug("PatchedMediaKeysMs.setMediaKeys");var c=this.mediaKeys;c&&c!=b&&om(c,null);delete this.mediaKeys;return(this.mediaKeys=b)?om(b,this):Promise.resolve()}
function mm(b){B.debug("PatchedMediaKeysMs.MediaKeys");this.b=new MSMediaKeys(b);this.a=new L}mm.prototype.createSession=function(b){B.debug("PatchedMediaKeysMs.MediaKeys.createSession");b=b||"temporary";if("temporary"!=b)throw new TypeError("Session type "+b+" is unsupported on this platform.");return new pm(this.b,b)};mm.prototype.setServerCertificate=function(){B.debug("PatchedMediaKeysMs.MediaKeys.setServerCertificate");return Promise.resolve(!1)};
function om(b,c){b.a.Xb();if(!c)return Promise.resolve();b.a.D(c,"msneedkey",qm);try{return wh(c,HTMLMediaElement.HAVE_METADATA,b.a,function(){c.msSetMediaKeys(b.b)}),Promise.resolve()}catch(d){return Promise.reject(d)}}function pm(b){B.debug("PatchedMediaKeysMs.MediaKeySession");Jb.call(this);this.c=null;this.g=b;this.b=this.a=null;this.f=new L;this.sessionId="";this.expiration=NaN;this.closed=new G;this.keyStatuses=new rm}$a(pm,Jb);m=pm.prototype;
m.generateRequest=function(b,c){B.debug("PatchedMediaKeysMs.MediaKeySession.generateRequest");this.a=new G;try{this.c=this.g.createSession("video/mp4",new Uint8Array(c),null),this.f.D(this.c,"mskeymessage",this.uf.bind(this)),this.f.D(this.c,"mskeyadded",this.sf.bind(this)),this.f.D(this.c,"mskeyerror",this.tf.bind(this)),sm(this,"status-pending")}catch(d){this.a.reject(d)}return this.a};m.load=function(){B.debug("PatchedMediaKeysMs.MediaKeySession.load");return Promise.reject(Error("MediaKeySession.load not yet supported"))};
m.update=function(b){B.debug("PatchedMediaKeysMs.MediaKeySession.update");this.b=new G;try{this.c.update(new Uint8Array(b))}catch(c){this.b.reject(c)}return this.b};m.close=function(){B.debug("PatchedMediaKeysMs.MediaKeySession.close");try{this.c.close(),this.closed.resolve(),this.f.Xb()}catch(b){this.closed.reject(b)}return this.closed};m.remove=function(){B.debug("PatchedMediaKeysMs.MediaKeySession.remove");return Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))};
function qm(b){B.debug("PatchedMediaKeysMs.onMsNeedKey_",b);if(b.initData){var c=document.createEvent("CustomEvent");c.initCustomEvent("encrypted",!1,!1,null);c.initDataType="cenc";c.initData=Fe(b.initData).buffer;this.dispatchEvent(c)}}m.uf=function(b){B.debug("PatchedMediaKeysMs.onMsKeyMessage_",b);this.a&&(this.a.resolve(),this.a=null);this.dispatchEvent(new J("message",{messageType:void 0==this.keyStatuses.a?"license-request":"license-renewal",message:b.message.buffer}))};
m.sf=function(b){B.debug("PatchedMediaKeysMs.onMsKeyAdded_",b);this.a?(B.debug("Simulating completion for a PR persistent license."),sm(this,"usable"),this.a.resolve(),this.a=null):this.b&&(sm(this,"usable"),this.b.resolve(),this.b=null)};
m.tf=function(b){B.debug("PatchedMediaKeysMs.onMsKeyError_",b);b=Error("EME PatchedMediaKeysMs key error");b.errorCode=this.c.error;if(null!=this.a)this.a.reject(b),this.a=null;else if(null!=this.b)this.b.reject(b),this.b=null;else switch(this.c.error.code){case MSMediaKeyError.MS_MEDIA_KEYERR_OUTPUT:case MSMediaKeyError.MS_MEDIA_KEYERR_HARDWARECHANGE:sm(this,"output-not-allowed");break;default:sm(this,"internal-error")}};
function sm(b,c){var d=b.keyStatuses;d.size=void 0==c?0:1;d.a=c;b.dispatchEvent(new J("keystatuseschange"))}function rm(){this.size=0;this.a=void 0}var tm;m=rm.prototype;m.forEach=function(b){this.a&&b(this.a,tm)};m.get=function(b){if(this.has(b))return this.a};m.has=function(b){var c=tm;return this.a&&M.Ka(new Uint8Array(b),new Uint8Array(c))?!0:!1};m.entries=function(){};m.keys=function(){};m.values=function(){};
cm(function(){!window.HTMLVideoElement||!window.MSMediaKeys||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(B.info("Using ms-prefixed EME v20140218"),tm=(new Uint8Array([0])).buffer,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=nm,window.MediaKeys=mm,window.MediaKeySystemAccess=lm,navigator.requestMediaKeySystemAccess=km)});function um(){B.debug("PatchedMediaKeysNop.requestMediaKeySystemAccess");return Promise.reject(Error("The key system specified is not supported."))}function vm(b){B.debug("PatchedMediaKeysNop.setMediaKeys");return null==b?Promise.resolve():Promise.reject(Error("MediaKeys not supported."))}function wm(){throw new TypeError("Illegal constructor.");}wm.prototype.createSession=function(){};wm.prototype.setServerCertificate=function(){};function xm(){throw new TypeError("Illegal constructor.");}
xm.prototype.getConfiguration=function(){};xm.prototype.createMediaKeys=function(){};cm(function(){!window.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(B.info("EME not available."),navigator.requestMediaKeySystemAccess=um,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=vm,window.MediaKeys=wm,window.MediaKeySystemAccess=xm)},-10);var ym="";function zm(b){var c=ym;return c?c+b.charAt(0).toUpperCase()+b.slice(1):b}function Am(b,c){B.debug("PatchedMediaKeysWebkit.requestMediaKeySystemAccess");try{var d=new Bm(b,c);return Promise.resolve(d)}catch(e){return Promise.reject(e)}}function Cm(b){B.debug("PatchedMediaKeysWebkit.setMediaKeys");var c=this.mediaKeys;c&&c!=b&&Dm(c,null);delete this.mediaKeys;(this.mediaKeys=b)&&Dm(b,this);return Promise.resolve()}
function Bm(b,c){B.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess");this.a=this.keySystem=b;var d=!1;"org.w3.clearkey"==b&&(this.a="webkit-org.w3.clearkey",d=!1);var e=!1;var f=document.getElementsByTagName("video");f=f.length?f[0]:document.createElement("video");for(var g=0;g<c.length;++g){var h=c[g],k={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:h.initDataTypes,sessionTypes:["temporary"],label:h.label},l=!1;if(h.audioCapabilities)for(var n=
0;n<h.audioCapabilities.length;++n){var p=h.audioCapabilities[n];if(p.contentType){l=!0;var q=p.contentType.split(";")[0];f.canPlayType(q,this.a)&&(k.audioCapabilities.push(p),e=!0)}}if(h.videoCapabilities)for(n=0;n<h.videoCapabilities.length;++n)p=h.videoCapabilities[n],p.contentType&&(l=!0,f.canPlayType(p.contentType,this.a)&&(k.videoCapabilities.push(p),e=!0));l||(e=f.canPlayType("video/mp4",this.a)||f.canPlayType("video/webm",this.a));"required"==h.persistentState&&(d?(k.persistentState="required",
k.sessionTypes=["persistent-license"]):e=!1);if(e){this.b=k;return}}d="Unsupported keySystem";if("org.w3.clearkey"==b||"com.widevine.alpha"==b)d="None of the requested configurations were supported.";d=Error(d);d.name="NotSupportedError";d.code=DOMException.NOT_SUPPORTED_ERR;throw d;}Bm.prototype.createMediaKeys=function(){B.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess.createMediaKeys");var b=new Em(this.a);return Promise.resolve(b)};
Bm.prototype.getConfiguration=function(){B.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess.getConfiguration");return this.b};function Em(b){B.debug("PatchedMediaKeysWebkit.MediaKeys");this.g=b;this.b=null;this.a=new L;this.c=[];this.f={}}function Dm(b,c){b.b=c;b.a.Xb();var d=ym;c&&(b.a.D(c,d+"needkey",b.Af.bind(b)),b.a.D(c,d+"keymessage",b.zf.bind(b)),b.a.D(c,d+"keyadded",b.xf.bind(b)),b.a.D(c,d+"keyerror",b.yf.bind(b)))}m=Em.prototype;
m.createSession=function(b){B.debug("PatchedMediaKeysWebkit.MediaKeys.createSession");b=b||"temporary";if("temporary"!=b&&"persistent-license"!=b)throw new TypeError("Session type "+b+" is unsupported on this platform.");var c=this.b||document.createElement("video");c.src||(c.src="about:blank");b=new Fm(c,this.g,b);this.c.push(b);return b};m.setServerCertificate=function(){B.debug("PatchedMediaKeysWebkit.MediaKeys.setServerCertificate");return Promise.resolve(!1)};
m.Af=function(b){B.debug("PatchedMediaKeysWebkit.onWebkitNeedKey_",b);var c=document.createEvent("CustomEvent");c.initCustomEvent("encrypted",!1,!1,null);c.initDataType="cenc";b.initData instanceof ArrayBuffer?c.initData=b.initData:c.initData=b.initData.buffer;this.b.dispatchEvent(c)};
m.zf=function(b){B.debug("PatchedMediaKeysWebkit.onWebkitKeyMessage_",b);var c=Gm(this,b.sessionId);c?(b=new J("message",{messageType:void 0==c.keyStatuses.a?"licenserequest":"licenserenewal",message:b.message}),B.debug("PatchedMediaKeysWebkit.MediaKeySession.generated"),c.b&&(c.b.resolve(),c.b=null),c.dispatchEvent(b)):B.error("Session not found",b.sessionId)};
m.xf=function(b){B.debug("PatchedMediaKeysWebkit.onWebkitKeyAdded_",b);if(b=Gm(this,b.sessionId))B.debug("PatchedMediaKeysWebkit.MediaKeySession.ready"),Hm(b,"usable"),b.a&&b.a.resolve(),b.a=null};m.yf=function(b){B.debug("PatchedMediaKeysWebkit.onWebkitKeyError_",b);var c=Gm(this,b.sessionId);c&&c.handleError(b)};
function Gm(b,c){var d=b.f[c];return d?(B.debug("PatchedMediaKeysWebkit.MediaKeys.findSession_",d),d):(d=b.c.shift())?(d.sessionId=c,b.f[c]=d,B.debug("PatchedMediaKeysWebkit.MediaKeys.findSession_",d),d):null}function Fm(b,c,d){B.debug("PatchedMediaKeysWebkit.MediaKeySession");Jb.call(this);this.f=b;this.h=!1;this.a=this.b=null;this.c=c;this.g=d;this.sessionId="";this.expiration=NaN;this.closed=new G;this.keyStatuses=new Im}$a(Fm,Jb);m=Fm.prototype;
m.handleError=function(b){B.debug("PatchedMediaKeysWebkit.MediaKeySession.handleError",b);var c=Error("EME v0.1b key error"),d=b.errorCode;d.systemCode=b.systemCode;c.errorCode=d;!b.sessionId&&this.b?(45==b.systemCode&&(c.message="Unsupported session type."),this.b.reject(c),this.b=null):b.sessionId&&this.a?(this.a.reject(c),this.a=null):(c=b.systemCode,b.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?Hm(this,"output-restricted"):1==c?Hm(this,"expired"):Hm(this,"internal-error"))};
function Jm(b,c,d){if(b.h)return Promise.reject(Error("The session is already initialized."));b.h=!0;try{if("persistent-license"==b.g)if(d)var e=new Uint8Array(Ec("LOAD_SESSION|"+d));else{var f=Ec("PERSISTENT|"),g=new Uint8Array(f.byteLength+c.byteLength);g.set(new Uint8Array(f),0);g.set(new Uint8Array(c),f.byteLength);e=g}else e=new Uint8Array(c)}catch(k){return Promise.reject(k)}b.b=new G;var h=zm("generateKeyRequest");try{b.f[h](b.c,e)}catch(k){if("InvalidStateError"!=k.name)return b.b=null,Promise.reject(k);
(new D(function(){try{b.f[h](b.c,e)}catch(l){b.b.reject(l),b.b=null}})).V(.01)}return b.b}
m.zd=function(b,c){if(this.a)this.a.then(this.zd.bind(this,b,c))["catch"](this.zd.bind(this,b,c));else{this.a=b;if("webkit-org.w3.clearkey"==this.c){var d=Bc(c);var e=JSON.parse(d);"oct"!=e.keys[0].kty&&(this.a.reject(Error("Response is not a valid JSON Web Key Set.")),this.a=null);d=M.Da(e.keys[0].k);e=M.Da(e.keys[0].kid)}else d=new Uint8Array(c),e=null;var f=zm("addKey");try{this.f[f](this.c,d,e,this.sessionId)}catch(g){this.a.reject(g),this.a=null}}};
function Hm(b,c){var d=b.keyStatuses;d.size=void 0==c?0:1;d.a=c;b.dispatchEvent(new J("keystatuseschange"))}m.generateRequest=function(b,c){B.debug("PatchedMediaKeysWebkit.MediaKeySession.generateRequest");return Jm(this,c,null)};m.load=function(b){B.debug("PatchedMediaKeysWebkit.MediaKeySession.load");return"persistent-license"==this.g?Jm(this,null,b):Promise.reject(Error("Not a persistent session."))};
m.update=function(b){B.debug("PatchedMediaKeysWebkit.MediaKeySession.update",b);var c=new G;this.zd(c,b);return c};m.close=function(){B.debug("PatchedMediaKeysWebkit.MediaKeySession.close");if("persistent-license"!=this.g){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;var b=zm("cancelKeyRequest");try{this.f[b](this.c,this.sessionId)}catch(c){}}this.closed.resolve();return this.closed};
m.remove=function(){B.debug("PatchedMediaKeysWebkit.MediaKeySession.remove");return"persistent-license"!=this.g?Promise.reject(Error("Not a persistent session.")):this.close()};function Im(){this.size=0;this.a=void 0}var Km;m=Im.prototype;m.forEach=function(b){this.a&&b(this.a,Km)};m.get=function(b){if(this.has(b))return this.a};m.has=function(b){var c=Km;return this.a&&M.Ka(new Uint8Array(b),new Uint8Array(c))?!0:!1};m.entries=function(){};m.keys=function(){};m.values=function(){};
cm(function(){if(!(!window.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration)){if(HTMLMediaElement.prototype.webkitGenerateKeyRequest)B.info("Using webkit-prefixed EME v0.1b"),ym="webkit";else if(HTMLMediaElement.prototype.generateKeyRequest)B.info("Using nonprefixed EME v0.1b");else return;Km=(new Uint8Array([0])).buffer;navigator.requestMediaKeySystemAccess=Am;delete HTMLMediaElement.prototype.mediaKeys;HTMLMediaElement.prototype.mediaKeys=
null;HTMLMediaElement.prototype.setMediaKeys=Cm;window.MediaKeys=Em;window.MediaKeySystemAccess=Bm}});function Lm(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}}cm(function(){if(window.HTMLVideoElement){var b=HTMLVideoElement.prototype;!b.getVideoPlaybackQuality&&"webkitDroppedFrameCount"in b&&(b.getVideoPlaybackQuality=Lm)}});function Mm(b,c,d){return new window.TextTrackCue(b,c,d)}function Nm(b,c,d){return new window.TextTrackCue(b+"-"+c+"-"+d,b,c,d)}
cm(function(){if(window.VTTCue)B.info("Using native VTTCue.");else if(window.TextTrackCue){var b=TextTrackCue.length;if(3==b)B.info("Using VTTCue polyfill from 3 argument TextTrackCue."),window.VTTCue=Mm;else if(6==b)B.info("Using VTTCue polyfill from 6 argument TextTrackCue."),window.VTTCue=Nm;else{try{var c=!!Mm(1,2,"")}catch(d){c=!1}c&&(B.info("Using VTTCue polyfill from 3 argument TextTrackCue."),window.VTTCue=Mm)}}else B.error("VTTCue not available.")});function Om(){}A("shaka.text.TtmlTextParser",Om);Om.prototype.parseInit=function(){};Om.prototype.parseInit=Om.prototype.parseInit;
Om.prototype.parseMedia=function(b,c){var d=Bc(b),e=[],f=new DOMParser,g=null;if(""==d)return e;try{g=f.parseFromString(d,"text/xml")}catch(wa){throw new E(2,2,2005,"Failed to parse TTML.");}if(g){if(d=g.getElementsByTagName("parsererror")[0])throw new E(2,2,2005,d.textContent);if(f=g.getElementsByTagName("tt")[0]){var h=T.getAttributeNS(f,"http://www.w3.org/ns/ttml#parameter","frameRate");var k=T.getAttributeNS(f,"http://www.w3.org/ns/ttml#parameter","subFrameRate");var l=T.getAttributeNS(f,"http://www.w3.org/ns/ttml#parameter",
"frameRateMultiplier");var n=T.getAttributeNS(f,"http://www.w3.org/ns/ttml#parameter","tickRate");g=f.getAttribute("xml:space")||"default";d=f.getAttribute("tts:extent")}else throw new E(2,2,2005,"TTML does not contain <tt> tag.");if("default"!=g&&"preserve"!=g)throw new E(2,2,2005,"Invalid xml:space value: "+g);g="default"==g;h=new Pm(h,k,l,n);k=Qm(f.getElementsByTagName("metadata")[0]);l=Qm(f.getElementsByTagName("styling")[0]);n=Qm(f.getElementsByTagName("layout")[0]);for(var p=[],q=0;q<n.length;q++){var r=
n[q],x=l,C=d;var z=new Gd;var H=r.getAttribute("xml:id");if(H){z.id=H;H=null;C&&(H=Rm.exec(C)||Sm.exec(C));C=H?Number(H[1]):null;H=H?Number(H[2]):null;var F,P;if(F=Tm(r,x,"extent"))F=(P=Rm.exec(F))||Sm.exec(F),null!=F&&(z.width=null!=C?100*Number(F[1])/C:Number(F[1]),z.height=null!=H?100*Number(F[2])/H:Number(F[2]),z.widthUnits=P||null!=C?Td:0,z.heightUnits=P||null!=H?Td:0);if(r=Tm(r,x,"origin"))F=(P=Rm.exec(r))||Sm.exec(r),null!=F&&(z.viewportAnchorX=null!=H?100*Number(F[1])/H:Number(F[1]),z.viewportAnchorY=
null!=C?100*Number(F[2])/C:Number(F[2]),z.viewportAnchorUnits=P||null!=C?Td:0)}else B.l("TtmlTextParser parser encountered a region with no id. Region will be ignored."),z=null;z&&p.push(z)}d=Um(f.getElementsByTagName("body")[0]);d=t(d);for(f=d.next();!f.done;f=d.next())(f=Vm(f.value,c.periodStart,h,k,l,n,p,g,!1))&&e.push(f)}return e};Om.prototype.parseMedia=Om.prototype.parseMedia;
var Rm=/^(\d{1,2}(?:\.\d+)?|100(?:\.0+)?)% (\d{1,2}(?:\.\d+)?|100(?:\.0+)?)%$/,Wm=/^(\d+px|\d+em)$/,Sm=/^(\d+)px (\d+)px$/,Xm=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,Ym=/^(?:(\d{2,}):)?(\d{2}):(\d{2})$/,Zm=/^(?:(\d{2,}):)?(\d{2}):(\d{2}\.\d{2,})$/,$m=/^(\d*(?:\.\d*)?)f$/,an=/^(\d*(?:\.\d*)?)t$/,bn=/^(?:(\d*(?:\.\d*)?)h)?(?:(\d*(?:\.\d*)?)m)?(?:(\d*(?:\.\d*)?)s)?(?:(\d*(?:\.\d*)?)ms)?$/,cn={left:Ld,center:"center",right:"end",start:Ld,end:"end"},dn={left:"line-left",center:"center",right:"line-right"};
function Qm(b){var c=[];if(!b)return c;for(var d=t(b.childNodes),e=d.next();!e.done;e=d.next())e=e.value,e.nodeType==Node.ELEMENT_NODE&&"br"!==e.nodeName&&(e=Qm(e),c=c.concat(e));c.length||c.push(b);return c}function Um(b){if(!b)return[];var c=[];b=t(b.childNodes);for(var d=b.next();!d.done;d=b.next())d=d.value,d instanceof Element&&(d.hasAttribute("begin")?c.push(d):c=c.concat(Um(d)));return c}
function en(b,c){for(var d="",e=t(b.childNodes),f=e.next();!f.done;f=e.next())f=f.value,"br"==f.nodeName&&b.childNodes[0]!==f?d+="\n":f.childNodes&&0<f.childNodes.length?d+=en(f,c):c?(f=f.textContent.trim(),f=f.replace(/\s+/g," "),d+=f):d+=f.textContent;return d}
function Vm(b,c,d,e,f,g,h,k,l){if(l&&"br"==b.nodeName)return b=new Ed(0,0,""),b.spacer=!0,b;var n=/^[\s\n]*$/.test(b.textContent),p=b.nodeType==Node.ELEMENT_NODE&&!b.hasAttribute("begin")&&!b.hasAttribute("end");if(b.nodeType!=Node.ELEMENT_NODE||p&&n||p&&!l)return null;n=fn(b.getAttribute("begin"),d);p=fn(b.getAttribute("end"),d);var q=fn(b.getAttribute("dur"),d);null==p&&null!=q&&(p=n+q);if(!l&&(null==n||null==p))throw new E(2,2,2001);n+=c;p+=c;q="";l=[];if(Array.from(b.childNodes).find(function(b){return b.nodeType===
Node.TEXT_NODE&&/\S+/.test(b.textContent)}))q=en(b,k);else for(var r=t(b.childNodes),x=r.next();!x.done;x=r.next())if(x=Vm(x.value,c,d,e,f,g,h,k,!0))x.startTime=x.startTime||n,x.endTime=x.endTime||p,l.push(x);c=new Ed(n,p,q);c.nestedCues=l;if((g=gn(b,"region",g,"")[0])&&g.getAttribute("xml:id")){var C=g.getAttribute("xml:id");c.region=h.filter(function(b){return b.id==C})[0]}e=gn(b,"smpte:backgroundImage",e,"#")[0];hn(c,b,g,e,f);return c}
function hn(b,c,d,e,f){"rtl"==jn(c,d,f,"direction")&&(b.direction="rtl");var g=jn(c,d,f,"writingMode");"tb"==g||"tblr"==g?b.writingMode="vertical-lr":"tbrl"==g?b.writingMode="vertical-rl":"rltb"==g||"rl"==g?b.direction="rtl":g&&(b.direction=Fd);(g=jn(c,d,f,"textAlign"))?(b.positionAlign=dn[g],b.lineAlign=cn[g],b.textAlign=Pd[g.toUpperCase()]):b.textAlign="start";if(g=jn(c,d,f,"displayAlign"))b.displayAlign=Qd[g.toUpperCase()];if(g=jn(c,d,f,"color"))b.color=g;if(g=jn(c,d,f,"backgroundColor"))b.backgroundColor=
g;if(g=jn(c,d,f,"fontFamily"))b.fontFamily=g;(g=jn(c,d,f,"fontWeight"))&&"bold"==g&&(b.fontWeight=700);(g=jn(c,d,f,"wrapOption"))&&"noWrap"==g&&(b.wrapLine=!1);(g=jn(c,d,f,"lineHeight"))&&g.match(Wm)&&(b.lineHeight=g);(g=jn(c,d,f,"fontSize"))&&g.match(Wm)&&(b.fontSize=g);if(g=jn(c,d,f,"fontStyle"))b.fontStyle=Sd[g.toUpperCase()];if(e){g=e.getAttribute("imagetype");var h=e.getAttribute("encoding");e=e.textContent.trim();"PNG"==g&&"Base64"==h&&e&&(b.backgroundImage="data:image/png;base64,"+e)}(d=Tm(d,
f,"textDecoration"))&&kn(b,d);(c=ln(c,f,"textDecoration"))&&kn(b,c)}
function kn(b,c){for(var d=c.split(" "),e=0;e<d.length;e++)switch(d[e]){case "underline":b.textDecoration.includes("underline")||b.textDecoration.push("underline");break;case "noUnderline":b.textDecoration.includes("underline")&&Mb(b.textDecoration,"underline");break;case "lineThrough":b.textDecoration.includes("lineThrough")||b.textDecoration.push("lineThrough");break;case "noLineThrough":b.textDecoration.includes("lineThrough")&&Mb(b.textDecoration,"lineThrough");break;case "overline":b.textDecoration.includes("overline")||
b.textDecoration.push("overline");break;case "noOverline":b.textDecoration.includes("overline")&&Mb(b.textDecoration,"overline")}}function jn(b,c,d,e){return(b=ln(b,d,e))?b:Tm(c,d,e)}function Tm(b,c,d){for(var e=Qm(b),f=0;f<e.length;f++){var g=T.getAttributeNS(e[f],"http://www.w3.org/ns/ttml#styling",d);if(g)return g}return(b=gn(b,"style",c,"")[0])?T.getAttributeNS(b,"http://www.w3.org/ns/ttml#styling",d):null}
function ln(b,c,d){var e=T.getAttributeNS(b,"http://www.w3.org/ns/ttml#styling",d);if(e)return e;b=gn(b,"style",c,"");c=null;for(e=0;e<b.length;e++){var f=T.getAttributeNS(b[e],"http://www.w3.org/ns/ttml#styling",d);f&&(c=f)}return c}
function gn(b,c,d,e){var f=[];if(!b||1>d.length)return f;var g=b;for(b=null;g&&!(b=g.getAttribute(c))&&(g=g.parentNode,g instanceof Element););if(c=b)for(c=c.split(" "),c=t(c),b=c.next();!b.done;b=c.next()){b=b.value;g=t(d);for(var h=g.next();!h.done;h=g.next())if(h=h.value,e+h.getAttribute("xml:id")==b){f.push(h);break}}return f}
function fn(b,c){var d=null;if(Xm.test(b)){d=Xm.exec(b);var e=Number(d[1]),f=Number(d[2]),g=Number(d[3]),h=Number(d[4]);h+=(Number(d[5])||0)/c.b;g+=h/c.frameRate;d=g+60*f+3600*e}else Ym.test(b)?d=mn(Ym,b):Zm.test(b)?d=mn(Zm,b):$m.test(b)?(d=$m.exec(b),d=Number(d[1])/c.frameRate):an.test(b)?(d=an.exec(b),d=Number(d[1])/c.a):bn.test(b)&&(d=mn(bn,b));return d}
function mn(b,c){var d=b.exec(c);return null==d||""==d[0]?null:(Number(d[4])||0)/1E3+(Number(d[3])||0)+60*(Number(d[2])||0)+3600*(Number(d[1])||0)}function Pm(b,c,d,e){this.frameRate=Number(b)||30;this.b=Number(c)||1;this.a=Number(e);0==this.a&&(this.a=b?this.frameRate*this.b:1);d&&(b=/^(\d+) (\d+)$/g.exec(d))&&(this.frameRate*=Number(b[1])/Number(b[2]))}Wd["application/ttml+xml"]=Om;function nn(){this.a=new Om}A("shaka.text.Mp4TtmlParser",nn);nn.prototype.parseInit=function(b){var c=!1;(new S).J("moov",Be).J("trak",Be).J("mdia",Be).J("minf",Be).J("stbl",Be).ha("stsd",Ce).J("stpp",function(b){c=!0;b.parser.stop()}).parse(b);if(!c)throw new E(2,2,2007);};nn.prototype.parseInit=nn.prototype.parseInit;nn.prototype.parseMedia=function(b,c){var d=!1,e=[];(new S).J("mdat",De(function(b){d=!0;e=e.concat(this.a.parseMedia(b,c))}.bind(this))).parse(b);if(!d)throw new E(2,2,2007);return e};
nn.prototype.parseMedia=nn.prototype.parseMedia;Wd['application/mp4; codecs="stpp"']=nn;Wd['application/mp4; codecs="stpp.ttml.im1t"']=nn;Wd['application/mp4; codecs="stpp.TTML.im1t"']=nn;function on(){}A("shaka.text.VttTextParser",on);on.prototype.parseInit=function(){};on.prototype.parseInit=on.prototype.parseInit;
on.prototype.parseMedia=function(b,c){var d=Bc(b);d=d.replace(/\r\n|\r(?=[^\n]|$)/gm,"\n");d=d.split(/\n{2,}/m);if(!/^WEBVTT($|[ \t\n])/m.test(d[0]))throw new E(2,2,2E3);var e=c.segmentStart;if(null==e&&(e=0,d[0].includes("X-TIMESTAMP-MAP"))){var f=d[0].match(/LOCAL:((?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3}))/m),g=d[0].match(/MPEGTS:(\d+)/m);if(f&&g){e=pn(new Wf(f[1]));if(null==e)throw new E(2,2,2E3);e=c.periodStart+(Number(g[1])/9E4-e)}}g=[];var h=d[0].split("\n");for(f=1;f<h.length;f++)if(/^Region:/.test(h[f])){var k=
new Wf(h[f]),l=new Gd;Zf(k);Xf(k);for(var n=Zf(k);n;){var p;a:{var q=l,r=n;if(p=/^id=(.*)$/.exec(r))q.id=p[1];else if(p=/^width=(\d{1,2}|100)%$/.exec(r))q.width=Number(p[1]);else if(p=/^lines=(\d+)$/.exec(r))q.height=Number(p[1]),q.heightUnits=2;else if(p=/^regionanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(r))q.regionAnchorX=Number(p[1]),q.regionAnchorY=Number(p[2]);else if(p=/^viewportanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(r))q.viewportAnchorX=Number(p[1]),q.viewportAnchorY=Number(p[2]);else if(/^scroll=up$/.exec(r))q.scroll=
"up";else{p=!1;break a}p=!0}p||B.l("VTT parser encountered an invalid VTTRegion setting: ",n," The setting will be ignored.");Xf(k);n=Zf(k)}g.push(l)}f=[];for(k=1;k<d.length;k++){h=d[k].split("\n");p=h;q=e;h=g;if(1==p.length&&!p[0]||/^NOTE($|[ \t])/.test(p[0])||"STYLE"==p[0])h=null;else{l=null;p[0].includes("--\x3e")||(l=p[0],p.splice(0,1));n=new Wf(p[0]);r=pn(n);var x=Yf(n,/[ \t]+--\x3e[ \t]+/g),C=pn(n);if(null==r||null==x||null==C)throw new E(2,2,2001);p=new Ed(r+q,C+q,p.slice(1).join("\n").trim());
Xf(n);for(q=Zf(n);q;)qn(p,q,h)||B.l("VTT parser encountered an invalid VTT setting: ",q," The setting will be ignored."),Xf(n),q=Zf(n);null!=l&&(p.id=l);h=p}h&&f.push(h)}return f};on.prototype.parseMedia=on.prototype.parseMedia;
function qn(b,c,d){var e;if(e=/^align:(start|middle|center|end|left|right)$/.exec(c))c=e[1],"middle"==c?b.textAlign=Id:b.textAlign=Pd[c.toUpperCase()];else if(e=/^vertical:(lr|rl)$/.exec(c))b.writingMode="lr"==e[1]?"vertical-lr":"vertical-rl";else if(e=/^size:([\d.]+)%$/.exec(c))b.size=Number(e[1]);else if(e=/^position:([\d.]+)%(?:,(line-left|line-right|center|start|end))?$/.exec(c))b.position=Number(e[1]),e[2]&&(c=e[2],b.positionAlign="line-left"==c||"start"==c?"line-left":"line-right"==c||"end"==
c?"line-right":"center");else if(e=/^region:(.*)$/.exec(c)){if(c=rn(d,e[1]))b.region=c}else{a:{if(d=/^line:([\d.]+)%(?:,(start|end|center))?$/.exec(c))b.lineInterpretation=1,b.line=Number(d[1]),d[2]&&(b.lineAlign=Rd[d[2].toUpperCase()]);else if(d=/^line:(-?\d+)(?:,(start|end|center))?$/.exec(c))b.lineInterpretation=Kd,b.line=Number(d[1]),d[2]&&(b.lineAlign=Rd[d[2].toUpperCase()]);else{b=!1;break a}b=!0}return b}return!0}
function rn(b,c){var d=b.filter(function(b){return b.id==c});return d.length?d[0]:(B.l("VTT parser could not find a region with id: ",c," The region will be ignored."),null)}function pn(b){b=Yf(b,/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3})/g);if(null==b)return null;var c=Number(b[2]),d=Number(b[3]);return 59<c||59<d?null:Number(b[4])/1E3+d+60*c+3600*(Number(b[1])||0)}Wd["text/vtt"]=on;Wd['text/vtt; codecs="vtt"']=on;function sn(){this.a=null}A("shaka.text.Mp4VttParser",sn);sn.prototype.parseInit=function(b){var c=!1;(new S).J("moov",Be).J("trak",Be).J("mdia",Be).ha("mdhd",function(b){0==b.version?(b.reader.P(4),b.reader.P(4),this.a=b.reader.G(),b.reader.P(4)):(b.reader.P(8),b.reader.P(8),this.a=b.reader.G(),b.reader.P(8));b.reader.P(4)}.bind(this)).J("minf",Be).J("stbl",Be).ha("stsd",Ce).J("wvtt",function(){c=!0}).parse(b);if(!this.a)throw new E(2,2,2008);if(!c)throw new E(2,2,2008);};
sn.prototype.parseInit=sn.prototype.parseInit;
sn.prototype.parseMedia=function(b,c){var d=this;if(!this.a)throw B.error("No init segment for MP4+VTT!"),new E(2,2,2008);var e=0,f=[],g,h=[],k=!1,l=!1,n=!1,p=null;(new S).J("moof",Be).J("traf",Be).ha("tfdt",function(b){k=!0;e=0==b.version?b.reader.G():b.reader.Hb()}).ha("tfhd",function(b){var c=b.flags;b=b.reader;b.P(4);c&1&&b.P(8);c&2&&b.P(4);p=c&8?b.G():null}).ha("trun",function(b){l=!0;var c=b.version,d=b.flags;b=b.reader;var e=b.G();d&1&&b.P(4);d&4&&b.P(4);for(var g=[],h=0;h<e;h++){var k={duration:null,
sampleSize:null,Bd:null};d&256&&(k.duration=b.G());d&512&&(k.sampleSize=b.G());d&1024&&b.P(4);d&2048&&(k.Bd=0==c?b.G():b.je());g.push(k)}f=g}).J("mdat",De(function(b){n=!0;g=b})).parse(b);if(!n&&!k&&!l)throw new E(2,2,2008);var q=e,r=new DataView(g.buffer,g.byteOffset,g.byteLength),x=new R(r,0);f.forEach(function(b){var f=b.duration||p,g=b.Bd?e+b.Bd:q;q=g+(f||0);var k=0;do{var l=x.G();k+=l;var n=x.G();n=Ae(n);var r=null;"vttc"==n?8<l&&(r=x.eb(l-8)):("vtte"!=n&&B.error("Unknown box "+n+"! Skipping!"),
x.P(l-8));f?r&&h.push(tn(r,c.periodStart+g/d.a,c.periodStart+q/d.a)):B.error("WVTT sample duration unknown, and no default found!")}while(b.sampleSize&&k<b.sampleSize)});return h.filter(vd.La)};sn.prototype.parseMedia=sn.prototype.parseMedia;function tn(b,c,d){var e,f,g;(new S).J("payl",De(function(b){e=Bc(b)})).J("iden",De(function(b){f=Bc(b)})).J("sttg",De(function(b){g=Bc(b)})).parse(b);return e?un(e,f,g,c,d):null}
function un(b,c,d,e,f){b=new Ed(e,f,b);c&&(b.id=c);if(d)for(c=new Wf(d),d=Zf(c);d;)qn(b,d,[])||B.l("VTT parser encountered an invalid VTT setting: ",d," The setting will be ignored."),Xf(c),d=Zf(c);return b}Wd['application/mp4; codecs="wvtt"']=sn;A("shaka.util.Dom.createHTMLElement",function(b){return document.createElement(b)});A("shaka.util.Dom.createVideoElement",function(){var b=document.createElement("video");b.muted=!0;b.width=600;b.height=400;return b});A("shaka.util.Dom.asHTMLElement",function(b){return b});A("shaka.util.Dom.asHTMLMediaElement",function(b){return b});A("shaka.util.Dom.removeAllChildren",function(b){for(;b.firstChild;)b.removeChild(b.firstChild)});/*
 @license
 EME Encryption Scheme Polyfill
 Copyright 2019 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/
function vn(){}var wn;A("EmeEncryptionSchemePolyfill",vn);function xn(){wn?console.debug("EmeEncryptionSchemePolyfill: Already installed."):navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration?(wn=navigator.requestMediaKeySystemAccess,console.debug("EmeEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.requestMediaKeySystemAccess=yn):console.debug("EmeEncryptionSchemePolyfill: EME not found")}vn.install=xn;
function yn(b,c){var d=this;return u(function f(){var g;return y(f,function(f){switch(f.j){case 1:return console.assert(d==navigator,'bad "this" for requestMediaKeySystemAccess'),v(f,wn.call(d,b,c),2);case 2:g=f.o;if(zn(g))return console.debug("EmeEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.requestMediaKeySystemAccess=wn,f["return"](g);console.debug("EmeEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support.");navigator.requestMediaKeySystemAccess=
An;return f["return"](An.call(d,b,c))}})})}
function An(b,c){var d=this;return u(function f(){var g,h,k,l,n,p,q,r;return y(f,function(f){switch(f.j){case 1:console.assert(d==navigator,'bad "this" for requestMediaKeySystemAccess');g=Bn(b);h=[];for(var x=t(c),z=x.next();!z.done;z=x.next())k=z.value,l=Cn(k.videoCapabilities,g),n=Cn(k.audioCapabilities,g),k.videoCapabilities&&k.videoCapabilities.length&&!l.length||k.audioCapabilities&&k.audioCapabilities.length&&!n.length||(p=Object.assign({},k),p.videoCapabilities=l,p.audioCapabilities=n,h.push(p));
if(!h.length)throw q=Error("Unsupported keySystem or supportedConfigurations."),q.name="NotSupportedError",q.code=DOMException.NOT_SUPPORTED_ERR,q;return v(f,wn.call(d,b,h),2);case 2:return r=f.o,f["return"](new Dn(r,g))}})})}function Cn(b,c){return b?b.filter(function(b){return!b.encryptionScheme||b.encryptionScheme==c}):b}function En(){}var Fn;A("McEncryptionSchemePolyfill",En);
function Gn(){navigator.mediaCapabilities?(Fn=navigator.mediaCapabilities.decodingInfo,console.debug("McEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=Hn):console.debug("McEncryptionSchemePolyfill: MediaCapabilities not found")}En.install=Gn;
function Hn(b){var c=this;return u(function e(){var f,g;return y(e,function(e){switch(e.j){case 1:return console.assert(c==navigator.mediaCapabilities,'bad "this" for decodingInfo'),v(e,Fn.call(c,b),2);case 2:f=e.o;if(!b.keySystemConfiguration)return e["return"](f);g=f.keySystemAccess;if(zn(g))return console.debug("McEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.mediaCapabilities.decodingInfo=Fn,e["return"](f);console.debug("McEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support.");
navigator.mediaCapabilities.decodingInfo=In;return e["return"](In.call(c,b))}})})}
function In(b){var c=this;return u(function e(){var f,g,h,k,l,n,p;return y(e,function(e){switch(e.j){case 1:return console.assert(c==navigator.mediaCapabilities,'bad "this" for decodingInfo'),f=null,b.keySystemConfiguration&&(g=b.keySystemConfiguration,h=g.keySystem,k=g.audio&&g.audio.encryptionScheme,l=g.video&&g.video.encryptionScheme,f=Bn(h),n={powerEfficient:!1,smooth:!1,supported:!1,keySystemAccess:null,configuration:b},k&&k!=f||l&&l!=f)?e["return"](n):v(e,Fn.call(c,b),2);case 2:return p=e.o,
p.keySystemAccess&&(p.keySystemAccess=new Dn(p.keySystemAccess,f)),e["return"](p)}})})}function Dn(b,c){this.b=b;this.a=c;this.keySystem=b.keySystem}Dn.prototype.getConfiguration=function(){var b=this.b.getConfiguration();if(b.videoCapabilities)for(var c=t(b.videoCapabilities),d=c.next();!d.done;d=c.next())d.value.encryptionScheme=this.a;if(b.audioCapabilities)for(c=t(b.audioCapabilities),d=c.next();!d.done;d=c.next())d.value.encryptionScheme=this.a;return b};Dn.prototype.createMediaKeys=function(){return this.b.createMediaKeys()};
function Bn(b){if(b.startsWith("com.widevine")||b.startsWith("com.microsoft")||b.startsWith("com.adobe")||b.startsWith("org.w3"))return"cenc";if(b.startsWith("com.apple"))return"cbcs-1-9";console.warn("EmeEncryptionSchemePolyfill: Unknown key system:",b,"Please contribute!");return null}function zn(b){b=b.getConfiguration();var c=b.audioCapabilities&&b.audioCapabilities[0];return(b=b.videoCapabilities&&b.videoCapabilities[0]||c)&&void 0!==b.encryptionScheme?!0:!1}function Jn(){}
A("EncryptionSchemePolyfills",Jn);function dm(){xn();Gn()}Jn.install=dm;"undefined"!==typeof module&&module.Fe&&(module.Fe=Jn);}).call(exportTo,innerGlobal,innerGlobal,undefined);if(typeof exports!="undefined")for(var k in exportTo.shaka)exports[k]=exportTo.shaka[k];else if(typeof define!="undefined"&&define.amd)define(function(){return exportTo.shaka});else innerGlobal.shaka=exportTo.shaka})();

